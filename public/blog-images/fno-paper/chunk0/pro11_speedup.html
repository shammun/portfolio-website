import React, { useState, useEffect, useRef } from 'react';
import { Play, RotateCcw, Clock, Zap, Server, BarChart3 } from 'lucide-react';

/**
* Clean Educational Style Guide Constants
*/
const COLORS = {
bg: { from: '#fafbff', to: '#f5f7ff' },
warm: {
lightest: '#fef3c7', // Input/Problem
light: '#fcd34d',
medium: '#f97316',
dark: '#dc2626',
text: '#c2410c',
border: '#fdba74',
},
cool: {
lightest: '#ecfdf5', // Output/Solution
light: '#6ee7b7',
medium: '#14b8a6',
dark: '#0891b2',
text: '#0d9488',
border: '#6ee7b7',
},
purple: {
light: '#c4b5fd', // Operators
medium: '#a78bfa',
dark: '#7c3aed',
},
neutral: {
heading: '#1e293b',
body: '#64748b',
muted: '#94a3b8',
border: '#e2e8f0',
white: '#ffffff',
}
};

const SHADOW_STYLE = {
boxShadow: '0 4px 16px -1px rgba(99, 102, 241, 0.12), 0 2px 4px -1px rgba(99, 102, 241, 0.06)'
};

/**
* Reusable Components based on Style Guide
*/
const Card = ({ children, className = "" }) => (
<div className={`bg-white rounded-2xl border border-slate-100 p-6 relative overflow-hidden ${className}`}
    style={SHADOW_STYLE}>
    {children}
</div>
);

const Badge = ({ children, type = "neutral" }) => {
let bg, text;
switch (type) {
case 'warm': bg = COLORS.warm.lightest; text = COLORS.warm.text; break;
case 'cool': bg = COLORS.cool.lightest; text = COLORS.cool.text; break;
default: bg = '#f1f5f9'; text = COLORS.neutral.body;
}
return (
<span className="px-3 py-1 rounded-full text-[11px] font-medium tracking-wide uppercase" style={{ backgroundColor: bg,
    color: text }}>
    {children}
</span>
);
};

const MetricDisplay = ({ label, value, subtext, colorType }) => {
const color = colorType === 'warm' ? COLORS.warm.dark : COLORS.cool.dark;
return (
<div className="flex flex-col">
    <span className="text-[11px] font-medium text-slate-400 uppercase tracking-wider mb-1">{label}</span>
    <span className="text-3xl font-serif italic font-semibold" style={{ color: color }}>
        {value}
    </span>
    <span className="text-[10px] text-slate-400 mt-1">{subtext}</span>
</div>
);
};

export default function App() {
const [isRunning, setIsRunning] = useState(false);
const [completed, setCompleted] = useState(false);

// Animation States
const [tradProgress, setTradProgress] = useState(0);
const [fnoCount, setFnoCount] = useState(0);
const [simTimeHours, setSimTimeHours] = useState(0);

const requestRef = useRef();
const startTimeRef = useRef();

const DURATION = 8000; // 8 seconds for the animation to represent "10 Hours"
const TARGET_SOLUTIONS = 10000;

const startSimulation = () => {
setIsRunning(true);
setCompleted(false);
setTradProgress(0);
setFnoCount(0);
setSimTimeHours(0);
startTimeRef.current = performance.now();
requestRef.current = requestAnimationFrame(animate);
};

const animate = (time) => {
const timeElapsed = time - startTimeRef.current;
const progress = Math.min(timeElapsed / DURATION, 1); // 0 to 1

// Update States
setTradProgress(progress * 100);
setSimTimeHours(progress * 10); // 0 to 10 hours
setFnoCount(Math.floor(progress * TARGET_SOLUTIONS)); // 0 to 10,000

if (progress < 1) { requestRef.current=requestAnimationFrame(animate); } else { setIsRunning(false); setCompleted(true);
    } }; useEffect(()=> {
    return () => cancelAnimationFrame(requestRef.current);
    }, []);

    const applications = [
    {
    title: "Real-Time Control",
    icon: "üéÆ",
    desc: "Physics-based control systems that respond in milliseconds",
    badge: "Previously: Too slow",
    badgeType: "warm"
    },
    {
    title: "Uncertainty Quantification",
    icon: "üìä",
    desc: "Run 10,000+ Monte Carlo simulations in seconds",
    badge: "Previously: Days/weeks",
    badgeType: "warm"
    },
    {
    title: "Design Optimization",
    icon: "üîß",
    desc: "Explore millions of design variants interactively",
    badge: "Previously: Months",
    badgeType: "warm"
    },
    {
    title: "Weather Forecasting",
    icon: "üå§Ô∏è",
    desc: "10-day global forecast in under 1 minute",
    badge: "Now: GraphCast, Pangu",
    badgeType: "cool"
    },
    {
    title: "Digital Twins",
    icon: "üß¨",
    desc: "Real-time simulation of physical systems",
    badge: "Now: Feasible",
    badgeType: "cool"
    },
    {
    title: "Scientific Discovery",
    icon: "üî¨",
    desc: "Interactive exploration of parameter spaces",
    badge: "Now: Democratized",
    badgeType: "cool"
    }
    ];

    return (
    <div className="min-h-screen w-full p-4 md:p-8 font-sans transition-colors duration-700" style={{ background:
        `linear-gradient(to bottom right, ${COLORS.bg.from}, ${COLORS.bg.to})` }}>

        <div className="max-w-5xl mx-auto space-y-8">

            {/* Header */}
            <header className="text-center space-y-2 mb-12">
                <Badge>Computation Speed Comparison</Badge>
                <h1 className="text-3xl md:text-4xl font-bold text-slate-800 tracking-tight">
                    Traditional Solvers vs. FNO
                </h1>
                <p className="text-slate-500 max-w-2xl mx-auto">
                    Visualizing the dramatic efficiency gap between conventional PDE solvers and Fourier Neural
                    Operators for complex physics simulations.
                </p>
            </header>

            {/* Main Comparison Stage */}
            <div className="grid md:grid-cols-2 gap-8 relative">

                {/* Connector Arrow (Desktop only) */}
                <div
                    className="hidden md:flex absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10 flex-col items-center justify-center">
                    <div className="bg-white p-2 rounded-full shadow-sm border border-slate-100">
                        <div className="bg-indigo-50 p-2 rounded-full">
                            <span className="text-xs font-bold text-indigo-500">VS</span>
                        </div>
                    </div>
                </div>

                {/* LEFT: Traditional Solver (Warm Palette) */}
                <Card className="border-t-4" style={{ borderColor: COLORS.warm.dark }}>
                    <div className="flex justify-between items-start mb-6">
                        <div className="flex items-center gap-2">
                            <div className="p-2 rounded-lg bg-orange-50 text-orange-600">
                                <Server size={20} />
                            </div>
                            <div>
                                <h3 className="font-bold text-slate-800">Traditional Solver</h3>
                                <p className="text-xs text-slate-500">Numerical Integration</p>
                            </div>
                        </div>
                        <Badge type="warm">Iterative</Badge>
                    </div>

                    {/* Visual Metaphor: Slow Loading / Calendar */}
                    <div
                        className="h-48 bg-orange-50/50 rounded-xl border border-orange-100 flex flex-col items-center justify-center relative overflow-hidden mb-6">
                        {/* Background grid pattern */}
                        <div className="absolute inset-0 opacity-[0.03]" style={{ backgroundImage:
                            `radial-gradient(${COLORS.warm.medium} 1px, transparent 1px)`, backgroundSize: '16px 16px'
                            }}></div>

                        <div className="relative z-10 text-center">
                            <div
                                className="inline-block p-4 bg-white rounded-xl shadow-sm border border-orange-100 mb-3">
                                <Clock className={`w-8 h-8 ${isRunning ? 'animate-spin' : '' }`} style={{ color:
                                    COLORS.warm.medium, animationDuration: '3s' }} />
                            </div>
                            <div className="text-2xl font-serif font-bold text-slate-700">
                                {simTimeHours.toFixed(1)} <span
                                    className="text-sm font-sans font-normal text-slate-400">Hours</span>
                            </div>
                            <div className="text-xs text-orange-600 font-medium mt-1 bg-orange-100 px-2 py-1 rounded">
                                Calculating single mesh...
                            </div>
                        </div>

                        {/* Slow Progress Bar */}
                        <div className="absolute bottom-0 left-0 h-1.5 bg-orange-200 w-full">
                            <div className="h-full bg-gradient-to-r from-orange-400 to-red-500 transition-all duration-75 ease-linear"
                                style={{ width: `${tradProgress}%` }} />
                        </div>
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                        <MetricDisplay label="Solution Time" value="10 hrs" subtext="Per single instance"
                            colorType="warm" />
                        <MetricDisplay label="Scalability" value="Linear" subtext="Recalculate every time"
                            colorType="warm" />
                    </div>
                </Card>

                {/* RIGHT: FNO (Cool Palette) */}
                <Card className="border-t-4" style={{ borderColor: COLORS.cool.dark }}>
                    <div className="flex justify-between items-start mb-6">
                        <div className="flex items-center gap-2">
                            <div className="p-2 rounded-lg bg-teal-50 text-teal-600">
                                <Zap size={20} />
                            </div>
                            <div>
                                <h3 className="font-bold text-slate-800">Fourier Neural Operator</h3>
                                <p className="text-xs text-slate-500">Deep Learning Inference</p>
                            </div>
                        </div>
                        <Badge type="cool">Parallel</Badge>
                    </div>

                    {/* Visual Metaphor: Speed / Multiplicity */}
                    <div
                        className="h-48 bg-teal-50/50 rounded-xl border border-teal-100 flex flex-col items-center justify-center relative overflow-hidden mb-6">
                        {/* Background grid pattern */}
                        <div className="absolute inset-0 opacity-[0.03]" style={{ backgroundImage:
                            `radial-gradient(${COLORS.cool.medium} 1px, transparent 1px)`, backgroundSize: '16px 16px'
                            }}></div>

                        <div className="relative z-10 text-center w-full px-8">
                            <div className="flex justify-center items-center gap-1 mb-2">
                                {/* Animated Bars indicating high throughput */}
                                {[1,2,3,4,5].map(i => (
                                <div key={i} className={`w-1 bg-teal-400 rounded-full transition-all duration-300
                                    ${isRunning ? 'animate-pulse' : '' }`} style={{ height: isRunning ? Math.random() *
                                    24 + 12 : 8, animationDelay: `${i*0.1}s` }} />
                                ))}
                            </div>

                            <div className="text-4xl font-serif font-bold text-slate-700 tabular-nums">
                                {fnoCount.toLocaleString()}
                            </div>
                            <div className="text-sm font-medium text-slate-400 mb-2">Solutions Computed</div>

                            <div
                                className="text-xs text-teal-700 font-medium mt-1 bg-teal-100 px-2 py-1 rounded inline-block">
                                {isRunning ? "Inference running..." : "Ready for real-time control"}
                            </div>
                        </div>
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                        <MetricDisplay label="Solution Time" value="3.6 sec" subtext="For equivalent 10hrs"
                            colorType="cool" />
                        <MetricDisplay label="Speedup" value="10,000√ó" subtext="Orders of magnitude" colorType="cool" />
                    </div>
                </Card>
            </div>

            {/* Controls */}
            <div className="flex justify-center pb-8 border-b border-slate-200">
                <button onClick={startSimulation} disabled={isRunning} className={` group relative overflow-hidden px-8
                    py-4 rounded-xl font-bold text-white shadow-lg transition-all duration-300 transform active:scale-95
                    ${isRunning ? 'bg-slate-300 cursor-not-allowed' : 'bg-slate-800 hover:bg-slate-700 hover:shadow-xl'
                    } `}>
                    <div className="flex items-center gap-2">
                        {isRunning ? (
                        <>
                            <RotateCcw className="animate-spin" size={18} />
                            <span>Simulating...</span>
                        </>
                        ) : (
                        <>
                            <Play size={18} fill="currentColor" />
                            <span>{completed ? "Replay Visualization" : "Start Time Comparison"}</span>
                        </>
                        )}
                    </div>
                </button>
            </div>

            {/* Scale Indicator */}
            <section className="space-y-4">
                <div className="flex items-center gap-2 mb-2">
                    <BarChart3 size={16} className="text-slate-400" />
                    <h3 className="text-xs font-bold text-slate-500 uppercase tracking-widest">Scale Representation</h3>
                </div>

                <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm space-y-6">
                    {/* Traditional Bar */}
                    <div>
                        <div className="flex justify-between text-xs mb-1">
                            <span className="font-semibold text-slate-700">Traditional Solver</span>
                            <span className="text-slate-500">10 Hours (Reference)</span>
                        </div>
                        <div className="h-4 w-full bg-slate-100 rounded-full overflow-hidden relative">
                            <div className="absolute inset-0 bg-red-500 rounded-full w-full"></div>
                            {/* Break lines to suggest it goes off screen */}
                            <div
                                className="absolute right-0 top-0 bottom-0 w-8 bg-gradient-to-l from-white to-transparent">
                            </div>
                        </div>
                    </div>

                    {/* FNO Bar */}
                    <div>
                        <div className="flex justify-between text-xs mb-1">
                            <span className="font-semibold text-slate-700">FNO</span>
                            <span className="text-emerald-600 font-bold">3.6 Seconds</span>
                        </div>
                        <div className="h-4 w-full bg-slate-100 rounded-full overflow-hidden flex items-center">
                            {/* 0.01% width is invisible, so we use a min-pixel width with a label */}
                            <div className="h-full bg-emerald-500 w-[2px]"></div>
                            <div className="ml-2 text-[10px] text-emerald-600 font-medium flex items-center gap-1">
                                <span className="w-1 h-1 bg-emerald-500 rounded-full"></span>
                                Microscopic Fraction
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            {/* Real World Applications Grid - EXPANDED */}
            <div className="pt-8">
                <div className="text-center mb-8">
                    <h2 className="text-2xl font-bold text-slate-800">This Speed Enables New Possibilities</h2>
                    <p className="text-slate-500">Applications that were computationally impossible are now feasible</p>
                </div>

                <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {applications.map((item, i) => (
                    <div key={i}
                        className="bg-white p-6 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow duration-300 relative group overflow-hidden">
                        {/* Top accent line */}
                        <div className={`absolute top-0 left-0 right-0 h-1 ${item.badgeType==='warm' ? 'bg-orange-100'
                            : 'bg-teal-100' } group-hover:bg-opacity-100 transition-colors`}></div>

                        <div className="flex items-start justify-between mb-3">
                            <div className="text-3xl filter drop-shadow-sm">{item.icon}</div>
                            <span className={` text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wider
                                ${item.badgeType==='warm' ? 'bg-orange-50 text-orange-700 border border-orange-100'
                                : 'bg-teal-50 text-teal-700 border border-teal-100' } `}>
                                {item.badge}
                            </span>
                        </div>

                        <h4 className="font-bold text-slate-800 text-lg mb-2">{item.title}</h4>
                        <p className="text-sm text-slate-500 leading-relaxed">{item.desc}</p>
                    </div>
                    ))}
                </div>
            </div>

        </div>
    </div>
    );
    }