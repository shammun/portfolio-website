<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>PyTorch Basics | LLM From Scratch</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
    tailwind.config = {
        darkMode: "class",
        theme: {
            extend: {
                colors: {
                    "primary": "#7c3bed",
                    "primary-dark": "#6025c0",
                    "primary-light": "#efe9f9",
                    "background-light": "#f0f4f8",
                    "background-dark": "#171121",
                    "card-light": "#ffffff",
                    "card-dark": "#1f1a29",
                    "text-main": "#130e1b",
                    "text-muted": "#694d99",
                },
                fontFamily: {
                    "display": ["Inter", "sans-serif"]
                },
                boxShadow: {
                    "purple-glow": "0 20px 60px -15px rgba(124, 59, 237, 0.15)",
                }
            },
        },
    }
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
    <style type="text/css">
        :root {
            /* Editor colors */
            --jp-cell-editor-background: #f5f5f5;
            --jp-cell-editor-active-background: #e8f4fd;
            --jp-cell-editor-border-color: #e0e0e0;
            --jp-cell-editor-active-border-color: #2196f3;

            /* Syntax highlighting */
            --jp-mirror-editor-variable-color: #212121;
            --jp-mirror-editor-comment-color: #6a737d;
            --jp-mirror-editor-error-color: #d32f2f;
            --jp-mirror-editor-keyword-color: #d73a49;
            --jp-mirror-editor-operator-color: #d73a49;
            --jp-mirror-editor-punctuation-color: #212121;
            --jp-mirror-editor-number-color: #005cc5;
            --jp-mirror-editor-string-color: #032f62;

            /* Layout colors */
            --jp-layout-color0: #ffffff;
            --jp-layout-color1: #f5f5f5;
            --jp-layout-color2: #eeeeee;
            --jp-layout-color3: #e0e0e0;
            --jp-layout-color4: #bdbdbd;

            /* Content/text colors */
            --jp-content-font-color0: #000000;
            --jp-content-font-color1: #212121;
            --jp-content-font-color2: #616161;
            --jp-content-font-color3: #9e9e9e;
            --jp-content-link-color: #1976d2;

            /* UI font colors */
            --jp-ui-font-color0: #000000;
            --jp-ui-font-color1: #212121;
            --jp-ui-font-color2: #616161;
            --jp-ui-font-color3: #9e9e9e;

            /* Border colors */
            --jp-border-color0: #bdbdbd;
            --jp-border-color1: #e0e0e0;
            --jp-border-color2: #eeeeee;
            --jp-border-color3: #f5f5f5;

            /* Brand colors */
            --jp-brand-color0: #1565c0;
            --jp-brand-color1: #1976d2;
            --jp-brand-color2: #42a5f5;
            --jp-brand-color3: #90caf9;
            --jp-brand-color4: #bbdefb;

            /* Status colors */
            --jp-error-color0: #b71c1c;
            --jp-error-color1: #d32f2f;
            --jp-error-color2: #ef5350;
            --jp-error-color3: #ffcdd2;
            --jp-warn-color0: #e65100;
            --jp-warn-color1: #f57c00;
            --jp-warn-color2: #ffb74d;
            --jp-warn-color3: #ffe0b2;
            --jp-success-color0: #1b5e20;
            --jp-success-color1: #388e3c;
            --jp-success-color2: #66bb6a;
            --jp-success-color3: #c8e6c9;
            --jp-info-color0: #0d47a1;
            --jp-info-color2: #64b5f6;
            --jp-info-color3: #bbdefb;

            /* Cell prompt colors */
            --jp-cell-inprompt-font-color: #1976d2;
            --jp-cell-outprompt-font-color: #d32f2f;
            --jp-cell-prompt-not-active-font-color: #9e9e9e;
            --jp-cell-prompt-not-active-opacity: 1;
            --jp-cell-prompt-opacity: 1;

            /* Inverse colors */
            --jp-inverse-layout-color0: #212121;
            --jp-inverse-layout-color1: #424242;
            --jp-inverse-layout-color2: #616161;
            --jp-inverse-layout-color3: #757575;
            --jp-inverse-layout-color4: #9e9e9e;

            /* Rendered content */
            --jp-rendermime-error-background: #ffebee;
            --jp-rendermime-table-row-background: #f5f5f5;
            --jp-rendermime-table-row-hover-background: #eeeeee;

            /* Scrollbar */
            --jp-scrollbar-thumb-color: 150, 150, 150;
            --jp-scrollbar-background-color: #f5f5f5;

            /* Fonts */
            --jp-code-font-family: "Source Code Pro", monospace, Consolas, "Liberation Mono", Menlo, Courier, monospace;
            --jp-code-font-size: 13px;
            --jp-code-line-height: 1.5;
            --jp-content-font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            --jp-content-font-size1: 14px;
            --jp-content-line-height: 1.6;
            --jp-ui-font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            --jp-ui-font-size1: 13px;

            /* Spacing */
            --jp-border-width: 1px;
            --jp-border-radius: 4px;
            --jp-cell-padding: 8px;
            --jp-code-padding: 5px;
            --jp-notebook-padding: 16px;
            --jp-cell-prompt-width: 64px;

            /* Input */
            --jp-input-background: #ffffff;
            --jp-input-border-color: #e0e0e0;
            --jp-input-active-background: #ffffff;
            --jp-input-active-border-color: #1976d2;
            --jp-input-hover-background: #f5f5f5;

            /* Toolbar */
            --jp-toolbar-background: #f5f5f5;
            --jp-toolbar-border-color: #e0e0e0;
        }

        pre {
            line-height: 125%;
        }

        td.linenos .normal {
            color: inherit;
            background-color: transparent;
            padding-left: 5px;
            padding-right: 5px;
        }

        span.linenos {
            color: inherit;
            background-color: transparent;
            padding-left: 5px;
            padding-right: 5px;
        }

        td.linenos .special {
            color: #000000;
            background-color: #ffffc0;
            padding-left: 5px;
            padding-right: 5px;
        }

        span.linenos.special {
            color: #000000;
            background-color: #ffffc0;
            padding-left: 5px;
            padding-right: 5px;
        }

        .highlight .hll {
            background-color: var(--jp-cell-editor-active-background)
        }

        .highlight {
            background: var(--jp-cell-editor-background);
            color: var(--jp-mirror-editor-variable-color)
        }

        .highlight .c {
            color: var(--jp-mirror-editor-comment-color);
            font-style: italic
        }

        /* Comment */
        .highlight .err {
            color: var(--jp-mirror-editor-error-color)
        }

        /* Error */
        .highlight .k {
            color: var(--jp-mirror-editor-keyword-color);
            font-weight: bold
        }

        /* Keyword */
        .highlight .o {
            color: var(--jp-mirror-editor-operator-color);
            font-weight: bold
        }

        /* Operator */
        .highlight .p {
            color: var(--jp-mirror-editor-punctuation-color)
        }

        /* Punctuation */
        .highlight .ch {
            color: var(--jp-mirror-editor-comment-color);
            font-style: italic
        }

        /* Comment.Hashbang */
        .highlight .cm {
            color: var(--jp-mirror-editor-comment-color);
            font-style: italic
        }

        /* Comment.Multiline */
        .highlight .cp {
            color: var(--jp-mirror-editor-comment-color);
            font-style: italic
        }

        /* Comment.Preproc */
        .highlight .cpf {
            color: var(--jp-mirror-editor-comment-color);
            font-style: italic
        }

        /* Comment.PreprocFile */
        .highlight .c1 {
            color: var(--jp-mirror-editor-comment-color);
            font-style: italic
        }

        /* Comment.Single */
        .highlight .cs {
            color: var(--jp-mirror-editor-comment-color);
            font-style: italic
        }

        /* Comment.Special */
        .highlight .kc {
            color: var(--jp-mirror-editor-keyword-color);
            font-weight: bold
        }

        /* Keyword.Constant */
        .highlight .kd {
            color: var(--jp-mirror-editor-keyword-color);
            font-weight: bold
        }

        /* Keyword.Declaration */
        .highlight .kn {
            color: var(--jp-mirror-editor-keyword-color);
            font-weight: bold
        }

        /* Keyword.Namespace */
        .highlight .kp {
            color: var(--jp-mirror-editor-keyword-color);
            font-weight: bold
        }

        /* Keyword.Pseudo */
        .highlight .kr {
            color: var(--jp-mirror-editor-keyword-color);
            font-weight: bold
        }

        /* Keyword.Reserved */
        .highlight .kt {
            color: var(--jp-mirror-editor-keyword-color);
            font-weight: bold
        }

        /* Keyword.Type */
        .highlight .m {
            color: var(--jp-mirror-editor-number-color)
        }

        /* Literal.Number */
        .highlight .s {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String */
        .highlight .ow {
            color: var(--jp-mirror-editor-operator-color);
            font-weight: bold
        }

        /* Operator.Word */
        .highlight .pm {
            color: var(--jp-mirror-editor-punctuation-color)
        }

        /* Punctuation.Marker */
        .highlight .w {
            color: var(--jp-mirror-editor-variable-color)
        }

        /* Text.Whitespace */
        .highlight .mb {
            color: var(--jp-mirror-editor-number-color)
        }

        /* Literal.Number.Bin */
        .highlight .mf {
            color: var(--jp-mirror-editor-number-color)
        }

        /* Literal.Number.Float */
        .highlight .mh {
            color: var(--jp-mirror-editor-number-color)
        }

        /* Literal.Number.Hex */
        .highlight .mi {
            color: var(--jp-mirror-editor-number-color)
        }

        /* Literal.Number.Integer */
        .highlight .mo {
            color: var(--jp-mirror-editor-number-color)
        }

        /* Literal.Number.Oct */
        .highlight .sa {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Affix */
        .highlight .sb {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Backtick */
        .highlight .sc {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Char */
        .highlight .dl {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Delimiter */
        .highlight .sd {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Doc */
        .highlight .s2 {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Double */
        .highlight .se {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Escape */
        .highlight .sh {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Heredoc */
        .highlight .si {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Interpol */
        .highlight .sx {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Other */
        .highlight .sr {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Regex */
        .highlight .s1 {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Single */
        .highlight .ss {
            color: var(--jp-mirror-editor-string-color)
        }

        /* Literal.String.Symbol */
        .highlight .il {
            color: var(--jp-mirror-editor-number-color)
        }

        /* Literal.Number.Integer.Long */

        /* Custom Header Styling */
        .jp-MarkdownOutput h1 {
            font-size: 2.5em !important;
            font-weight: 700 !important;
            color: #1a1a2e !important;
            border-bottom: 3px solid #00d9ff !important;
            padding-bottom: 0.5em !important;
            margin-top: 1.5em !important;
            margin-bottom: 1em !important;
        }

        .jp-MarkdownOutput h2 {
            font-size: 2em !important;
            font-weight: 700 !important;
            color: #16213e !important;
            border-bottom: 2px solid #4a90e2 !important;
            padding-bottom: 0.4em !important;
            margin-top: 1.5em !important;
            margin-bottom: 0.8em !important;
        }

        .jp-MarkdownOutput h3 {
            font-size: 1.5em !important;
            font-weight: 600 !important;
            color: #2c3e50 !important;
            margin-top: 1.3em !important;
            margin-bottom: 0.7em !important;
            padding-left: 0.5em !important;
            border-left: 4px solid #00d9ff !important;
        }

        .jp-MarkdownOutput h4 {
            font-size: 1.3em !important;
            font-weight: 600 !important;
            color: #34495e !important;
            margin-top: 1.2em !important;
            margin-bottom: 0.6em !important;
        }

        .jp-MarkdownOutput h5 {
            font-size: 1.1em !important;
            font-weight: 600 !important;
            color: #546e7a !important;
            margin-top: 1em !important;
            margin-bottom: 0.5em !important;
            font-style: italic !important;
        }

        .jp-MarkdownOutput h6 {
            font-size: 1em !important;
            font-weight: 600 !important;
            color: #607d8b !important;
            margin-top: 0.8em !important;
            margin-bottom: 0.4em !important;
        }

        /* Remove the anchor link Â¶ symbol styling */
        .jp-MarkdownOutput .anchor-link {
            display: none !important;
        }

        /* Bold styling for strong tags */
        .jp-MarkdownOutput strong {
            font-weight: 700 !important;
            color: #1a1a2e !important;
        }

        /* Improve paragraph spacing */
        .jp-MarkdownOutput p {
            margin-top: 0.8em !important;
            margin-bottom: 0.8em !important;
            line-height: 1.7 !important;
        }

        /* Code block styling */
        .jp-MarkdownOutput code {
            background-color: #f5f5f5 !important;
            padding: 0.2em 0.4em !important;
            border-radius: 3px !important;
            font-family: 'Source Code Pro', monospace !important;
            font-size: 0.9em !important;
            color: #d73a49 !important;
        }
    </style>
    <style type="text/css">
        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*
 * Mozilla scrollbar styling
 */

        /* use standard opaque scrollbars for most nodes */
        [data-jp-theme-scrollbars='true'] {
            scrollbar-color: rgb(var(--jp-scrollbar-thumb-color)) var(--jp-scrollbar-background-color);
        }

        /* for code nodes, use a transparent style of scrollbar. These selectors
 * will match lower in the tree, and so will override the above */
        [data-jp-theme-scrollbars='true'] .CodeMirror-hscrollbar,
        [data-jp-theme-scrollbars='true'] .CodeMirror-vscrollbar {
            scrollbar-color: rgba(var(--jp-scrollbar-thumb-color), 0.5) transparent;
        }

        /* tiny scrollbar */

        .jp-scrollbar-tiny {
            scrollbar-color: rgba(var(--jp-scrollbar-thumb-color), 0.5) transparent;
            scrollbar-width: thin;
        }

        /* tiny scrollbar */

        .jp-scrollbar-tiny::-webkit-scrollbar,
        .jp-scrollbar-tiny::-webkit-scrollbar-corner {
            background-color: transparent;
            height: 4px;
            width: 4px;
        }

        .jp-scrollbar-tiny::-webkit-scrollbar-thumb {
            background: rgba(var(--jp-scrollbar-thumb-color), 0.5);
        }

        .jp-scrollbar-tiny::-webkit-scrollbar-track:horizontal {
            border-left: 0 solid transparent;
            border-right: 0 solid transparent;
        }

        .jp-scrollbar-tiny::-webkit-scrollbar-track:vertical {
            border-top: 0 solid transparent;
            border-bottom: 0 solid transparent;
        }

        /*
 * Lumino
 */

        .lm-ScrollBar[data-orientation='horizontal'] {
            min-height: 16px;
            max-height: 16px;
            min-width: 45px;
            border-top: 1px solid #a0a0a0;
        }

        .lm-ScrollBar[data-orientation='vertical'] {
            min-width: 16px;
            max-width: 16px;
            min-height: 45px;
            border-left: 1px solid #a0a0a0;
        }

        .lm-ScrollBar-button {
            background-color: #f0f0f0;
            background-position: center center;
            min-height: 15px;
            max-height: 15px;
            min-width: 15px;
            max-width: 15px;
        }

        .lm-ScrollBar-button:hover {
            background-color: #dadada;
        }

        .lm-ScrollBar-button.lm-mod-active {
            background-color: #cdcdcd;
        }

        .lm-ScrollBar-track {
            background: #f0f0f0;
        }

        .lm-ScrollBar-thumb {
            background: #cdcdcd;
        }

        .lm-ScrollBar-thumb:hover {
            background: #bababa;
        }

        .lm-ScrollBar-thumb.lm-mod-active {
            background: #a0a0a0;
        }

        .lm-ScrollBar[data-orientation='horizontal'] .lm-ScrollBar-thumb {
            height: 100%;
            min-width: 15px;
            border-left: 1px solid #a0a0a0;
            border-right: 1px solid #a0a0a0;
        }

        .lm-ScrollBar[data-orientation='vertical'] .lm-ScrollBar-thumb {
            width: 100%;
            min-height: 15px;
            border-top: 1px solid #a0a0a0;
            border-bottom: 1px solid #a0a0a0;
        }

        .lm-ScrollBar[data-orientation='horizontal'] .lm-ScrollBar-button[data-action='decrement'] {
            background-image: var(--jp-icon-caret-left);
            background-size: 17px;
        }

        .lm-ScrollBar[data-orientation='horizontal'] .lm-ScrollBar-button[data-action='increment'] {
            background-image: var(--jp-icon-caret-right);
            background-size: 17px;
        }

        .lm-ScrollBar[data-orientation='vertical'] .lm-ScrollBar-button[data-action='decrement'] {
            background-image: var(--jp-icon-caret-up);
            background-size: 17px;
        }

        .lm-ScrollBar[data-orientation='vertical'] .lm-ScrollBar-button[data-action='increment'] {
            background-image: var(--jp-icon-caret-down);
            background-size: 17px;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

        .lm-Widget {
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
        }

        .lm-Widget.lm-mod-hidden {
            display: none !important;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        .lm-AccordionPanel[data-orientation='horizontal']>.lm-AccordionPanel-title {
            /* Title is rotated for horizontal accordion panel using CSS */
            display: block;
            transform-origin: top left;
            transform: rotate(-90deg) translate(-100%);
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

        .lm-CommandPalette {
            display: flex;
            flex-direction: column;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .lm-CommandPalette-search {
            flex: 0 0 auto;
        }

        .lm-CommandPalette-content {
            flex: 1 1 auto;
            margin: 0;
            padding: 0;
            min-height: 0;
            overflow: auto;
            list-style-type: none;
        }

        .lm-CommandPalette-header {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        .lm-CommandPalette-item {
            display: flex;
            flex-direction: row;
        }

        .lm-CommandPalette-itemIcon {
            flex: 0 0 auto;
        }

        .lm-CommandPalette-itemContent {
            flex: 1 1 auto;
            overflow: hidden;
        }

        .lm-CommandPalette-itemShortcut {
            flex: 0 0 auto;
        }

        .lm-CommandPalette-itemLabel {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        .lm-close-icon {
            border: 1px solid transparent;
            background-color: transparent;
            position: absolute;
            z-index: 1;
            right: 3%;
            top: 0;
            bottom: 0;
            margin: auto;
            padding: 7px 0;
            display: none;
            vertical-align: middle;
            outline: 0;
            cursor: pointer;
        }

        .lm-close-icon:after {
            content: 'X';
            display: block;
            width: 15px;
            height: 15px;
            text-align: center;
            color: #000;
            font-weight: normal;
            font-size: 12px;
            cursor: pointer;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

        .lm-DockPanel {
            z-index: 0;
        }

        .lm-DockPanel-widget {
            z-index: 0;
        }

        .lm-DockPanel-tabBar {
            z-index: 1;
        }

        .lm-DockPanel-handle {
            z-index: 2;
        }

        .lm-DockPanel-handle.lm-mod-hidden {
            display: none !important;
        }

        .lm-DockPanel-handle:after {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            content: '';
        }

        .lm-DockPanel-handle[data-orientation='horizontal'] {
            cursor: ew-resize;
        }

        .lm-DockPanel-handle[data-orientation='vertical'] {
            cursor: ns-resize;
        }

        .lm-DockPanel-handle[data-orientation='horizontal']:after {
            left: 50%;
            min-width: 8px;
            transform: translateX(-50%);
        }

        .lm-DockPanel-handle[data-orientation='vertical']:after {
            top: 50%;
            min-height: 8px;
            transform: translateY(-50%);
        }

        .lm-DockPanel-overlay {
            z-index: 3;
            box-sizing: border-box;
            pointer-events: none;
        }

        .lm-DockPanel-overlay.lm-mod-hidden {
            display: none !important;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

        .lm-Menu {
            z-index: 10000;
            position: absolute;
            white-space: nowrap;
            overflow-x: hidden;
            overflow-y: auto;
            outline: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .lm-Menu-content {
            margin: 0;
            padding: 0;
            display: table;
            list-style-type: none;
        }

        .lm-Menu-item {
            display: table-row;
        }

        .lm-Menu-item.lm-mod-hidden,
        .lm-Menu-item.lm-mod-collapsed {
            display: none !important;
        }

        .lm-Menu-itemIcon,
        .lm-Menu-itemSubmenuIcon {
            display: table-cell;
            text-align: center;
        }

        .lm-Menu-itemLabel {
            display: table-cell;
            text-align: left;
        }

        .lm-Menu-itemShortcut {
            display: table-cell;
            text-align: right;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

        .lm-MenuBar {
            outline: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .lm-MenuBar-content {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: row;
            list-style-type: none;
        }

        .lm-MenuBar-item {
            box-sizing: border-box;
        }

        .lm-MenuBar-itemIcon,
        .lm-MenuBar-itemLabel {
            display: inline-block;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

        .lm-ScrollBar {
            display: flex;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .lm-ScrollBar[data-orientation='horizontal'] {
            flex-direction: row;
        }

        .lm-ScrollBar[data-orientation='vertical'] {
            flex-direction: column;
        }

        .lm-ScrollBar-button {
            box-sizing: border-box;
            flex: 0 0 auto;
        }

        .lm-ScrollBar-track {
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
            flex: 1 1 auto;
        }

        .lm-ScrollBar-thumb {
            box-sizing: border-box;
            position: absolute;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

        .lm-SplitPanel-child {
            z-index: 0;
        }

        .lm-SplitPanel-handle {
            z-index: 1;
        }

        .lm-SplitPanel-handle.lm-mod-hidden {
            display: none !important;
        }

        .lm-SplitPanel-handle:after {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            content: '';
        }

        .lm-SplitPanel[data-orientation='horizontal']>.lm-SplitPanel-handle {
            cursor: ew-resize;
        }

        .lm-SplitPanel[data-orientation='vertical']>.lm-SplitPanel-handle {
            cursor: ns-resize;
        }

        .lm-SplitPanel[data-orientation='horizontal']>.lm-SplitPanel-handle:after {
            left: 50%;
            min-width: 8px;
            transform: translateX(-50%);
        }

        .lm-SplitPanel[data-orientation='vertical']>.lm-SplitPanel-handle:after {
            top: 50%;
            min-height: 8px;
            transform: translateY(-50%);
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

        .lm-TabBar {
            display: flex;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .lm-TabBar[data-orientation='horizontal'] {
            flex-direction: row;
            align-items: flex-end;
        }

        .lm-TabBar[data-orientation='vertical'] {
            flex-direction: column;
            align-items: flex-end;
        }

        .lm-TabBar-content {
            margin: 0;
            padding: 0;
            display: flex;
            flex: 1 1 auto;
            list-style-type: none;
        }

        .lm-TabBar[data-orientation='horizontal']>.lm-TabBar-content {
            flex-direction: row;
        }

        .lm-TabBar[data-orientation='vertical']>.lm-TabBar-content {
            flex-direction: column;
        }

        .lm-TabBar-tab {
            display: flex;
            flex-direction: row;
            box-sizing: border-box;
            overflow: hidden;
            touch-action: none;
            /* Disable native Drag/Drop */
        }

        .lm-TabBar-tabIcon,
        .lm-TabBar-tabCloseIcon {
            flex: 0 0 auto;
        }

        .lm-TabBar-tabLabel {
            flex: 1 1 auto;
            overflow: hidden;
            white-space: nowrap;
        }

        .lm-TabBar-tabInput {
            user-select: all;
            width: 100%;
            box-sizing: border-box;
        }

        .lm-TabBar-tab.lm-mod-hidden {
            display: none !important;
        }

        .lm-TabBar-addButton.lm-mod-hidden {
            display: none !important;
        }

        .lm-TabBar.lm-mod-dragging .lm-TabBar-tab {
            position: relative;
        }

        .lm-TabBar.lm-mod-dragging[data-orientation='horizontal'] .lm-TabBar-tab {
            left: 0;
            transition: left 150ms ease;
        }

        .lm-TabBar.lm-mod-dragging[data-orientation='vertical'] .lm-TabBar-tab {
            top: 0;
            transition: top 150ms ease;
        }

        .lm-TabBar.lm-mod-dragging .lm-TabBar-tab.lm-mod-dragging {
            transition: none;
        }

        .lm-TabBar-tabLabel .lm-TabBar-tabInput {
            user-select: all;
            width: 100%;
            box-sizing: border-box;
            background: inherit;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

        .lm-TabPanel-tabBar {
            z-index: 1;
        }

        .lm-TabPanel-stackedPanel {
            z-index: 0;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-Collapse {
            display: flex;
            flex-direction: column;
            align-items: stretch;
        }

        .jp-Collapse-header {
            padding: 1px 12px;
            background-color: var(--jp-layout-color1);
            border-bottom: solid var(--jp-border-width) var(--jp-border-color2);
            color: var(--jp-ui-font-color1);
            cursor: pointer;
            display: flex;
            align-items: center;
            font-size: var(--jp-ui-font-size0);
            font-weight: 600;
            text-transform: uppercase;
            user-select: none;
        }

        .jp-Collapser-icon {
            height: 16px;
        }

        .jp-Collapse-header-collapsed .jp-Collapser-icon {
            transform: rotate(-90deg);
            margin: auto 0;
        }

        .jp-Collapser-title {
            line-height: 25px;
        }

        .jp-Collapse-contents {
            padding: 0 12px;
            background-color: var(--jp-layout-color1);
            color: var(--jp-ui-font-color1);
            overflow: auto;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /* This file was auto-generated by ensureUiComponents() in @jupyterlab/buildutils */

        /**
 * (DEPRECATED) Support for consuming icons as CSS background images
 */

        /* Icons urls */

        /* Icon CSS class declarations */

        .jp-AddAboveIcon {
            background-image: var(--jp-icon-add-above);
        }

        .jp-AddBelowIcon {
            background-image: var(--jp-icon-add-below);
        }

        .jp-AddIcon {
            background-image: var(--jp-icon-add);
        }

        .jp-BellIcon {
            background-image: var(--jp-icon-bell);
        }

        .jp-BugDotIcon {
            background-image: var(--jp-icon-bug-dot);
        }

        .jp-BugIcon {
            background-image: var(--jp-icon-bug);
        }

        .jp-BuildIcon {
            background-image: var(--jp-icon-build);
        }

        .jp-CaretDownEmptyIcon {
            background-image: var(--jp-icon-caret-down-empty);
        }

        .jp-CaretDownEmptyThinIcon {
            background-image: var(--jp-icon-caret-down-empty-thin);
        }

        .jp-CaretDownIcon {
            background-image: var(--jp-icon-caret-down);
        }

        .jp-CaretLeftIcon {
            background-image: var(--jp-icon-caret-left);
        }

        .jp-CaretRightIcon {
            background-image: var(--jp-icon-caret-right);
        }

        .jp-CaretUpEmptyThinIcon {
            background-image: var(--jp-icon-caret-up-empty-thin);
        }

        .jp-CaretUpIcon {
            background-image: var(--jp-icon-caret-up);
        }

        .jp-CaseSensitiveIcon {
            background-image: var(--jp-icon-case-sensitive);
        }

        .jp-CheckIcon {
            background-image: var(--jp-icon-check);
        }

        .jp-CircleEmptyIcon {
            background-image: var(--jp-icon-circle-empty);
        }

        .jp-CircleIcon {
            background-image: var(--jp-icon-circle);
        }

        .jp-ClearIcon {
            background-image: var(--jp-icon-clear);
        }

        .jp-CloseIcon {
            background-image: var(--jp-icon-close);
        }

        .jp-CodeCheckIcon {
            background-image: var(--jp-icon-code-check);
        }

        .jp-CodeIcon {
            background-image: var(--jp-icon-code);
        }

        .jp-CollapseAllIcon {
            background-image: var(--jp-icon-collapse-all);
        }

        .jp-ConsoleIcon {
            background-image: var(--jp-icon-console);
        }

        .jp-CopyIcon {
            background-image: var(--jp-icon-copy);
        }

        .jp-CopyrightIcon {
            background-image: var(--jp-icon-copyright);
        }

        .jp-CutIcon {
            background-image: var(--jp-icon-cut);
        }

        .jp-DeleteIcon {
            background-image: var(--jp-icon-delete);
        }

        .jp-DownloadIcon {
            background-image: var(--jp-icon-download);
        }

        .jp-DuplicateIcon {
            background-image: var(--jp-icon-duplicate);
        }

        .jp-EditIcon {
            background-image: var(--jp-icon-edit);
        }

        .jp-EllipsesIcon {
            background-image: var(--jp-icon-ellipses);
        }

        .jp-ErrorIcon {
            background-image: var(--jp-icon-error);
        }

        .jp-ExpandAllIcon {
            background-image: var(--jp-icon-expand-all);
        }

        .jp-ExtensionIcon {
            background-image: var(--jp-icon-extension);
        }

        .jp-FastForwardIcon {
            background-image: var(--jp-icon-fast-forward);
        }

        .jp-FileIcon {
            background-image: var(--jp-icon-file);
        }

        .jp-FileUploadIcon {
            background-image: var(--jp-icon-file-upload);
        }

        .jp-FilterDotIcon {
            background-image: var(--jp-icon-filter-dot);
        }

        .jp-FilterIcon {
            background-image: var(--jp-icon-filter);
        }

        .jp-FilterListIcon {
            background-image: var(--jp-icon-filter-list);
        }

        .jp-FolderFavoriteIcon {
            background-image: var(--jp-icon-folder-favorite);
        }

        .jp-FolderIcon {
            background-image: var(--jp-icon-folder);
        }

        .jp-HomeIcon {
            background-image: var(--jp-icon-home);
        }

        .jp-Html5Icon {
            background-image: var(--jp-icon-html5);
        }

        .jp-ImageIcon {
            background-image: var(--jp-icon-image);
        }

        .jp-InfoIcon {
            background-image: var(--jp-icon-info);
        }

        .jp-InspectorIcon {
            background-image: var(--jp-icon-inspector);
        }

        .jp-JsonIcon {
            background-image: var(--jp-icon-json);
        }

        .jp-JuliaIcon {
            background-image: var(--jp-icon-julia);
        }

        .jp-JupyterFaviconIcon {
            background-image: var(--jp-icon-jupyter-favicon);
        }

        .jp-JupyterIcon {
            background-image: var(--jp-icon-jupyter);
        }

        .jp-JupyterlabWordmarkIcon {
            background-image: var(--jp-icon-jupyterlab-wordmark);
        }

        .jp-KernelIcon {
            background-image: var(--jp-icon-kernel);
        }

        .jp-KeyboardIcon {
            background-image: var(--jp-icon-keyboard);
        }

        .jp-LaunchIcon {
            background-image: var(--jp-icon-launch);
        }

        .jp-LauncherIcon {
            background-image: var(--jp-icon-launcher);
        }

        .jp-LineFormIcon {
            background-image: var(--jp-icon-line-form);
        }

        .jp-LinkIcon {
            background-image: var(--jp-icon-link);
        }

        .jp-ListIcon {
            background-image: var(--jp-icon-list);
        }

        .jp-MarkdownIcon {
            background-image: var(--jp-icon-markdown);
        }

        .jp-MoveDownIcon {
            background-image: var(--jp-icon-move-down);
        }

        .jp-MoveUpIcon {
            background-image: var(--jp-icon-move-up);
        }

        .jp-NewFolderIcon {
            background-image: var(--jp-icon-new-folder);
        }

        .jp-NotTrustedIcon {
            background-image: var(--jp-icon-not-trusted);
        }

        .jp-NotebookIcon {
            background-image: var(--jp-icon-notebook);
        }

        .jp-NumberingIcon {
            background-image: var(--jp-icon-numbering);
        }

        .jp-OfflineBoltIcon {
            background-image: var(--jp-icon-offline-bolt);
        }

        .jp-PaletteIcon {
            background-image: var(--jp-icon-palette);
        }

        .jp-PasteIcon {
            background-image: var(--jp-icon-paste);
        }

        .jp-PdfIcon {
            background-image: var(--jp-icon-pdf);
        }

        .jp-PythonIcon {
            background-image: var(--jp-icon-python);
        }

        .jp-RKernelIcon {
            background-image: var(--jp-icon-r-kernel);
        }

        .jp-ReactIcon {
            background-image: var(--jp-icon-react);
        }

        .jp-RedoIcon {
            background-image: var(--jp-icon-redo);
        }

        .jp-RefreshIcon {
            background-image: var(--jp-icon-refresh);
        }

        .jp-RegexIcon {
            background-image: var(--jp-icon-regex);
        }

        .jp-RunIcon {
            background-image: var(--jp-icon-run);
        }

        .jp-RunningIcon {
            background-image: var(--jp-icon-running);
        }

        .jp-SaveIcon {
            background-image: var(--jp-icon-save);
        }

        .jp-SearchIcon {
            background-image: var(--jp-icon-search);
        }

        .jp-SettingsIcon {
            background-image: var(--jp-icon-settings);
        }

        .jp-ShareIcon {
            background-image: var(--jp-icon-share);
        }

        .jp-SpreadsheetIcon {
            background-image: var(--jp-icon-spreadsheet);
        }

        .jp-StopIcon {
            background-image: var(--jp-icon-stop);
        }

        .jp-TabIcon {
            background-image: var(--jp-icon-tab);
        }

        .jp-TableRowsIcon {
            background-image: var(--jp-icon-table-rows);
        }

        .jp-TagIcon {
            background-image: var(--jp-icon-tag);
        }

        .jp-TerminalIcon {
            background-image: var(--jp-icon-terminal);
        }

        .jp-TextEditorIcon {
            background-image: var(--jp-icon-text-editor);
        }

        .jp-TocIcon {
            background-image: var(--jp-icon-toc);
        }

        .jp-TreeViewIcon {
            background-image: var(--jp-icon-tree-view);
        }

        .jp-TrustedIcon {
            background-image: var(--jp-icon-trusted);
        }

        .jp-UndoIcon {
            background-image: var(--jp-icon-undo);
        }

        .jp-UserIcon {
            background-image: var(--jp-icon-user);
        }

        .jp-UsersIcon {
            background-image: var(--jp-icon-users);
        }

        .jp-VegaIcon {
            background-image: var(--jp-icon-vega);
        }

        .jp-WordIcon {
            background-image: var(--jp-icon-word);
        }

        .jp-YamlIcon {
            background-image: var(--jp-icon-yaml);
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /**
 * (DEPRECATED) Support for consuming icons as CSS background images
 */

        .jp-Icon,
        .jp-MaterialIcon {
            background-position: center;
            background-repeat: no-repeat;
            background-size: 16px;
            min-width: 16px;
            min-height: 16px;
        }

        .jp-Icon-cover {
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
        }

        /**
 * (DEPRECATED) Support for specific CSS icon sizes
 */

        .jp-Icon-16 {
            background-size: 16px;
            min-width: 16px;
            min-height: 16px;
        }

        .jp-Icon-18 {
            background-size: 18px;
            min-width: 18px;
            min-height: 18px;
        }

        .jp-Icon-20 {
            background-size: 20px;
            min-width: 20px;
            min-height: 20px;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .lm-TabBar .lm-TabBar-addButton {
            align-items: center;
            display: flex;
            padding: 4px;
            padding-bottom: 5px;
            margin-right: 1px;
            background-color: var(--jp-layout-color2);
        }

        .lm-TabBar .lm-TabBar-addButton:hover {
            background-color: var(--jp-layout-color1);
        }

        .lm-DockPanel-tabBar .lm-TabBar-tab {
            width: var(--jp-private-horizontal-tab-width);
        }

        .lm-DockPanel-tabBar .lm-TabBar-content {
            flex: unset;
        }

        .lm-DockPanel-tabBar[data-orientation='horizontal'] {
            flex: 1 1 auto;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /**
 * Support for icons as inline SVG HTMLElements
 */

        /* recolor the primary elements of an icon */
        .jp-icon0[fill] {
            fill: var(--jp-inverse-layout-color0);
        }

        .jp-icon1[fill] {
            fill: var(--jp-inverse-layout-color1);
        }

        .jp-icon2[fill] {
            fill: var(--jp-inverse-layout-color2);
        }

        .jp-icon3[fill] {
            fill: var(--jp-inverse-layout-color3);
        }

        .jp-icon4[fill] {
            fill: var(--jp-inverse-layout-color4);
        }

        .jp-icon0[stroke] {
            stroke: var(--jp-inverse-layout-color0);
        }

        .jp-icon1[stroke] {
            stroke: var(--jp-inverse-layout-color1);
        }

        .jp-icon2[stroke] {
            stroke: var(--jp-inverse-layout-color2);
        }

        .jp-icon3[stroke] {
            stroke: var(--jp-inverse-layout-color3);
        }

        .jp-icon4[stroke] {
            stroke: var(--jp-inverse-layout-color4);
        }

        /* recolor the accent elements of an icon */
        .jp-icon-accent0[fill] {
            fill: var(--jp-layout-color0);
        }

        .jp-icon-accent1[fill] {
            fill: var(--jp-layout-color1);
        }

        .jp-icon-accent2[fill] {
            fill: var(--jp-layout-color2);
        }

        .jp-icon-accent3[fill] {
            fill: var(--jp-layout-color3);
        }

        .jp-icon-accent4[fill] {
            fill: var(--jp-layout-color4);
        }

        .jp-icon-accent0[stroke] {
            stroke: var(--jp-layout-color0);
        }

        .jp-icon-accent1[stroke] {
            stroke: var(--jp-layout-color1);
        }

        .jp-icon-accent2[stroke] {
            stroke: var(--jp-layout-color2);
        }

        .jp-icon-accent3[stroke] {
            stroke: var(--jp-layout-color3);
        }

        .jp-icon-accent4[stroke] {
            stroke: var(--jp-layout-color4);
        }

        /* set the color of an icon to transparent */
        .jp-icon-none[fill] {
            fill: none;
        }

        .jp-icon-none[stroke] {
            stroke: none;
        }

        /* brand icon colors. Same for light and dark */
        .jp-icon-brand0[fill] {
            fill: var(--jp-brand-color0);
        }

        .jp-icon-brand1[fill] {
            fill: var(--jp-brand-color1);
        }

        .jp-icon-brand2[fill] {
            fill: var(--jp-brand-color2);
        }

        .jp-icon-brand3[fill] {
            fill: var(--jp-brand-color3);
        }

        .jp-icon-brand4[fill] {
            fill: var(--jp-brand-color4);
        }

        .jp-icon-brand0[stroke] {
            stroke: var(--jp-brand-color0);
        }

        .jp-icon-brand1[stroke] {
            stroke: var(--jp-brand-color1);
        }

        .jp-icon-brand2[stroke] {
            stroke: var(--jp-brand-color2);
        }

        .jp-icon-brand3[stroke] {
            stroke: var(--jp-brand-color3);
        }

        .jp-icon-brand4[stroke] {
            stroke: var(--jp-brand-color4);
        }

        /* warn icon colors. Same for light and dark */
        .jp-icon-warn0[fill] {
            fill: var(--jp-warn-color0);
        }

        .jp-icon-warn1[fill] {
            fill: var(--jp-warn-color1);
        }

        .jp-icon-warn2[fill] {
            fill: var(--jp-warn-color2);
        }

        .jp-icon-warn3[fill] {
            fill: var(--jp-warn-color3);
        }

        .jp-icon-warn0[stroke] {
            stroke: var(--jp-warn-color0);
        }

        .jp-icon-warn1[stroke] {
            stroke: var(--jp-warn-color1);
        }

        .jp-icon-warn2[stroke] {
            stroke: var(--jp-warn-color2);
        }

        .jp-icon-warn3[stroke] {
            stroke: var(--jp-warn-color3);
        }

        /* icon colors that contrast well with each other and most backgrounds */
        .jp-icon-contrast0[fill] {
            fill: var(--jp-icon-contrast-color0);
        }

        .jp-icon-contrast1[fill] {
            fill: var(--jp-icon-contrast-color1);
        }

        .jp-icon-contrast2[fill] {
            fill: var(--jp-icon-contrast-color2);
        }

        .jp-icon-contrast3[fill] {
            fill: var(--jp-icon-contrast-color3);
        }

        .jp-icon-contrast0[stroke] {
            stroke: var(--jp-icon-contrast-color0);
        }

        .jp-icon-contrast1[stroke] {
            stroke: var(--jp-icon-contrast-color1);
        }

        .jp-icon-contrast2[stroke] {
            stroke: var(--jp-icon-contrast-color2);
        }

        .jp-icon-contrast3[stroke] {
            stroke: var(--jp-icon-contrast-color3);
        }

        .jp-icon-dot[fill] {
            fill: var(--jp-warn-color0);
        }

        .jp-jupyter-icon-color[fill] {
            fill: var(--jp-jupyter-icon-color, var(--jp-warn-color0));
        }

        .jp-notebook-icon-color[fill] {
            fill: var(--jp-notebook-icon-color, var(--jp-warn-color0));
        }

        .jp-json-icon-color[fill] {
            fill: var(--jp-json-icon-color, var(--jp-warn-color1));
        }

        .jp-console-icon-color[fill] {
            fill: var(--jp-console-icon-color, white);
        }

        .jp-console-icon-background-color[fill] {
            fill: var(--jp-console-icon-background-color, var(--jp-brand-color1));
        }

        .jp-terminal-icon-color[fill] {
            fill: var(--jp-terminal-icon-color, var(--jp-layout-color2));
        }

        .jp-terminal-icon-background-color[fill] {
            fill: var(--jp-terminal-icon-background-color,
                    var(--jp-inverse-layout-color2));
        }

        .jp-text-editor-icon-color[fill] {
            fill: var(--jp-text-editor-icon-color, var(--jp-inverse-layout-color3));
        }

        .jp-inspector-icon-color[fill] {
            fill: var(--jp-inspector-icon-color, var(--jp-inverse-layout-color3));
        }

        /* CSS for icons in selected filebrowser listing items */
        .jp-DirListing-item.jp-mod-selected .jp-icon-selectable[fill] {
            fill: #fff;
        }

        .jp-DirListing-item.jp-mod-selected .jp-icon-selectable-inverse[fill] {
            fill: var(--jp-brand-color1);
        }

        /* stylelint-disable selector-max-class, selector-max-compound-selectors */

        /**
* TODO: come up with non css-hack solution for showing the busy icon on top
*  of the close icon
* CSS for complex behavior of close icon of tabs in the main area tabbar
*/
        .lm-DockPanel-tabBar .lm-TabBar-tab.lm-mod-closable.jp-mod-dirty>.lm-TabBar-tabCloseIcon> :not(:hover)>.jp-icon3[fill] {
            fill: none;
        }

        .lm-DockPanel-tabBar .lm-TabBar-tab.lm-mod-closable.jp-mod-dirty>.lm-TabBar-tabCloseIcon> :not(:hover)>.jp-icon-busy[fill] {
            fill: var(--jp-inverse-layout-color3);
        }

        /* stylelint-enable selector-max-class, selector-max-compound-selectors */

        /* CSS for icons in status bar */
        #jp-main-statusbar .jp-mod-selected .jp-icon-selectable[fill] {
            fill: #fff;
        }

        #jp-main-statusbar .jp-mod-selected .jp-icon-selectable-inverse[fill] {
            fill: var(--jp-brand-color1);
        }

        /* special handling for splash icon CSS. While the theme CSS reloads during
   splash, the splash icon can loose theming. To prevent that, we set a
   default for its color variable */
        /* not sure what to do with this one, used in filebrowser listing */
        .jp-DragIcon {
            margin-right: 4px;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /**
 * Support for alt colors for icons as inline SVG HTMLElements
 */

        /* alt recolor the primary elements of an icon */
        .jp-icon-alt .jp-icon0[fill] {
            fill: var(--jp-layout-color0);
        }

        .jp-icon-alt .jp-icon1[fill] {
            fill: var(--jp-layout-color1);
        }

        .jp-icon-alt .jp-icon2[fill] {
            fill: var(--jp-layout-color2);
        }

        .jp-icon-alt .jp-icon3[fill] {
            fill: var(--jp-layout-color3);
        }

        .jp-icon-alt .jp-icon4[fill] {
            fill: var(--jp-layout-color4);
        }

        .jp-icon-alt .jp-icon0[stroke] {
            stroke: var(--jp-layout-color0);
        }

        .jp-icon-alt .jp-icon1[stroke] {
            stroke: var(--jp-layout-color1);
        }

        .jp-icon-alt .jp-icon2[stroke] {
            stroke: var(--jp-layout-color2);
        }

        .jp-icon-alt .jp-icon3[stroke] {
            stroke: var(--jp-layout-color3);
        }

        .jp-icon-alt .jp-icon4[stroke] {
            stroke: var(--jp-layout-color4);
        }

        /* alt recolor the accent elements of an icon */
        .jp-icon-alt .jp-icon-accent0[fill] {
            fill: var(--jp-inverse-layout-color0);
        }

        .jp-icon-alt .jp-icon-accent1[fill] {
            fill: var(--jp-inverse-layout-color1);
        }

        .jp-icon-alt .jp-icon-accent2[fill] {
            fill: var(--jp-inverse-layout-color2);
        }

        .jp-icon-alt .jp-icon-accent3[fill] {
            fill: var(--jp-inverse-layout-color3);
        }

        .jp-icon-alt .jp-icon-accent4[fill] {
            fill: var(--jp-inverse-layout-color4);
        }

        .jp-icon-alt .jp-icon-accent0[stroke] {
            stroke: var(--jp-inverse-layout-color0);
        }

        .jp-icon-alt .jp-icon-accent1[stroke] {
            stroke: var(--jp-inverse-layout-color1);
        }

        .jp-icon-alt .jp-icon-accent2[stroke] {
            stroke: var(--jp-inverse-layout-color2);
        }

        .jp-icon-alt .jp-icon-accent3[stroke] {
            stroke: var(--jp-inverse-layout-color3);
        }

        .jp-icon-alt .jp-icon-accent4[stroke] {
            stroke: var(--jp-inverse-layout-color4);
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-icon-hoverShow:not(:hover) .jp-icon-hoverShow-content {
            display: none !important;
        }

        /**
 * Support for hover colors for icons as inline SVG HTMLElements
 */

        /**
 * regular colors
 */

        /* recolor the primary elements of an icon */
        .jp-icon-hover :hover .jp-icon0-hover[fill] {
            fill: var(--jp-inverse-layout-color0);
        }

        .jp-icon-hover :hover .jp-icon1-hover[fill] {
            fill: var(--jp-inverse-layout-color1);
        }

        .jp-icon-hover :hover .jp-icon2-hover[fill] {
            fill: var(--jp-inverse-layout-color2);
        }

        .jp-icon-hover :hover .jp-icon3-hover[fill] {
            fill: var(--jp-inverse-layout-color3);
        }

        .jp-icon-hover :hover .jp-icon4-hover[fill] {
            fill: var(--jp-inverse-layout-color4);
        }

        .jp-icon-hover :hover .jp-icon0-hover[stroke] {
            stroke: var(--jp-inverse-layout-color0);
        }

        .jp-icon-hover :hover .jp-icon1-hover[stroke] {
            stroke: var(--jp-inverse-layout-color1);
        }

        .jp-icon-hover :hover .jp-icon2-hover[stroke] {
            stroke: var(--jp-inverse-layout-color2);
        }

        .jp-icon-hover :hover .jp-icon3-hover[stroke] {
            stroke: var(--jp-inverse-layout-color3);
        }

        .jp-icon-hover :hover .jp-icon4-hover[stroke] {
            stroke: var(--jp-inverse-layout-color4);
        }

        /* recolor the accent elements of an icon */
        .jp-icon-hover :hover .jp-icon-accent0-hover[fill] {
            fill: var(--jp-layout-color0);
        }

        .jp-icon-hover :hover .jp-icon-accent1-hover[fill] {
            fill: var(--jp-layout-color1);
        }

        .jp-icon-hover :hover .jp-icon-accent2-hover[fill] {
            fill: var(--jp-layout-color2);
        }

        .jp-icon-hover :hover .jp-icon-accent3-hover[fill] {
            fill: var(--jp-layout-color3);
        }

        .jp-icon-hover :hover .jp-icon-accent4-hover[fill] {
            fill: var(--jp-layout-color4);
        }

        .jp-icon-hover :hover .jp-icon-accent0-hover[stroke] {
            stroke: var(--jp-layout-color0);
        }

        .jp-icon-hover :hover .jp-icon-accent1-hover[stroke] {
            stroke: var(--jp-layout-color1);
        }

        .jp-icon-hover :hover .jp-icon-accent2-hover[stroke] {
            stroke: var(--jp-layout-color2);
        }

        .jp-icon-hover :hover .jp-icon-accent3-hover[stroke] {
            stroke: var(--jp-layout-color3);
        }

        .jp-icon-hover :hover .jp-icon-accent4-hover[stroke] {
            stroke: var(--jp-layout-color4);
        }

        /* set the color of an icon to transparent */
        .jp-icon-hover :hover .jp-icon-none-hover[fill] {
            fill: none;
        }

        .jp-icon-hover :hover .jp-icon-none-hover[stroke] {
            stroke: none;
        }

        /**
 * inverse colors
 */

        /* inverse recolor the primary elements of an icon */
        .jp-icon-hover.jp-icon-alt :hover .jp-icon0-hover[fill] {
            fill: var(--jp-layout-color0);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon1-hover[fill] {
            fill: var(--jp-layout-color1);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon2-hover[fill] {
            fill: var(--jp-layout-color2);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon3-hover[fill] {
            fill: var(--jp-layout-color3);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon4-hover[fill] {
            fill: var(--jp-layout-color4);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon0-hover[stroke] {
            stroke: var(--jp-layout-color0);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon1-hover[stroke] {
            stroke: var(--jp-layout-color1);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon2-hover[stroke] {
            stroke: var(--jp-layout-color2);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon3-hover[stroke] {
            stroke: var(--jp-layout-color3);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon4-hover[stroke] {
            stroke: var(--jp-layout-color4);
        }

        /* inverse recolor the accent elements of an icon */
        .jp-icon-hover.jp-icon-alt :hover .jp-icon-accent0-hover[fill] {
            fill: var(--jp-inverse-layout-color0);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon-accent1-hover[fill] {
            fill: var(--jp-inverse-layout-color1);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon-accent2-hover[fill] {
            fill: var(--jp-inverse-layout-color2);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon-accent3-hover[fill] {
            fill: var(--jp-inverse-layout-color3);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon-accent4-hover[fill] {
            fill: var(--jp-inverse-layout-color4);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon-accent0-hover[stroke] {
            stroke: var(--jp-inverse-layout-color0);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon-accent1-hover[stroke] {
            stroke: var(--jp-inverse-layout-color1);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon-accent2-hover[stroke] {
            stroke: var(--jp-inverse-layout-color2);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon-accent3-hover[stroke] {
            stroke: var(--jp-inverse-layout-color3);
        }

        .jp-icon-hover.jp-icon-alt :hover .jp-icon-accent4-hover[stroke] {
            stroke: var(--jp-inverse-layout-color4);
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-IFrame {
            width: 100%;
            height: 100%;
        }

        .jp-IFrame>iframe {
            border: none;
        }

        /*
When drag events occur, `lm-mod-override-cursor` is added to the body.
Because iframes steal all cursor events, the following two rules are necessary
to suppress pointer events while resize drags are occurring. There may be a
better solution to this problem.
*/
        body.lm-mod-override-cursor .jp-IFrame {
            position: relative;
        }

        body.lm-mod-override-cursor .jp-IFrame::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: transparent;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-HoverBox {
            position: fixed;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-FormGroup-content fieldset {
            border: none;
            padding: 0;
            min-width: 0;
            width: 100%;
        }

        /* stylelint-disable selector-max-type */

        .jp-FormGroup-content fieldset .jp-inputFieldWrapper input,
        .jp-FormGroup-content fieldset .jp-inputFieldWrapper select,
        .jp-FormGroup-content fieldset .jp-inputFieldWrapper textarea {
            font-size: var(--jp-content-font-size2);
            border-color: var(--jp-input-border-color);
            border-style: solid;
            border-radius: var(--jp-border-radius);
            border-width: 1px;
            padding: 6px 8px;
            background: none;
            color: var(--jp-ui-font-color0);
            height: inherit;
        }

        .jp-FormGroup-content fieldset input[type='checkbox'] {
            position: relative;
            top: 2px;
            margin-left: 0;
        }

        .jp-FormGroup-content button.jp-mod-styled {
            cursor: pointer;
        }

        .jp-FormGroup-content .checkbox label {
            cursor: pointer;
            font-size: var(--jp-content-font-size1);
        }

        .jp-FormGroup-content .jp-root>fieldset>legend {
            display: none;
        }

        .jp-FormGroup-content .jp-root>fieldset>p {
            display: none;
        }

        /** copy of `input.jp-mod-styled:focus` style */
        .jp-FormGroup-content fieldset input:focus,
        .jp-FormGroup-content fieldset select:focus {
            -moz-outline-radius: unset;
            outline: var(--jp-border-width) solid var(--md-blue-500);
            outline-offset: -1px;
            box-shadow: inset 0 0 4px var(--md-blue-300);
        }

        .jp-FormGroup-content fieldset input:hover:not(:focus),
        .jp-FormGroup-content fieldset select:hover:not(:focus) {
            background-color: var(--jp-border-color2);
        }

        /* stylelint-enable selector-max-type */

        .jp-FormGroup-content .checkbox .field-description {
            /* Disable default description field for checkbox:
   because other widgets do not have description fields,
   we add descriptions to each widget on the field level.
  */
            display: none;
        }

        .jp-FormGroup-content #root__description {
            display: none;
        }

        .jp-FormGroup-content .jp-modifiedIndicator {
            width: 5px;
            background-color: var(--jp-brand-color2);
            margin-top: 0;
            margin-left: calc(var(--jp-private-settingeditor-modifier-indent) * -1);
            flex-shrink: 0;
        }

        .jp-FormGroup-content .jp-modifiedIndicator.jp-errorIndicator {
            background-color: var(--jp-error-color0);
            margin-right: 0.5em;
        }

        /* RJSF ARRAY style */

        .jp-arrayFieldWrapper legend {
            font-size: var(--jp-content-font-size2);
            color: var(--jp-ui-font-color0);
            flex-basis: 100%;
            padding: 4px 0;
            font-weight: var(--jp-content-heading-font-weight);
            border-bottom: 1px solid var(--jp-border-color2);
        }

        .jp-arrayFieldWrapper .field-description {
            padding: 4px 0;
            white-space: pre-wrap;
        }

        .jp-arrayFieldWrapper .array-item {
            width: 100%;
            border: 1px solid var(--jp-border-color2);
            border-radius: 4px;
            margin: 4px;
        }

        .jp-ArrayOperations {
            display: flex;
            margin-left: 8px;
        }

        .jp-ArrayOperationsButton {
            margin: 2px;
        }

        .jp-ArrayOperationsButton .jp-icon3[fill] {
            fill: var(--jp-ui-font-color0);
        }

        button.jp-ArrayOperationsButton.jp-mod-styled:disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }

        /* RJSF form validation error */

        .jp-FormGroup-content .validationErrors {
            color: var(--jp-error-color0);
        }

        /* Hide panel level error as duplicated the field level error */
        .jp-FormGroup-content .panel.errors {
            display: none;
        }

        /* RJSF normal content (settings-editor) */

        .jp-FormGroup-contentNormal {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }

        .jp-FormGroup-contentNormal .jp-FormGroup-contentItem {
            margin-left: 7px;
            color: var(--jp-ui-font-color0);
        }

        .jp-FormGroup-contentNormal .jp-FormGroup-description {
            flex-basis: 100%;
            padding: 4px 7px;
        }

        .jp-FormGroup-contentNormal .jp-FormGroup-default {
            flex-basis: 100%;
            padding: 4px 7px;
        }

        .jp-FormGroup-contentNormal .jp-FormGroup-fieldLabel {
            font-size: var(--jp-content-font-size1);
            font-weight: normal;
            min-width: 120px;
        }

        .jp-FormGroup-contentNormal fieldset:not(:first-child) {
            margin-left: 7px;
        }

        .jp-FormGroup-contentNormal .field-array-of-string .array-item {
            /* Display `jp-ArrayOperations` buttons side-by-side with content except
    for small screens where flex-wrap will place them one below the other.
  */
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }

        .jp-FormGroup-contentNormal .jp-objectFieldWrapper .form-group {
            padding: 2px 8px 2px var(--jp-private-settingeditor-modifier-indent);
            margin-top: 2px;
        }

        /* RJSF compact content (metadata-form) */

        .jp-FormGroup-content.jp-FormGroup-contentCompact {
            width: 100%;
        }

        .jp-FormGroup-contentCompact .form-group {
            display: flex;
            padding: 0.5em 0.2em 0.5em 0;
        }

        .jp-FormGroup-contentCompact .jp-FormGroup-compactTitle .jp-FormGroup-description {
            font-size: var(--jp-ui-font-size1);
            color: var(--jp-ui-font-color2);
        }

        .jp-FormGroup-contentCompact .jp-FormGroup-fieldLabel {
            padding-bottom: 0.3em;
        }

        .jp-FormGroup-contentCompact .jp-inputFieldWrapper .form-control {
            width: 100%;
            box-sizing: border-box;
        }

        .jp-FormGroup-contentCompact .jp-arrayFieldWrapper .jp-FormGroup-compactTitle {
            padding-bottom: 7px;
        }

        .jp-FormGroup-contentCompact .jp-objectFieldWrapper .jp-objectFieldWrapper .form-group {
            padding: 2px 8px 2px var(--jp-private-settingeditor-modifier-indent);
            margin-top: 2px;
        }

        .jp-FormGroup-contentCompact ul.error-detail {
            margin-block-start: 0.5em;
            margin-block-end: 0.5em;
            padding-inline-start: 1em;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        .jp-SidePanel {
            display: flex;
            flex-direction: column;
            min-width: var(--jp-sidebar-min-width);
            overflow-y: auto;
            color: var(--jp-ui-font-color1);
            background: var(--jp-layout-color1);
            font-size: var(--jp-ui-font-size1);
        }

        .jp-SidePanel-header {
            flex: 0 0 auto;
            display: flex;
            border-bottom: var(--jp-border-width) solid var(--jp-border-color2);
            font-size: var(--jp-ui-font-size0);
            font-weight: 600;
            letter-spacing: 1px;
            margin: 0;
            padding: 2px;
            text-transform: uppercase;
        }

        .jp-SidePanel-toolbar {
            flex: 0 0 auto;
        }

        .jp-SidePanel-content {
            flex: 1 1 auto;
        }

        .jp-SidePanel-toolbar,
        .jp-AccordionPanel-toolbar {
            height: var(--jp-private-toolbar-height);
        }

        .jp-SidePanel-toolbar.jp-Toolbar-micro {
            display: none;
        }

        .lm-AccordionPanel .jp-AccordionPanel-title {
            box-sizing: border-box;
            line-height: 25px;
            margin: 0;
            display: flex;
            align-items: center;
            background: var(--jp-layout-color1);
            color: var(--jp-ui-font-color1);
            border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
            box-shadow: var(--jp-toolbar-box-shadow);
            font-size: var(--jp-ui-font-size0);
        }

        .jp-AccordionPanel-title {
            cursor: pointer;
            user-select: none;
            -moz-user-select: none;
            -webkit-user-select: none;
            text-transform: uppercase;
        }

        .lm-AccordionPanel[data-orientation='horizontal']>.jp-AccordionPanel-title {
            /* Title is rotated for horizontal accordion panel using CSS */
            display: block;
            transform-origin: top left;
            transform: rotate(-90deg) translate(-100%);
        }

        .jp-AccordionPanel-title .lm-AccordionPanel-titleLabel {
            user-select: none;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
        }

        .jp-AccordionPanel-title .lm-AccordionPanel-titleCollapser {
            transform: rotate(-90deg);
            margin: auto 0;
            height: 16px;
        }

        .jp-AccordionPanel-title.lm-mod-expanded .lm-AccordionPanel-titleCollapser {
            transform: rotate(0deg);
        }

        .lm-AccordionPanel .jp-AccordionPanel-toolbar {
            background: none;
            box-shadow: none;
            border: none;
            margin-left: auto;
        }

        .lm-AccordionPanel .lm-SplitPanel-handle:hover {
            background: var(--jp-layout-color3);
        }

        .jp-text-truncated {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) 2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-Spinner {
            position: absolute;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: var(--jp-layout-color0);
            outline: none;
        }

        .jp-SpinnerContent {
            font-size: 10px;
            margin: 50px auto;
            text-indent: -9999em;
            width: 3em;
            height: 3em;
            border-radius: 50%;
            background: var(--jp-brand-color3);
            background: linear-gradient(to right,
                    #f37626 10%,
                    rgba(255, 255, 255, 0) 42%);
            position: relative;
            animation: load3 1s infinite linear, fadeIn 1s;
        }

        .jp-SpinnerContent::before {
            width: 50%;
            height: 50%;
            background: #f37626;
            border-radius: 100% 0 0;
            position: absolute;
            top: 0;
            left: 0;
            content: '';
        }

        .jp-SpinnerContent::after {
            background: var(--jp-layout-color0);
            width: 75%;
            height: 75%;
            border-radius: 50%;
            content: '';
            margin: auto;
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
        }

        @keyframes fadeIn {
            0% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }
        }

        @keyframes load3 {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        button.jp-mod-styled {
            font-size: var(--jp-ui-font-size1);
            color: var(--jp-ui-font-color0);
            border: none;
            box-sizing: border-box;
            text-align: center;
            line-height: 32px;
            height: 32px;
            padding: 0 12px;
            letter-spacing: 0.8px;
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }

        input.jp-mod-styled {
            background: var(--jp-input-background);
            height: 28px;
            box-sizing: border-box;
            border: var(--jp-border-width) solid var(--jp-border-color1);
            padding-left: 7px;
            padding-right: 7px;
            font-size: var(--jp-ui-font-size2);
            color: var(--jp-ui-font-color0);
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }

        input[type='checkbox'].jp-mod-styled {
            appearance: checkbox;
            -webkit-appearance: checkbox;
            -moz-appearance: checkbox;
            height: auto;
        }

        input.jp-mod-styled:focus {
            border: var(--jp-border-width) solid var(--md-blue-500);
            box-shadow: inset 0 0 4px var(--md-blue-300);
        }

        .jp-select-wrapper {
            display: flex;
            position: relative;
            flex-direction: column;
            padding: 1px;
            background-color: var(--jp-layout-color1);
            box-sizing: border-box;
            margin-bottom: 12px;
        }

        .jp-select-wrapper:not(.multiple) {
            height: 28px;
        }

        .jp-select-wrapper.jp-mod-focused select.jp-mod-styled {
            border: var(--jp-border-width) solid var(--jp-input-active-border-color);
            box-shadow: var(--jp-input-box-shadow);
            background-color: var(--jp-input-active-background);
        }

        select.jp-mod-styled:hover {
            cursor: pointer;
            color: var(--jp-ui-font-color0);
            background-color: var(--jp-input-hover-background);
            box-shadow: inset 0 0 1px rgba(0, 0, 0, 0.5);
        }

        select.jp-mod-styled {
            flex: 1 1 auto;
            width: 100%;
            font-size: var(--jp-ui-font-size2);
            background: var(--jp-input-background);
            color: var(--jp-ui-font-color0);
            padding: 0 25px 0 8px;
            border: var(--jp-border-width) solid var(--jp-input-border-color);
            border-radius: 0;
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }

        select.jp-mod-styled:not([multiple]) {
            height: 32px;
        }

        select.jp-mod-styled[multiple] {
            max-height: 200px;
            overflow-y: auto;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-switch {
            display: flex;
            align-items: center;
            padding-left: 4px;
            padding-right: 4px;
            font-size: var(--jp-ui-font-size1);
            background-color: transparent;
            color: var(--jp-ui-font-color1);
            border: none;
            height: 20px;
        }

        .jp-switch:hover {
            background-color: var(--jp-layout-color2);
        }

        .jp-switch-label {
            margin-right: 5px;
            font-family: var(--jp-ui-font-family);
        }

        .jp-switch-track {
            cursor: pointer;
            background-color: var(--jp-switch-color, var(--jp-border-color1));
            -webkit-transition: 0.4s;
            transition: 0.4s;
            border-radius: 34px;
            height: 16px;
            width: 35px;
            position: relative;
        }

        .jp-switch-track::before {
            content: '';
            position: absolute;
            height: 10px;
            width: 10px;
            margin: 3px;
            left: 0;
            background-color: var(--jp-ui-inverse-font-color1);
            -webkit-transition: 0.4s;
            transition: 0.4s;
            border-radius: 50%;
        }

        .jp-switch[aria-checked='true'] .jp-switch-track {
            background-color: var(--jp-switch-true-position-color, var(--jp-warn-color0));
        }

        .jp-switch[aria-checked='true'] .jp-switch-track::before {
            /* track width (35) - margins (3 + 3) - thumb width (10) */
            left: 19px;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-Toolbar {
            color: var(--jp-ui-font-color1);
            flex: 0 0 auto;
            display: flex;
            flex-direction: row;
            border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
            box-shadow: var(--jp-toolbar-box-shadow);
            background: var(--jp-toolbar-background);
            min-height: var(--jp-toolbar-micro-height);
            padding: 2px;
            z-index: 8;
            overflow-x: hidden;
        }

        /* Toolbar items */

        .jp-Toolbar>.jp-Toolbar-item.jp-Toolbar-spacer {
            flex-grow: 1;
            flex-shrink: 1;
        }

        .jp-Toolbar-item.jp-Toolbar-kernelStatus {
            display: inline-block;
            width: 32px;
            background-repeat: no-repeat;
            background-position: center;
            background-size: 16px;
        }

        .jp-Toolbar>.jp-Toolbar-item {
            flex: 0 0 auto;
            display: flex;
            padding-left: 1px;
            padding-right: 1px;
            font-size: var(--jp-ui-font-size1);
            line-height: var(--jp-private-toolbar-height);
            height: 100%;
        }

        /* Toolbar buttons */

        /* This is the div we use to wrap the react component into a Widget */
        div.jp-ToolbarButton {
            color: transparent;
            border: none;
            box-sizing: border-box;
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            padding: 0;
            margin: 0;
        }

        button.jp-ToolbarButtonComponent {
            background: var(--jp-layout-color1);
            border: none;
            box-sizing: border-box;
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            padding: 0 6px;
            margin: 0;
            height: 24px;
            border-radius: var(--jp-border-radius);
            display: flex;
            align-items: center;
            text-align: center;
            font-size: 14px;
            min-width: unset;
            min-height: unset;
        }

        button.jp-ToolbarButtonComponent:disabled {
            opacity: 0.4;
        }

        button.jp-ToolbarButtonComponent>span {
            padding: 0;
            flex: 0 0 auto;
        }

        button.jp-ToolbarButtonComponent .jp-ToolbarButtonComponent-label {
            font-size: var(--jp-ui-font-size1);
            line-height: 100%;
            padding-left: 2px;
            color: var(--jp-ui-font-color1);
            font-family: var(--jp-ui-font-family);
        }

        #jp-main-dock-panel[data-mode='single-document'] .jp-MainAreaWidget>.jp-Toolbar.jp-Toolbar-micro {
            padding: 0;
            min-height: 0;
        }

        #jp-main-dock-panel[data-mode='single-document'] .jp-MainAreaWidget>.jp-Toolbar {
            border: none;
            box-shadow: none;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        .jp-WindowedPanel-outer {
            position: relative;
            overflow-y: auto;
        }

        .jp-WindowedPanel-inner {
            position: relative;
        }

        .jp-WindowedPanel-window {
            position: absolute;
            left: 0;
            right: 0;
            overflow: visible;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /* Sibling imports */

        body {
            color: var(--jp-ui-font-color1);
            font-size: var(--jp-ui-font-size1);
        }

        /* Disable native link decoration styles everywhere outside of dialog boxes */
        a {
            text-decoration: unset;
            color: unset;
        }

        a:hover {
            text-decoration: unset;
            color: unset;
        }

        /* Accessibility for links inside dialog box text */
        .jp-Dialog-content a {
            text-decoration: revert;
            color: var(--jp-content-link-color);
        }

        .jp-Dialog-content a:hover {
            text-decoration: revert;
        }

        /* Styles for ui-components */
        .jp-Button {
            color: var(--jp-ui-font-color2);
            border-radius: var(--jp-border-radius);
            padding: 0 12px;
            font-size: var(--jp-ui-font-size1);

            /* Copy from blueprint 3 */
            display: inline-flex;
            flex-direction: row;
            border: none;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            text-align: left;
            vertical-align: middle;
            min-height: 30px;
            min-width: 30px;
        }

        .jp-Button:disabled {
            cursor: not-allowed;
        }

        .jp-Button:empty {
            padding: 0 !important;
        }

        .jp-Button.jp-mod-small {
            min-height: 24px;
            min-width: 24px;
            font-size: 12px;
            padding: 0 7px;
        }

        /* Use our own theme for hover styles */
        .jp-Button.jp-mod-minimal:hover {
            background-color: var(--jp-layout-color2);
        }

        .jp-Button.jp-mod-minimal {
            background: none;
        }

        .jp-InputGroup {
            display: block;
            position: relative;
        }

        .jp-InputGroup input {
            box-sizing: border-box;
            border: none;
            border-radius: 0;
            background-color: transparent;
            color: var(--jp-ui-font-color0);
            box-shadow: inset 0 0 0 var(--jp-border-width) var(--jp-input-border-color);
            padding-bottom: 0;
            padding-top: 0;
            padding-left: 10px;
            padding-right: 28px;
            position: relative;
            width: 100%;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            font-size: 14px;
            font-weight: 400;
            height: 30px;
            line-height: 30px;
            outline: none;
            vertical-align: middle;
        }

        .jp-InputGroup input:focus {
            box-shadow: inset 0 0 0 var(--jp-border-width) var(--jp-input-active-box-shadow-color),
                inset 0 0 0 3px var(--jp-input-active-box-shadow-color);
        }

        .jp-InputGroup input:disabled {
            cursor: not-allowed;
            resize: block;
            background-color: var(--jp-layout-color2);
            color: var(--jp-ui-font-color2);
        }

        .jp-InputGroup input:disabled~span {
            cursor: not-allowed;
            color: var(--jp-ui-font-color2);
        }

        .jp-InputGroup input::placeholder,
        input::placeholder {
            color: var(--jp-ui-font-color2);
        }

        .jp-InputGroupAction {
            position: absolute;
            bottom: 1px;
            right: 0;
            padding: 6px;
        }

        .jp-HTMLSelect.jp-DefaultStyle select {
            background-color: initial;
            border: none;
            border-radius: 0;
            box-shadow: none;
            color: var(--jp-ui-font-color0);
            display: block;
            font-size: var(--jp-ui-font-size1);
            font-family: var(--jp-ui-font-family);
            height: 24px;
            line-height: 14px;
            padding: 0 25px 0 10px;
            text-align: left;
            -moz-appearance: none;
            -webkit-appearance: none;
        }

        .jp-HTMLSelect.jp-DefaultStyle select:disabled {
            background-color: var(--jp-layout-color2);
            color: var(--jp-ui-font-color2);
            cursor: not-allowed;
            resize: block;
        }

        .jp-HTMLSelect.jp-DefaultStyle select:disabled~span {
            cursor: not-allowed;
        }

        /* Use our own theme for hover and option styles */
        /* stylelint-disable-next-line selector-max-type */
        .jp-HTMLSelect.jp-DefaultStyle select:hover,
        .jp-HTMLSelect.jp-DefaultStyle select>option {
            background-color: var(--jp-layout-color2);
            color: var(--jp-ui-font-color0);
        }

        select {
            box-sizing: border-box;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

        .jp-StatusBar-Widget {
            display: flex;
            align-items: center;
            background: var(--jp-layout-color2);
            min-height: var(--jp-statusbar-height);
            justify-content: space-between;
            padding: 0 10px;
        }

        .jp-StatusBar-Left {
            display: flex;
            align-items: center;
            flex-direction: row;
        }

        .jp-StatusBar-Middle {
            display: flex;
            align-items: center;
        }

        .jp-StatusBar-Right {
            display: flex;
            align-items: center;
            flex-direction: row-reverse;
        }

        .jp-StatusBar-Item {
            max-height: var(--jp-statusbar-height);
            margin: 0 2px;
            height: var(--jp-statusbar-height);
            white-space: nowrap;
            text-overflow: ellipsis;
            color: var(--jp-ui-font-color1);
            padding: 0 6px;
        }

        .jp-mod-highlighted:hover {
            background-color: var(--jp-layout-color3);
        }

        .jp-mod-clicked {
            background-color: var(--jp-brand-color1);
        }

        .jp-mod-clicked:hover {
            background-color: var(--jp-brand-color0);
        }

        .jp-mod-clicked .jp-StatusBar-TextItem {
            color: var(--jp-ui-inverse-font-color1);
        }

        .jp-StatusBar-HoverItem {
            box-shadow: '0px 4px 4px rgba(0, 0, 0, 0.25)';
        }

        .jp-StatusBar-TextItem {
            font-size: var(--jp-ui-font-size1);
            font-family: var(--jp-ui-font-family);
            line-height: 24px;
            color: var(--jp-ui-font-color1);
        }

        .jp-StatusBar-GroupItem {
            display: flex;
            align-items: center;
            flex-direction: row;
        }

        .jp-Statusbar-ProgressCircle svg {
            display: block;
            margin: 0 auto;
            width: 16px;
            height: 24px;
            align-self: normal;
        }

        .jp-Statusbar-ProgressCircle path {
            fill: var(--jp-inverse-layout-color3);
        }

        .jp-Statusbar-ProgressBar-progress-bar {
            height: 10px;
            width: 100px;
            border: solid 0.25px var(--jp-brand-color2);
            border-radius: 3px;
            overflow: hidden;
            align-self: center;
        }

        .jp-Statusbar-ProgressBar-progress-bar>div {
            background-color: var(--jp-brand-color2);
            background-image: linear-gradient(-45deg,
                    rgba(255, 255, 255, 0.2) 25%,
                    transparent 25%,
                    transparent 50%,
                    rgba(255, 255, 255, 0.2) 50%,
                    rgba(255, 255, 255, 0.2) 75%,
                    transparent 75%,
                    transparent);
            background-size: 40px 40px;
            float: left;
            width: 0%;
            height: 100%;
            font-size: 12px;
            line-height: 14px;
            color: #fff;
            text-align: center;
            animation: jp-Statusbar-ExecutionTime-progress-bar 2s linear infinite;
        }

        .jp-Statusbar-ProgressBar-progress-bar p {
            color: var(--jp-ui-font-color1);
            font-family: var(--jp-ui-font-family);
            font-size: var(--jp-ui-font-size1);
            line-height: 10px;
            width: 100px;
        }

        @keyframes jp-Statusbar-ExecutionTime-progress-bar {
            0% {
                background-position: 0 0;
            }

            100% {
                background-position: 40px 40px;
            }
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Overall styles
|----------------------------------------------------------------------------*/

        .lm-CommandPalette {
            padding-bottom: 0;
            color: var(--jp-ui-font-color1);
            background: var(--jp-layout-color1);

            /* This is needed so that all font sizing of children done in ems is
   * relative to this base size */
            font-size: var(--jp-ui-font-size1);
        }

        /*-----------------------------------------------------------------------------
| Modal variant
|----------------------------------------------------------------------------*/

        .jp-ModalCommandPalette {
            position: absolute;
            z-index: 10000;
            top: 38px;
            left: 30%;
            margin: 0;
            padding: 4px;
            width: 40%;
            box-shadow: var(--jp-elevation-z4);
            border-radius: 4px;
            background: var(--jp-layout-color0);
        }

        .jp-ModalCommandPalette .lm-CommandPalette {
            max-height: 40vh;
        }

        .jp-ModalCommandPalette .lm-CommandPalette .lm-close-icon::after {
            display: none;
        }

        .jp-ModalCommandPalette .lm-CommandPalette .lm-CommandPalette-header {
            display: none;
        }

        .jp-ModalCommandPalette .lm-CommandPalette .lm-CommandPalette-item {
            margin-left: 4px;
            margin-right: 4px;
        }

        .jp-ModalCommandPalette .lm-CommandPalette .lm-CommandPalette-item.lm-mod-disabled {
            display: none;
        }

        /*-----------------------------------------------------------------------------
| Search
|----------------------------------------------------------------------------*/

        .lm-CommandPalette-search {
            padding: 4px;
            background-color: var(--jp-layout-color1);
            z-index: 2;
        }

        .lm-CommandPalette-wrapper {
            overflow: overlay;
            padding: 0 9px;
            background-color: var(--jp-input-active-background);
            height: 30px;
            box-shadow: inset 0 0 0 var(--jp-border-width) var(--jp-input-border-color);
        }

        .lm-CommandPalette.lm-mod-focused .lm-CommandPalette-wrapper {
            box-shadow: inset 0 0 0 1px var(--jp-input-active-box-shadow-color),
                inset 0 0 0 3px var(--jp-input-active-box-shadow-color);
        }

        .jp-SearchIconGroup {
            color: white;
            background-color: var(--jp-brand-color1);
            position: absolute;
            top: 4px;
            right: 4px;
            padding: 5px 5px 1px;
        }

        .jp-SearchIconGroup svg {
            height: 20px;
            width: 20px;
        }

        .jp-SearchIconGroup .jp-icon3[fill] {
            fill: var(--jp-layout-color0);
        }

        .lm-CommandPalette-input {
            background: transparent;
            width: calc(100% - 18px);
            float: left;
            border: none;
            outline: none;
            font-size: var(--jp-ui-font-size1);
            color: var(--jp-ui-font-color0);
            line-height: var(--jp-private-commandpalette-search-height);
        }

        .lm-CommandPalette-input::-webkit-input-placeholder,
        .lm-CommandPalette-input::-moz-placeholder,
        .lm-CommandPalette-input:-ms-input-placeholder {
            color: var(--jp-ui-font-color2);
            font-size: var(--jp-ui-font-size1);
        }

        /*-----------------------------------------------------------------------------
| Results
|----------------------------------------------------------------------------*/

        .lm-CommandPalette-header:first-child {
            margin-top: 0;
        }

        .lm-CommandPalette-header {
            border-bottom: solid var(--jp-border-width) var(--jp-border-color2);
            color: var(--jp-ui-font-color1);
            cursor: pointer;
            display: flex;
            font-size: var(--jp-ui-font-size0);
            font-weight: 600;
            letter-spacing: 1px;
            margin-top: 8px;
            padding: 8px 0 8px 12px;
            text-transform: uppercase;
        }

        .lm-CommandPalette-header.lm-mod-active {
            background: var(--jp-layout-color2);
        }

        .lm-CommandPalette-header>mark {
            background-color: transparent;
            font-weight: bold;
            color: var(--jp-ui-font-color1);
        }

        .lm-CommandPalette-item {
            padding: 4px 12px 4px 4px;
            color: var(--jp-ui-font-color1);
            font-size: var(--jp-ui-font-size1);
            font-weight: 400;
            display: flex;
        }

        .lm-CommandPalette-item.lm-mod-disabled {
            color: var(--jp-ui-font-color2);
        }

        .lm-CommandPalette-item.lm-mod-active {
            color: var(--jp-ui-inverse-font-color1);
            background: var(--jp-brand-color1);
        }

        .lm-CommandPalette-item.lm-mod-active .lm-CommandPalette-itemLabel>mark {
            color: var(--jp-ui-inverse-font-color0);
        }

        .lm-CommandPalette-item.lm-mod-active .jp-icon-selectable[fill] {
            fill: var(--jp-layout-color0);
        }

        .lm-CommandPalette-item.lm-mod-active:hover:not(.lm-mod-disabled) {
            color: var(--jp-ui-inverse-font-color1);
            background: var(--jp-brand-color1);
        }

        .lm-CommandPalette-item:hover:not(.lm-mod-active):not(.lm-mod-disabled) {
            background: var(--jp-layout-color2);
        }

        .lm-CommandPalette-itemContent {
            overflow: hidden;
        }

        .lm-CommandPalette-itemLabel>mark {
            color: var(--jp-ui-font-color0);
            background-color: transparent;
            font-weight: bold;
        }

        .lm-CommandPalette-item.lm-mod-disabled mark {
            color: var(--jp-ui-font-color2);
        }

        .lm-CommandPalette-item .lm-CommandPalette-itemIcon {
            margin: 0 4px 0 0;
            position: relative;
            width: 16px;
            top: 2px;
            flex: 0 0 auto;
        }

        .lm-CommandPalette-item.lm-mod-disabled .lm-CommandPalette-itemIcon {
            opacity: 0.6;
        }

        .lm-CommandPalette-item .lm-CommandPalette-itemShortcut {
            flex: 0 0 auto;
        }

        .lm-CommandPalette-itemCaption {
            display: none;
        }

        .lm-CommandPalette-content {
            background-color: var(--jp-layout-color1);
        }

        .lm-CommandPalette-content:empty::after {
            content: 'No results';
            margin: auto;
            margin-top: 20px;
            width: 100px;
            display: block;
            font-size: var(--jp-ui-font-size2);
            font-family: var(--jp-ui-font-family);
            font-weight: lighter;
        }

        .lm-CommandPalette-emptyMessage {
            text-align: center;
            margin-top: 24px;
            line-height: 1.32;
            padding: 0 8px;
            color: var(--jp-content-font-color3);
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-Dialog {
            position: absolute;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            top: 0;
            left: 0;
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background: var(--jp-dialog-background);
        }

        .jp-Dialog-content {
            display: flex;
            flex-direction: column;
            margin-left: auto;
            margin-right: auto;
            background: var(--jp-layout-color1);
            padding: 24px 24px 12px;
            min-width: 300px;
            min-height: 150px;
            max-width: 1000px;
            max-height: 500px;
            box-sizing: border-box;
            box-shadow: var(--jp-elevation-z20);
            word-wrap: break-word;
            border-radius: var(--jp-border-radius);

            /* This is needed so that all font sizing of children done in ems is
   * relative to this base size */
            font-size: var(--jp-ui-font-size1);
            color: var(--jp-ui-font-color1);
            resize: both;
        }

        .jp-Dialog-content.jp-Dialog-content-small {
            max-width: 500px;
        }

        .jp-Dialog-button {
            overflow: visible;
        }

        button.jp-Dialog-button:focus {
            outline: 1px solid var(--jp-brand-color1);
            outline-offset: 4px;
            -moz-outline-radius: 0;
        }

        button.jp-Dialog-button:focus::-moz-focus-inner {
            border: 0;
        }

        button.jp-Dialog-button.jp-mod-styled.jp-mod-accept:focus,
        button.jp-Dialog-button.jp-mod-styled.jp-mod-warn:focus,
        button.jp-Dialog-button.jp-mod-styled.jp-mod-reject:focus {
            outline-offset: 4px;
            -moz-outline-radius: 0;
        }

        button.jp-Dialog-button.jp-mod-styled.jp-mod-accept:focus {
            outline: 1px solid var(--jp-accept-color-normal, var(--jp-brand-color1));
        }

        button.jp-Dialog-button.jp-mod-styled.jp-mod-warn:focus {
            outline: 1px solid var(--jp-warn-color-normal, var(--jp-error-color1));
        }

        button.jp-Dialog-button.jp-mod-styled.jp-mod-reject:focus {
            outline: 1px solid var(--jp-reject-color-normal, var(--md-grey-600));
        }

        button.jp-Dialog-close-button {
            padding: 0;
            height: 100%;
            min-width: unset;
            min-height: unset;
        }

        .jp-Dialog-header {
            display: flex;
            justify-content: space-between;
            flex: 0 0 auto;
            padding-bottom: 12px;
            font-size: var(--jp-ui-font-size3);
            font-weight: 400;
            color: var(--jp-ui-font-color1);
        }

        .jp-Dialog-body {
            display: flex;
            flex-direction: column;
            flex: 1 1 auto;
            font-size: var(--jp-ui-font-size1);
            background: var(--jp-layout-color1);
            color: var(--jp-ui-font-color1);
            overflow: auto;
        }

        .jp-Dialog-footer {
            display: flex;
            flex-direction: row;
            justify-content: flex-end;
            align-items: center;
            flex: 0 0 auto;
            margin-left: -12px;
            margin-right: -12px;
            padding: 12px;
        }

        .jp-Dialog-checkbox {
            padding-right: 5px;
        }

        .jp-Dialog-checkbox>input:focus-visible {
            outline: 1px solid var(--jp-input-active-border-color);
            outline-offset: 1px;
        }

        .jp-Dialog-spacer {
            flex: 1 1 auto;
        }

        .jp-Dialog-title {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        .jp-Dialog-body>.jp-select-wrapper {
            width: 100%;
        }

        .jp-Dialog-body>button {
            padding: 0 16px;
        }

        .jp-Dialog-body>label {
            line-height: 1.4;
            color: var(--jp-ui-font-color0);
        }

        .jp-Dialog-button.jp-mod-styled:not(:last-child) {
            margin-right: 12px;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        .jp-Input-Boolean-Dialog {
            flex-direction: row-reverse;
            align-items: end;
            width: 100%;
        }

        .jp-Input-Boolean-Dialog>label {
            flex: 1 1 auto;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-MainAreaWidget> :focus {
            outline: none;
        }

        .jp-MainAreaWidget .jp-MainAreaWidget-error {
            padding: 6px;
        }

        .jp-MainAreaWidget .jp-MainAreaWidget-error>pre {
            width: auto;
            padding: 10px;
            background: var(--jp-error-color3);
            border: var(--jp-border-width) solid var(--jp-error-color1);
            border-radius: var(--jp-border-radius);
            color: var(--jp-ui-font-color1);
            font-size: var(--jp-ui-font-size1);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /**
 * google-material-color v1.2.6
 * https://github.com/danlevan/google-material-color
 */
        /*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| RenderedText
|----------------------------------------------------------------------------*/

        .jp-RenderedText {
            text-align: left;
            padding-left: var(--jp-code-padding);
            line-height: var(--jp-code-line-height);
            font-family: var(--jp-code-font-family);
        }

        .jp-RenderedText pre,
        .jp-RenderedJavaScript pre,
        .jp-RenderedHTMLCommon pre {
            color: var(--jp-content-font-color1);
            font-size: var(--jp-code-font-size);
            border: none;
            margin: 0;
            padding: 0;
        }

        .jp-RenderedText pre a:link {
            text-decoration: none;
            color: var(--jp-content-link-color);
        }

        .jp-RenderedText pre a:hover {
            text-decoration: underline;
            color: var(--jp-content-link-color);
        }

        .jp-RenderedText pre a:visited {
            text-decoration: none;
            color: var(--jp-content-link-color);
        }

        /* console foregrounds and backgrounds */
        .jp-RenderedText pre .ansi-black-fg {
            color: #3e424d;
        }

        .jp-RenderedText pre .ansi-red-fg {
            color: #e75c58;
        }

        .jp-RenderedText pre .ansi-green-fg {
            color: #00a250;
        }

        .jp-RenderedText pre .ansi-yellow-fg {
            color: #ddb62b;
        }

        .jp-RenderedText pre .ansi-blue-fg {
            color: #208ffb;
        }

        .jp-RenderedText pre .ansi-magenta-fg {
            color: #d160c4;
        }

        .jp-RenderedText pre .ansi-cyan-fg {
            color: #60c6c8;
        }

        .jp-RenderedText pre .ansi-white-fg {
            color: #c5c1b4;
        }

        .jp-RenderedText pre .ansi-black-bg {
            background-color: #3e424d;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-red-bg {
            background-color: #e75c58;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-green-bg {
            background-color: #00a250;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-yellow-bg {
            background-color: #ddb62b;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-blue-bg {
            background-color: #208ffb;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-magenta-bg {
            background-color: #d160c4;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-cyan-bg {
            background-color: #60c6c8;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-white-bg {
            background-color: #c5c1b4;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-black-intense-fg {
            color: #282c36;
        }

        .jp-RenderedText pre .ansi-red-intense-fg {
            color: #b22b31;
        }

        .jp-RenderedText pre .ansi-green-intense-fg {
            color: #007427;
        }

        .jp-RenderedText pre .ansi-yellow-intense-fg {
            color: #b27d12;
        }

        .jp-RenderedText pre .ansi-blue-intense-fg {
            color: #0065ca;
        }

        .jp-RenderedText pre .ansi-magenta-intense-fg {
            color: #a03196;
        }

        .jp-RenderedText pre .ansi-cyan-intense-fg {
            color: #258f8f;
        }

        .jp-RenderedText pre .ansi-white-intense-fg {
            color: #a1a6b2;
        }

        .jp-RenderedText pre .ansi-black-intense-bg {
            background-color: #282c36;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-red-intense-bg {
            background-color: #b22b31;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-green-intense-bg {
            background-color: #007427;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-yellow-intense-bg {
            background-color: #b27d12;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-blue-intense-bg {
            background-color: #0065ca;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-magenta-intense-bg {
            background-color: #a03196;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-cyan-intense-bg {
            background-color: #258f8f;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-white-intense-bg {
            background-color: #a1a6b2;
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-default-inverse-fg {
            color: var(--jp-ui-inverse-font-color0);
        }

        .jp-RenderedText pre .ansi-default-inverse-bg {
            background-color: var(--jp-inverse-layout-color0);
            padding: var(--jp-private-code-span-padding) 0;
        }

        .jp-RenderedText pre .ansi-bold {
            font-weight: bold;
        }

        .jp-RenderedText pre .ansi-underline {
            text-decoration: underline;
        }

        .jp-RenderedText[data-mime-type='application/vnd.jupyter.stderr'] {
            background: var(--jp-rendermime-error-background);
            padding-top: var(--jp-code-padding);
        }

        /*-----------------------------------------------------------------------------
| RenderedLatex
|----------------------------------------------------------------------------*/

        .jp-RenderedLatex {
            color: var(--jp-content-font-color1);
            font-size: var(--jp-content-font-size1);
            line-height: var(--jp-content-line-height);
        }

        /* Left-justify outputs.*/
        .jp-OutputArea-output.jp-RenderedLatex {
            padding: var(--jp-code-padding);
            text-align: left;
        }

        /*-----------------------------------------------------------------------------
| RenderedHTML
|----------------------------------------------------------------------------*/

        .jp-RenderedHTMLCommon {
            color: var(--jp-content-font-color1);
            font-family: var(--jp-content-font-family);
            font-size: var(--jp-content-font-size1);
            line-height: var(--jp-content-line-height);

            /* Give a bit more R padding on Markdown text to keep line lengths reasonable */
            padding-right: 20px;
        }

        .jp-RenderedHTMLCommon em {
            font-style: italic;
        }

        .jp-RenderedHTMLCommon strong {
            font-weight: bold;
        }

        .jp-RenderedHTMLCommon u {
            text-decoration: underline;
        }

        .jp-RenderedHTMLCommon a:link {
            text-decoration: none;
            color: var(--jp-content-link-color);
        }

        .jp-RenderedHTMLCommon a:hover {
            text-decoration: underline;
            color: var(--jp-content-link-color);
        }

        .jp-RenderedHTMLCommon a:visited {
            text-decoration: none;
            color: var(--jp-content-link-color);
        }

        /* Headings */

        .jp-RenderedHTMLCommon h1,
        .jp-RenderedHTMLCommon h2,
        .jp-RenderedHTMLCommon h3,
        .jp-RenderedHTMLCommon h4,
        .jp-RenderedHTMLCommon h5,
        .jp-RenderedHTMLCommon h6 {
            line-height: var(--jp-content-heading-line-height);
            font-weight: var(--jp-content-heading-font-weight);
            font-style: normal;
            margin: var(--jp-content-heading-margin-top) 0 var(--jp-content-heading-margin-bottom) 0;
        }

        .jp-RenderedHTMLCommon h1:first-child,
        .jp-RenderedHTMLCommon h2:first-child,
        .jp-RenderedHTMLCommon h3:first-child,
        .jp-RenderedHTMLCommon h4:first-child,
        .jp-RenderedHTMLCommon h5:first-child,
        .jp-RenderedHTMLCommon h6:first-child {
            margin-top: calc(0.5 * var(--jp-content-heading-margin-top));
        }

        .jp-RenderedHTMLCommon h1:last-child,
        .jp-RenderedHTMLCommon h2:last-child,
        .jp-RenderedHTMLCommon h3:last-child,
        .jp-RenderedHTMLCommon h4:last-child,
        .jp-RenderedHTMLCommon h5:last-child,
        .jp-RenderedHTMLCommon h6:last-child {
            margin-bottom: calc(0.5 * var(--jp-content-heading-margin-bottom));
        }

        .jp-RenderedHTMLCommon h1 {
            font-size: var(--jp-content-font-size5);
        }

        .jp-RenderedHTMLCommon h2 {
            font-size: var(--jp-content-font-size4);
        }

        .jp-RenderedHTMLCommon h3 {
            font-size: var(--jp-content-font-size3);
        }

        .jp-RenderedHTMLCommon h4 {
            font-size: var(--jp-content-font-size2);
        }

        .jp-RenderedHTMLCommon h5 {
            font-size: var(--jp-content-font-size1);
        }

        .jp-RenderedHTMLCommon h6 {
            font-size: var(--jp-content-font-size0);
        }

        /* Lists */

        /* stylelint-disable selector-max-type, selector-max-compound-selectors */

        .jp-RenderedHTMLCommon ul:not(.list-inline),
        .jp-RenderedHTMLCommon ol:not(.list-inline) {
            padding-left: 2em;
        }

        .jp-RenderedHTMLCommon ul {
            list-style: disc;
        }

        .jp-RenderedHTMLCommon ul ul {
            list-style: square;
        }

        .jp-RenderedHTMLCommon ul ul ul {
            list-style: circle;
        }

        .jp-RenderedHTMLCommon ol {
            list-style: decimal;
        }

        .jp-RenderedHTMLCommon ol ol {
            list-style: upper-alpha;
        }

        .jp-RenderedHTMLCommon ol ol ol {
            list-style: lower-alpha;
        }

        .jp-RenderedHTMLCommon ol ol ol ol {
            list-style: lower-roman;
        }

        .jp-RenderedHTMLCommon ol ol ol ol ol {
            list-style: decimal;
        }

        .jp-RenderedHTMLCommon ol,
        .jp-RenderedHTMLCommon ul {
            margin-bottom: 1em;
        }

        .jp-RenderedHTMLCommon ul ul,
        .jp-RenderedHTMLCommon ul ol,
        .jp-RenderedHTMLCommon ol ul,
        .jp-RenderedHTMLCommon ol ol {
            margin-bottom: 0;
        }

        /* stylelint-enable selector-max-type, selector-max-compound-selectors */

        .jp-RenderedHTMLCommon hr {
            color: var(--jp-border-color2);
            background-color: var(--jp-border-color1);
            margin-top: 1em;
            margin-bottom: 1em;
        }

        .jp-RenderedHTMLCommon>pre {
            margin: 1.5em 2em;
        }

        .jp-RenderedHTMLCommon pre,
        .jp-RenderedHTMLCommon code {
            border: 0;
            background-color: var(--jp-layout-color0);
            color: var(--jp-content-font-color1);
            font-family: var(--jp-code-font-family);
            font-size: inherit;
            line-height: var(--jp-code-line-height);
            padding: 0;
            white-space: pre-wrap;
        }

        .jp-RenderedHTMLCommon :not(pre)>code {
            background-color: var(--jp-layout-color2);
            padding: 1px 5px;
        }

        /* Tables */

        .jp-RenderedHTMLCommon table {
            border-collapse: collapse;
            border-spacing: 0;
            border: none;
            color: var(--jp-ui-font-color1);
            font-size: var(--jp-ui-font-size1);
            table-layout: fixed;
            margin-left: auto;
            margin-bottom: 1em;
            margin-right: auto;
        }

        .jp-RenderedHTMLCommon thead {
            border-bottom: var(--jp-border-width) solid var(--jp-border-color1);
            vertical-align: bottom;
        }

        .jp-RenderedHTMLCommon td,
        .jp-RenderedHTMLCommon th,
        .jp-RenderedHTMLCommon tr {
            vertical-align: middle;
            padding: 0.5em;
            line-height: normal;
            white-space: normal;
            max-width: none;
            border: none;
        }

        .jp-RenderedMarkdown.jp-RenderedHTMLCommon td,
        .jp-RenderedMarkdown.jp-RenderedHTMLCommon th {
            max-width: none;
        }

        :not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon td,
        :not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon th,
        :not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon tr {
            text-align: right;
        }

        .jp-RenderedHTMLCommon th {
            font-weight: bold;
        }

        .jp-RenderedHTMLCommon tbody tr:nth-child(odd) {
            background: var(--jp-layout-color0);
        }

        .jp-RenderedHTMLCommon tbody tr:nth-child(even) {
            background: var(--jp-rendermime-table-row-background);
        }

        .jp-RenderedHTMLCommon tbody tr:hover {
            background: var(--jp-rendermime-table-row-hover-background);
        }

        .jp-RenderedHTMLCommon p {
            text-align: left;
            margin: 0;
            margin-bottom: 1em;
        }

        .jp-RenderedHTMLCommon img {
            -moz-force-broken-image-icon: 1;
        }

        /* Restrict to direct children as other images could be nested in other content. */
        .jp-RenderedHTMLCommon>img {
            display: block;
            margin-left: 0;
            margin-right: 0;
            margin-bottom: 1em;
        }

        /* Change color behind transparent images if they need it... */
        [data-jp-theme-light='false'] .jp-RenderedImage img.jp-needs-light-background {
            background-color: var(--jp-inverse-layout-color1);
        }

        [data-jp-theme-light='true'] .jp-RenderedImage img.jp-needs-dark-background {
            background-color: var(--jp-inverse-layout-color1);
        }

        .jp-RenderedHTMLCommon img,
        .jp-RenderedImage img,
        .jp-RenderedHTMLCommon svg,
        .jp-RenderedSVG svg {
            max-width: 100%;
            height: auto;
        }

        .jp-RenderedHTMLCommon img.jp-mod-unconfined,
        .jp-RenderedImage img.jp-mod-unconfined,
        .jp-RenderedHTMLCommon svg.jp-mod-unconfined,
        .jp-RenderedSVG svg.jp-mod-unconfined {
            max-width: none;
        }

        .jp-RenderedHTMLCommon .alert {
            padding: var(--jp-notebook-padding);
            border: var(--jp-border-width) solid transparent;
            border-radius: var(--jp-border-radius);
            margin-bottom: 1em;
        }

        .jp-RenderedHTMLCommon .alert-info {
            color: var(--jp-info-color0);
            background-color: var(--jp-info-color3);
            border-color: var(--jp-info-color2);
        }

        .jp-RenderedHTMLCommon .alert-info hr {
            border-color: var(--jp-info-color3);
        }

        .jp-RenderedHTMLCommon .alert-info>p:last-child,
        .jp-RenderedHTMLCommon .alert-info>ul:last-child {
            margin-bottom: 0;
        }

        .jp-RenderedHTMLCommon .alert-warning {
            color: var(--jp-warn-color0);
            background-color: var(--jp-warn-color3);
            border-color: var(--jp-warn-color2);
        }

        .jp-RenderedHTMLCommon .alert-warning hr {
            border-color: var(--jp-warn-color3);
        }

        .jp-RenderedHTMLCommon .alert-warning>p:last-child,
        .jp-RenderedHTMLCommon .alert-warning>ul:last-child {
            margin-bottom: 0;
        }

        .jp-RenderedHTMLCommon .alert-success {
            color: var(--jp-success-color0);
            background-color: var(--jp-success-color3);
            border-color: var(--jp-success-color2);
        }

        .jp-RenderedHTMLCommon .alert-success hr {
            border-color: var(--jp-success-color3);
        }

        .jp-RenderedHTMLCommon .alert-success>p:last-child,
        .jp-RenderedHTMLCommon .alert-success>ul:last-child {
            margin-bottom: 0;
        }

        .jp-RenderedHTMLCommon .alert-danger {
            color: var(--jp-error-color0);
            background-color: var(--jp-error-color3);
            border-color: var(--jp-error-color2);
        }

        .jp-RenderedHTMLCommon .alert-danger hr {
            border-color: var(--jp-error-color3);
        }

        .jp-RenderedHTMLCommon .alert-danger>p:last-child,
        .jp-RenderedHTMLCommon .alert-danger>ul:last-child {
            margin-bottom: 0;
        }

        .jp-RenderedHTMLCommon blockquote {
            margin: 1em 2em;
            padding: 0 1em;
            border-left: 5px solid var(--jp-border-color2);
        }

        a.jp-InternalAnchorLink {
            visibility: hidden;
            margin-left: 8px;
            color: var(--md-blue-800);
        }

        h1:hover .jp-InternalAnchorLink,
        h2:hover .jp-InternalAnchorLink,
        h3:hover .jp-InternalAnchorLink,
        h4:hover .jp-InternalAnchorLink,
        h5:hover .jp-InternalAnchorLink,
        h6:hover .jp-InternalAnchorLink {
            visibility: visible;
        }

        .jp-RenderedHTMLCommon kbd {
            background-color: var(--jp-rendermime-table-row-background);
            border: 1px solid var(--jp-border-color0);
            border-bottom-color: var(--jp-border-color2);
            border-radius: 3px;
            box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
            display: inline-block;
            font-size: var(--jp-ui-font-size0);
            line-height: 1em;
            padding: 0.2em 0.5em;
        }

        /* Most direct children of .jp-RenderedHTMLCommon have a margin-bottom of 1.0.
 * At the bottom of cells this is a bit too much as there is also spacing
 * between cells. Going all the way to 0 gets too tight between markdown and
 * code cells.
 */
        .jp-RenderedHTMLCommon>*:last-child {
            margin-bottom: 0.5em;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

        .lm-cursor-backdrop {
            position: fixed;
            width: 200px;
            height: 200px;
            margin-top: -100px;
            margin-left: -100px;
            will-change: transform;
            z-index: 100;
        }

        .lm-mod-drag-image {
            will-change: transform;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        .jp-lineFormSearch {
            padding: 4px 12px;
            background-color: var(--jp-layout-color2);
            box-shadow: var(--jp-toolbar-box-shadow);
            z-index: 2;
            font-size: var(--jp-ui-font-size1);
        }

        .jp-lineFormCaption {
            font-size: var(--jp-ui-font-size0);
            line-height: var(--jp-ui-font-size1);
            margin-top: 4px;
            color: var(--jp-ui-font-color0);
        }

        .jp-baseLineForm {
            border: none;
            border-radius: 0;
            position: absolute;
            background-size: 16px;
            background-repeat: no-repeat;
            background-position: center;
            outline: none;
        }

        .jp-lineFormButtonContainer {
            top: 4px;
            right: 8px;
            height: 24px;
            padding: 0 12px;
            width: 12px;
        }

        .jp-lineFormButtonIcon {
            top: 0;
            right: 0;
            background-color: var(--jp-brand-color1);
            height: 100%;
            width: 100%;
            box-sizing: border-box;
            padding: 4px 6px;
        }

        .jp-lineFormButton {
            top: 0;
            right: 0;
            background-color: transparent;
            height: 100%;
            width: 100%;
            box-sizing: border-box;
        }

        .jp-lineFormWrapper {
            overflow: hidden;
            padding: 0 8px;
            border: 1px solid var(--jp-border-color0);
            background-color: var(--jp-input-active-background);
            height: 22px;
        }

        .jp-lineFormWrapperFocusWithin {
            border: var(--jp-border-width) solid var(--md-blue-500);
            box-shadow: inset 0 0 4px var(--md-blue-300);
        }

        .jp-lineFormInput {
            background: transparent;
            width: 200px;
            height: 100%;
            border: none;
            outline: none;
            color: var(--jp-ui-font-color0);
            line-height: 28px;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-JSONEditor {
            display: flex;
            flex-direction: column;
            width: 100%;
        }

        .jp-JSONEditor-host {
            flex: 1 1 auto;
            border: var(--jp-border-width) solid var(--jp-input-border-color);
            border-radius: 0;
            background: var(--jp-layout-color0);
            min-height: 50px;
            padding: 1px;
        }

        .jp-JSONEditor.jp-mod-error .jp-JSONEditor-host {
            border-color: red;
            outline-color: red;
        }

        .jp-JSONEditor-header {
            display: flex;
            flex: 1 0 auto;
            padding: 0 0 0 12px;
        }

        .jp-JSONEditor-header label {
            flex: 0 0 auto;
        }

        .jp-JSONEditor-commitButton {
            height: 16px;
            width: 16px;
            background-size: 18px;
            background-repeat: no-repeat;
            background-position: center;
        }

        .jp-JSONEditor-host.jp-mod-focused {
            background-color: var(--jp-input-active-background);
            border: 1px solid var(--jp-input-active-border-color);
            box-shadow: var(--jp-input-box-shadow);
        }

        .jp-Editor.jp-mod-dropTarget {
            border: var(--jp-border-width) solid var(--jp-input-active-border-color);
            box-shadow: var(--jp-input-box-shadow);
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/
        .jp-DocumentSearch-input {
            border: none;
            outline: none;
            color: var(--jp-ui-font-color0);
            font-size: var(--jp-ui-font-size1);
            background-color: var(--jp-layout-color0);
            font-family: var(--jp-ui-font-family);
            padding: 2px 1px;
            resize: none;
        }

        .jp-DocumentSearch-overlay {
            position: absolute;
            background-color: var(--jp-toolbar-background);
            border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
            border-left: var(--jp-border-width) solid var(--jp-toolbar-border-color);
            top: 0;
            right: 0;
            z-index: 7;
            min-width: 405px;
            padding: 2px;
            font-size: var(--jp-ui-font-size1);

            --jp-private-document-search-button-height: 20px;
        }

        .jp-DocumentSearch-overlay button {
            background-color: var(--jp-toolbar-background);
            outline: 0;
        }

        .jp-DocumentSearch-overlay button:hover {
            background-color: var(--jp-layout-color2);
        }

        .jp-DocumentSearch-overlay button:active {
            background-color: var(--jp-layout-color3);
        }

        .jp-DocumentSearch-overlay-row {
            display: flex;
            align-items: center;
            margin-bottom: 2px;
        }

        .jp-DocumentSearch-button-content {
            display: inline-block;
            cursor: pointer;
            box-sizing: border-box;
            width: 100%;
            height: 100%;
        }

        .jp-DocumentSearch-button-content svg {
            width: 100%;
            height: 100%;
        }

        .jp-DocumentSearch-input-wrapper {
            border: var(--jp-border-width) solid var(--jp-border-color0);
            display: flex;
            background-color: var(--jp-layout-color0);
            margin: 2px;
        }

        .jp-DocumentSearch-input-wrapper:focus-within {
            border-color: var(--jp-cell-editor-active-border-color);
        }

        .jp-DocumentSearch-toggle-wrapper,
        .jp-DocumentSearch-button-wrapper {
            all: initial;
            overflow: hidden;
            display: inline-block;
            border: none;
            box-sizing: border-box;
        }

        .jp-DocumentSearch-toggle-wrapper {
            width: 14px;
            height: 14px;
        }

        .jp-DocumentSearch-button-wrapper {
            width: var(--jp-private-document-search-button-height);
            height: var(--jp-private-document-search-button-height);
        }

        .jp-DocumentSearch-toggle-wrapper:focus,
        .jp-DocumentSearch-button-wrapper:focus {
            outline: var(--jp-border-width) solid var(--jp-cell-editor-active-border-color);
            outline-offset: -1px;
        }

        .jp-DocumentSearch-toggle-wrapper,
        .jp-DocumentSearch-button-wrapper,
        .jp-DocumentSearch-button-content:focus {
            outline: none;
        }

        .jp-DocumentSearch-toggle-placeholder {
            width: 5px;
        }

        .jp-DocumentSearch-input-button::before {
            display: block;
            padding-top: 100%;
        }

        .jp-DocumentSearch-input-button-off {
            opacity: var(--jp-search-toggle-off-opacity);
        }

        .jp-DocumentSearch-input-button-off:hover {
            opacity: var(--jp-search-toggle-hover-opacity);
        }

        .jp-DocumentSearch-input-button-on {
            opacity: var(--jp-search-toggle-on-opacity);
        }

        .jp-DocumentSearch-index-counter {
            padding-left: 10px;
            padding-right: 10px;
            user-select: none;
            min-width: 35px;
            display: inline-block;
        }

        .jp-DocumentSearch-up-down-wrapper {
            display: inline-block;
            padding-right: 2px;
            margin-left: auto;
            white-space: nowrap;
        }

        .jp-DocumentSearch-spacer {
            margin-left: auto;
        }

        .jp-DocumentSearch-up-down-wrapper button {
            outline: 0;
            border: none;
            width: var(--jp-private-document-search-button-height);
            height: var(--jp-private-document-search-button-height);
            vertical-align: middle;
            margin: 1px 5px 2px;
        }

        .jp-DocumentSearch-up-down-button:hover {
            background-color: var(--jp-layout-color2);
        }

        .jp-DocumentSearch-up-down-button:active {
            background-color: var(--jp-layout-color3);
        }

        .jp-DocumentSearch-filter-button {
            border-radius: var(--jp-border-radius);
        }

        .jp-DocumentSearch-filter-button:hover {
            background-color: var(--jp-layout-color2);
        }

        .jp-DocumentSearch-filter-button-enabled {
            background-color: var(--jp-layout-color2);
        }

        .jp-DocumentSearch-filter-button-enabled:hover {
            background-color: var(--jp-layout-color3);
        }

        .jp-DocumentSearch-search-options {
            padding: 0 8px;
            margin-left: 3px;
            width: 100%;
            display: grid;
            justify-content: start;
            grid-template-columns: 1fr 1fr;
            align-items: center;
            justify-items: stretch;
        }

        .jp-DocumentSearch-search-filter-disabled {
            color: var(--jp-ui-font-color2);
        }

        .jp-DocumentSearch-search-filter {
            display: flex;
            align-items: center;
            user-select: none;
        }

        .jp-DocumentSearch-regex-error {
            color: var(--jp-error-color0);
        }

        .jp-DocumentSearch-replace-button-wrapper {
            overflow: hidden;
            display: inline-block;
            box-sizing: border-box;
            border: var(--jp-border-width) solid var(--jp-border-color0);
            margin: auto 2px;
            padding: 1px 4px;
            height: calc(var(--jp-private-document-search-button-height) + 2px);
        }

        .jp-DocumentSearch-replace-button-wrapper:focus {
            border: var(--jp-border-width) solid var(--jp-cell-editor-active-border-color);
        }

        .jp-DocumentSearch-replace-button {
            display: inline-block;
            text-align: center;
            cursor: pointer;
            box-sizing: border-box;
            color: var(--jp-ui-font-color1);

            /* height - 2 * (padding of wrapper) */
            line-height: calc(var(--jp-private-document-search-button-height) - 2px);
            width: 100%;
            height: 100%;
        }

        .jp-DocumentSearch-replace-button:focus {
            outline: none;
        }

        .jp-DocumentSearch-replace-wrapper-class {
            margin-left: 14px;
            display: flex;
        }

        .jp-DocumentSearch-replace-toggle {
            border: none;
            background-color: var(--jp-toolbar-background);
            border-radius: var(--jp-border-radius);
        }

        .jp-DocumentSearch-replace-toggle:hover {
            background-color: var(--jp-layout-color2);
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .cm-editor {
            line-height: var(--jp-code-line-height);
            font-size: var(--jp-code-font-size);
            font-family: var(--jp-code-font-family);
            border: 0;
            border-radius: 0;
            height: auto;

            /* Changed to auto to autogrow */
        }

        .cm-editor pre {
            padding: 0 var(--jp-code-padding);
        }

        .jp-CodeMirrorEditor[data-type='inline'] .cm-dialog {
            background-color: var(--jp-layout-color0);
            color: var(--jp-content-font-color1);
        }

        .jp-CodeMirrorEditor {
            cursor: text;
        }

        /* When zoomed out 67% and 33% on a screen of 1440 width x 900 height */
        @media screen and (min-width: 2138px) and (max-width: 4319px) {
            .jp-CodeMirrorEditor[data-type='inline'] .cm-cursor {
                border-left: var(--jp-code-cursor-width1) solid var(--jp-editor-cursor-color);
            }
        }

        /* When zoomed out less than 33% */
        @media screen and (min-width: 4320px) {
            .jp-CodeMirrorEditor[data-type='inline'] .cm-cursor {
                border-left: var(--jp-code-cursor-width2) solid var(--jp-editor-cursor-color);
            }
        }

        .cm-editor.jp-mod-readOnly .cm-cursor {
            display: none;
        }

        .jp-CollaboratorCursor {
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: none;
            border-bottom: 3px solid;
            background-clip: content-box;
            margin-left: -5px;
            margin-right: -5px;
        }

        .cm-searching,
        .cm-searching span {
            /* `.cm-searching span`: we need to override syntax highlighting */
            background-color: var(--jp-search-unselected-match-background-color);
            color: var(--jp-search-unselected-match-color);
        }

        .cm-searching::selection,
        .cm-searching span::selection {
            background-color: var(--jp-search-unselected-match-background-color);
            color: var(--jp-search-unselected-match-color);
        }

        .jp-current-match>.cm-searching,
        .jp-current-match>.cm-searching span,
        .cm-searching>.jp-current-match,
        .cm-searching>.jp-current-match span {
            background-color: var(--jp-search-selected-match-background-color);
            color: var(--jp-search-selected-match-color);
        }

        .jp-current-match>.cm-searching::selection,
        .cm-searching>.jp-current-match::selection,
        .jp-current-match>.cm-searching span::selection {
            background-color: var(--jp-search-selected-match-background-color);
            color: var(--jp-search-selected-match-color);
        }

        .cm-trailingspace {
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAYAAAB4ka1VAAAAsElEQVQIHQGlAFr/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7+r3zKmT0/+pk9P/7+r3zAAAAAAAAAAABAAAAAAAAAAA6OPzM+/q9wAAAAAA6OPzMwAAAAAAAAAAAgAAAAAAAAAAGR8NiRQaCgAZIA0AGR8NiQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQyoYJ/SY80UAAAAASUVORK5CYII=);
            background-position: center left;
            background-repeat: repeat-x;
        }

        .jp-CollaboratorCursor-hover {
            position: absolute;
            z-index: 1;
            transform: translateX(-50%);
            color: white;
            border-radius: 3px;
            padding-left: 4px;
            padding-right: 4px;
            padding-top: 1px;
            padding-bottom: 1px;
            text-align: center;
            font-size: var(--jp-ui-font-size1);
            white-space: nowrap;
        }

        .jp-CodeMirror-ruler {
            border-left: 1px dashed var(--jp-border-color2);
        }

        /* Styles for shared cursors (remote cursor locations and selected ranges) */
        .jp-CodeMirrorEditor .cm-ySelectionCaret {
            position: relative;
            border-left: 1px solid black;
            margin-left: -1px;
            margin-right: -1px;
            box-sizing: border-box;
        }

        .jp-CodeMirrorEditor .cm-ySelectionCaret>.cm-ySelectionInfo {
            white-space: nowrap;
            position: absolute;
            top: -1.15em;
            padding-bottom: 0.05em;
            left: -1px;
            font-size: 0.95em;
            font-family: var(--jp-ui-font-family);
            font-weight: bold;
            line-height: normal;
            user-select: none;
            color: white;
            padding-left: 2px;
            padding-right: 2px;
            z-index: 101;
            transition: opacity 0.3s ease-in-out;
        }

        .jp-CodeMirrorEditor .cm-ySelectionInfo {
            transition-delay: 0.7s;
            opacity: 0;
        }

        .jp-CodeMirrorEditor .cm-ySelectionCaret:hover>.cm-ySelectionInfo {
            opacity: 1;
            transition-delay: 0s;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-MimeDocument {
            outline: none;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-FileBrowser .jp-SidePanel-content {
            display: flex;
            flex-direction: column;
        }

        .jp-FileBrowser-toolbar.jp-Toolbar {
            flex-wrap: wrap;
            row-gap: 12px;
            border-bottom: none;
            height: auto;
            margin: 8px 12px 0;
            box-shadow: none;
            padding: 0;
            justify-content: flex-start;
        }

        .jp-FileBrowser-Panel {
            flex: 1 1 auto;
            display: flex;
            flex-direction: column;
        }

        .jp-BreadCrumbs {
            flex: 0 0 auto;
            margin: 8px 12px;
        }

        .jp-BreadCrumbs-item {
            margin: 0 2px;
            padding: 0 2px;
            border-radius: var(--jp-border-radius);
            cursor: pointer;
        }

        .jp-BreadCrumbs-item:hover {
            background-color: var(--jp-layout-color2);
        }

        .jp-BreadCrumbs-item:first-child {
            margin-left: 0;
        }

        .jp-BreadCrumbs-item.jp-mod-dropTarget {
            background-color: var(--jp-brand-color2);
            opacity: 0.7;
        }

        /*-----------------------------------------------------------------------------
| Buttons
|----------------------------------------------------------------------------*/

        .jp-FileBrowser-toolbar>.jp-Toolbar-item {
            flex: 0 0 auto;
            padding-left: 0;
            padding-right: 2px;
            align-items: center;
            height: unset;
        }

        .jp-FileBrowser-toolbar>.jp-Toolbar-item .jp-ToolbarButtonComponent {
            width: 40px;
        }

        /*-----------------------------------------------------------------------------
| Other styles
|----------------------------------------------------------------------------*/

        .jp-FileDialog.jp-mod-conflict input {
            color: var(--jp-error-color1);
        }

        .jp-FileDialog .jp-new-name-title {
            margin-top: 12px;
        }

        .jp-LastModified-hidden {
            display: none;
        }

        .jp-FileSize-hidden {
            display: none;
        }

        .jp-FileBrowser .lm-AccordionPanel>h3:first-child {
            display: none;
        }

        /*-----------------------------------------------------------------------------
| DirListing
|----------------------------------------------------------------------------*/

        .jp-DirListing {
            flex: 1 1 auto;
            display: flex;
            flex-direction: column;
            outline: 0;
        }

        .jp-DirListing-header {
            flex: 0 0 auto;
            display: flex;
            flex-direction: row;
            align-items: center;
            overflow: hidden;
            border-top: var(--jp-border-width) solid var(--jp-border-color2);
            border-bottom: var(--jp-border-width) solid var(--jp-border-color1);
            box-shadow: var(--jp-toolbar-box-shadow);
            z-index: 2;
        }

        .jp-DirListing-headerItem {
            padding: 4px 12px 2px;
            font-weight: 500;
        }

        .jp-DirListing-headerItem:hover {
            background: var(--jp-layout-color2);
        }

        .jp-DirListing-headerItem.jp-id-name {
            flex: 1 0 84px;
        }

        .jp-DirListing-headerItem.jp-id-modified {
            flex: 0 0 112px;
            border-left: var(--jp-border-width) solid var(--jp-border-color2);
            text-align: right;
        }

        .jp-DirListing-headerItem.jp-id-filesize {
            flex: 0 0 75px;
            border-left: var(--jp-border-width) solid var(--jp-border-color2);
            text-align: right;
        }

        .jp-id-narrow {
            display: none;
            flex: 0 0 5px;
            padding: 4px;
            border-left: var(--jp-border-width) solid var(--jp-border-color2);
            text-align: right;
            color: var(--jp-border-color2);
        }

        .jp-DirListing-narrow .jp-id-narrow {
            display: block;
        }

        .jp-DirListing-narrow .jp-id-modified,
        .jp-DirListing-narrow .jp-DirListing-itemModified {
            display: none;
        }

        .jp-DirListing-headerItem.jp-mod-selected {
            font-weight: 600;
        }

        /* increase specificity to override bundled default */
        .jp-DirListing-content {
            flex: 1 1 auto;
            margin: 0;
            padding: 0;
            list-style-type: none;
            overflow: auto;
            background-color: var(--jp-layout-color1);
        }

        .jp-DirListing-content mark {
            color: var(--jp-ui-font-color0);
            background-color: transparent;
            font-weight: bold;
        }

        .jp-DirListing-content .jp-DirListing-item.jp-mod-selected mark {
            color: var(--jp-ui-inverse-font-color0);
        }

        /* Style the directory listing content when a user drops a file to upload */
        .jp-DirListing.jp-mod-native-drop .jp-DirListing-content {
            outline: 5px dashed rgba(128, 128, 128, 0.5);
            outline-offset: -10px;
            cursor: copy;
        }

        .jp-DirListing-item {
            display: flex;
            flex-direction: row;
            align-items: center;
            padding: 4px 12px;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .jp-DirListing-checkboxWrapper {
            /* Increases hit area of checkbox. */
            padding: 4px;
        }

        .jp-DirListing-header .jp-DirListing-checkboxWrapper+.jp-DirListing-headerItem {
            padding-left: 4px;
        }

        .jp-DirListing-content .jp-DirListing-checkboxWrapper {
            position: relative;
            left: -4px;
            margin: -4px 0 -4px -8px;
        }

        .jp-DirListing-checkboxWrapper.jp-mod-visible {
            visibility: visible;
        }

        /* For devices that support hovering, hide checkboxes until hovered, selected...
*/
        @media (hover: hover) {
            .jp-DirListing-checkboxWrapper {
                visibility: hidden;
            }

            .jp-DirListing-item:hover .jp-DirListing-checkboxWrapper,
            .jp-DirListing-item.jp-mod-selected .jp-DirListing-checkboxWrapper {
                visibility: visible;
            }
        }

        .jp-DirListing-item[data-is-dot] {
            opacity: 75%;
        }

        .jp-DirListing-item.jp-mod-selected {
            color: var(--jp-ui-inverse-font-color1);
            background: var(--jp-brand-color1);
        }

        .jp-DirListing-item.jp-mod-dropTarget {
            background: var(--jp-brand-color3);
        }

        .jp-DirListing-item:hover:not(.jp-mod-selected) {
            background: var(--jp-layout-color2);
        }

        .jp-DirListing-itemIcon {
            flex: 0 0 20px;
            margin-right: 4px;
        }

        .jp-DirListing-itemText {
            flex: 1 0 64px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            user-select: none;
        }

        .jp-DirListing-itemText:focus {
            outline-width: 2px;
            outline-color: var(--jp-inverse-layout-color1);
            outline-style: solid;
            outline-offset: 1px;
        }

        .jp-DirListing-item.jp-mod-selected .jp-DirListing-itemText:focus {
            outline-color: var(--jp-layout-color1);
        }

        .jp-DirListing-itemModified {
            flex: 0 0 125px;
            text-align: right;
        }

        .jp-DirListing-itemFileSize {
            flex: 0 0 90px;
            text-align: right;
        }

        .jp-DirListing-editor {
            flex: 1 0 64px;
            outline: none;
            border: none;
            color: var(--jp-ui-font-color1);
            background-color: var(--jp-layout-color1);
        }

        .jp-DirListing-item.jp-mod-running .jp-DirListing-itemIcon::before {
            color: var(--jp-success-color1);
            content: '\25CF';
            font-size: 8px;
            position: absolute;
            left: -8px;
        }

        .jp-DirListing-item.jp-mod-running.jp-mod-selected .jp-DirListing-itemIcon::before {
            color: var(--jp-ui-inverse-font-color1);
        }

        .jp-DirListing-item.lm-mod-drag-image,
        .jp-DirListing-item.jp-mod-selected.lm-mod-drag-image {
            font-size: var(--jp-ui-font-size1);
            padding-left: 4px;
            margin-left: 4px;
            width: 160px;
            background-color: var(--jp-ui-inverse-font-color2);
            box-shadow: var(--jp-elevation-z2);
            border-radius: 0;
            color: var(--jp-ui-font-color1);
            transform: translateX(-40%) translateY(-58%);
        }

        .jp-Document {
            min-width: 120px;
            min-height: 120px;
            outline: none;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Main OutputArea
| OutputArea has a list of Outputs
|----------------------------------------------------------------------------*/

        .jp-OutputArea {
            overflow-y: auto;
        }

        .jp-OutputArea-child {
            display: table;
            table-layout: fixed;
            width: 100%;
            overflow: hidden;
        }

        .jp-OutputPrompt {
            width: var(--jp-cell-prompt-width);
            color: var(--jp-cell-outprompt-font-color);
            font-family: var(--jp-cell-prompt-font-family);
            padding: var(--jp-code-padding);
            letter-spacing: var(--jp-cell-prompt-letter-spacing);
            line-height: var(--jp-code-line-height);
            font-size: var(--jp-code-font-size);
            border: var(--jp-border-width) solid transparent;
            opacity: var(--jp-cell-prompt-opacity);

            /* Right align prompt text, don't wrap to handle large prompt numbers */
            text-align: right;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;

            /* Disable text selection */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .jp-OutputArea-prompt {
            display: table-cell;
            vertical-align: top;
        }

        .jp-OutputArea-output {
            display: table-cell;
            width: 100%;
            height: auto;
            overflow: auto;
            user-select: text;
            -moz-user-select: text;
            -webkit-user-select: text;
            -ms-user-select: text;
        }

        .jp-OutputArea .jp-RenderedText {
            padding-left: 1ch;
        }

        /**
 * Prompt overlay.
 */

        .jp-OutputArea-promptOverlay {
            position: absolute;
            top: 0;
            width: var(--jp-cell-prompt-width);
            height: 100%;
            opacity: 0.5;
        }

        .jp-OutputArea-promptOverlay:hover {
            background: var(--jp-layout-color2);
            box-shadow: inset 0 0 1px var(--jp-inverse-layout-color0);
            cursor: zoom-out;
        }

        .jp-mod-outputsScrolled .jp-OutputArea-promptOverlay:hover {
            cursor: zoom-in;
        }

        /**
 * Isolated output.
 */
        .jp-OutputArea-output.jp-mod-isolated {
            width: 100%;
            display: block;
        }

        /*
When drag events occur, `lm-mod-override-cursor` is added to the body.
Because iframes steal all cursor events, the following two rules are necessary
to suppress pointer events while resize drags are occurring. There may be a
better solution to this problem.
*/
        body.lm-mod-override-cursor .jp-OutputArea-output.jp-mod-isolated {
            position: relative;
        }

        body.lm-mod-override-cursor .jp-OutputArea-output.jp-mod-isolated::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: transparent;
        }

        /* pre */

        .jp-OutputArea-output pre {
            border: none;
            margin: 0;
            padding: 0;
            overflow-x: auto;
            overflow-y: auto;
            word-break: break-all;
            word-wrap: break-word;
            white-space: pre-wrap;
        }

        /* tables */

        .jp-OutputArea-output.jp-RenderedHTMLCommon table {
            margin-left: 0;
            margin-right: 0;
        }

        /* description lists */

        .jp-OutputArea-output dl,
        .jp-OutputArea-output dt,
        .jp-OutputArea-output dd {
            display: block;
        }

        .jp-OutputArea-output dl {
            width: 100%;
            overflow: hidden;
            padding: 0;
            margin: 0;
        }

        .jp-OutputArea-output dt {
            font-weight: bold;
            float: left;
            width: 20%;
            padding: 0;
            margin: 0;
        }

        .jp-OutputArea-output dd {
            float: left;
            width: 80%;
            padding: 0;
            margin: 0;
        }

        .jp-TrimmedOutputs pre {
            background: var(--jp-layout-color3);
            font-size: calc(var(--jp-code-font-size) * 1.4);
            text-align: center;
            text-transform: uppercase;
        }

        /* Hide the gutter in case of
 *  - nested output areas (e.g. in the case of output widgets)
 *  - mirrored output areas
 */
        .jp-OutputArea .jp-OutputArea .jp-OutputArea-prompt {
            display: none;
        }

        /* Hide empty lines in the output area, for instance due to cleared widgets */
        .jp-OutputArea-prompt:empty {
            padding: 0;
            border: 0;
        }

        /*-----------------------------------------------------------------------------
| executeResult is added to any Output-result for the display of the object
| returned by a cell
|----------------------------------------------------------------------------*/

        .jp-OutputArea-output.jp-OutputArea-executeResult {
            margin-left: 0;
            width: 100%;
        }

        /* Text output with the Out[] prompt needs a top padding to match the
 * alignment of the Out[] prompt itself.
 */
        .jp-OutputArea-executeResult .jp-RenderedText.jp-OutputArea-output {
            padding-top: var(--jp-code-padding);
            border-top: var(--jp-border-width) solid transparent;
        }

        /*-----------------------------------------------------------------------------
| The Stdin output
|----------------------------------------------------------------------------*/

        .jp-Stdin-prompt {
            color: var(--jp-content-font-color0);
            padding-right: var(--jp-code-padding);
            vertical-align: baseline;
            flex: 0 0 auto;
        }

        .jp-Stdin-input {
            font-family: var(--jp-code-font-family);
            font-size: inherit;
            color: inherit;
            background-color: inherit;
            width: 42%;
            min-width: 200px;

            /* make sure input baseline aligns with prompt */
            vertical-align: baseline;

            /* padding + margin = 0.5em between prompt and cursor */
            padding: 0 0.25em;
            margin: 0 0.25em;
            flex: 0 0 70%;
        }

        .jp-Stdin-input::placeholder {
            opacity: 0;
        }

        .jp-Stdin-input:focus {
            box-shadow: none;
        }

        .jp-Stdin-input:focus::placeholder {
            opacity: 1;
        }

        /*-----------------------------------------------------------------------------
| Output Area View
|----------------------------------------------------------------------------*/

        .jp-LinkedOutputView .jp-OutputArea {
            height: 100%;
            display: block;
        }

        .jp-LinkedOutputView .jp-OutputArea-output:only-child {
            height: 100%;
        }

        /*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

        @media print {
            .jp-OutputArea-child {
                break-inside: avoid-page;
            }
        }

        /*-----------------------------------------------------------------------------
| Mobile
|----------------------------------------------------------------------------*/
        @media only screen and (max-width: 760px) {
            .jp-OutputPrompt {
                display: table-row;
                text-align: left;
            }

            .jp-OutputArea-child .jp-OutputArea-output {
                display: table-row;
                margin-left: var(--jp-notebook-padding);
            }
        }

        /* Trimmed outputs warning */
        .jp-TrimmedOutputs>a {
            margin: 10px;
            text-decoration: none;
            cursor: pointer;
        }

        .jp-TrimmedOutputs>a:hover {
            text-decoration: none;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Table of Contents
|----------------------------------------------------------------------------*/

        .jp-TableOfContents {
            display: flex;
            flex-direction: column;
            background: var(--jp-layout-color1);
            color: var(--jp-ui-font-color1);
            font-size: var(--jp-ui-font-size1);
            height: 100%;
        }

        .jp-TableOfContents-placeholder {
            text-align: center;
        }

        .jp-TableOfContents-placeholderContent {
            color: var(--jp-content-font-color2);
            padding: 8px;
        }

        .jp-TableOfContents-placeholderContent>h3 {
            margin-bottom: var(--jp-content-heading-margin-bottom);
        }

        .jp-TableOfContents .jp-SidePanel-content {
            overflow-y: auto;
        }

        .jp-TableOfContents-tree {
            margin: 4px;
        }

        .jp-TableOfContents ol {
            list-style-type: none;
        }

        /* stylelint-disable-next-line selector-max-type */
        .jp-TableOfContents li>ol {
            /* Align left border with triangle icon center */
            padding-left: 11px;
        }

        .jp-TableOfContents-content {
            /* left margin for the active heading indicator */
            margin: 0 0 0 var(--jp-private-toc-active-width);
            padding: 0;
            background-color: var(--jp-layout-color1);
        }

        .jp-tocItem {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .jp-tocItem-heading {
            display: flex;
            cursor: pointer;
        }

        .jp-tocItem-heading:hover {
            background-color: var(--jp-layout-color2);
        }

        .jp-tocItem-content {
            display: block;
            padding: 4px 0;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow-x: hidden;
        }

        .jp-tocItem-collapser {
            height: 20px;
            margin: 2px 2px 0;
            padding: 0;
            background: none;
            border: none;
            cursor: pointer;
        }

        .jp-tocItem-collapser:hover {
            background-color: var(--jp-layout-color3);
        }

        /* Active heading indicator */

        .jp-tocItem-heading::before {
            content: ' ';
            background: transparent;
            width: var(--jp-private-toc-active-width);
            height: 24px;
            position: absolute;
            left: 0;
            border-radius: var(--jp-border-radius);
        }

        .jp-tocItem-heading.jp-tocItem-active::before {
            background-color: var(--jp-brand-color1);
        }

        .jp-tocItem-heading:hover.jp-tocItem-active::before {
            background: var(--jp-brand-color0);
            opacity: 1;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        .jp-Collapser {
            flex: 0 0 var(--jp-cell-collapser-width);
            padding: 0;
            margin: 0;
            border: none;
            outline: none;
            background: transparent;
            border-radius: var(--jp-border-radius);
            opacity: 1;
        }

        .jp-Collapser-child {
            display: block;
            width: 100%;
            box-sizing: border-box;

            /* height: 100% doesn't work because the height of its parent is computed from content */
            position: absolute;
            top: 0;
            bottom: 0;
        }

        /*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

        /*
Hiding collapsers in print mode.

Note: input and output wrappers have "display: block" propery in print mode.
*/

        @media print {
            .jp-Collapser {
                display: none;
            }
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Header/Footer
|----------------------------------------------------------------------------*/

        /* Hidden by zero height by default */
        .jp-CellHeader,
        .jp-CellFooter {
            height: 0;
            width: 100%;
            padding: 0;
            margin: 0;
            border: none;
            outline: none;
            background: transparent;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Input
|----------------------------------------------------------------------------*/

        /* All input areas */
        .jp-InputArea {
            display: table;
            table-layout: fixed;
            width: 100%;
            overflow: hidden;
        }

        .jp-InputArea-editor {
            display: table-cell;
            overflow: hidden;
            vertical-align: top;

            /* This is the non-active, default styling */
            border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
            border-radius: 0;
            background: var(--jp-cell-editor-background);
        }

        .jp-InputPrompt {
            display: table-cell;
            vertical-align: top;
            width: var(--jp-cell-prompt-width);
            color: var(--jp-cell-inprompt-font-color);
            font-family: var(--jp-cell-prompt-font-family);
            padding: var(--jp-code-padding);
            letter-spacing: var(--jp-cell-prompt-letter-spacing);
            opacity: var(--jp-cell-prompt-opacity);
            line-height: var(--jp-code-line-height);
            font-size: var(--jp-code-font-size);
            border: var(--jp-border-width) solid transparent;

            /* Right align prompt text, don't wrap to handle large prompt numbers */
            text-align: right;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;

            /* Disable text selection */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /*-----------------------------------------------------------------------------
| Mobile
|----------------------------------------------------------------------------*/
        @media only screen and (max-width: 760px) {
            .jp-InputArea-editor {
                display: table-row;
                margin-left: var(--jp-notebook-padding);
            }

            .jp-InputPrompt {
                display: table-row;
                text-align: left;
            }
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Placeholder
|----------------------------------------------------------------------------*/

        .jp-Placeholder {
            display: table;
            table-layout: fixed;
            width: 100%;
        }

        .jp-Placeholder-prompt {
            display: table-cell;
            box-sizing: border-box;
        }

        .jp-Placeholder-content {
            display: table-cell;
            padding: 4px 6px;
            border: 1px solid transparent;
            border-radius: 0;
            background: none;
            box-sizing: border-box;
            cursor: pointer;
        }

        .jp-Placeholder-contentContainer {
            display: flex;
        }

        .jp-Placeholder-content:hover,
        .jp-InputPlaceholder>.jp-Placeholder-content:hover {
            border-color: var(--jp-layout-color3);
        }

        .jp-Placeholder-content .jp-MoreHorizIcon {
            width: 32px;
            height: 16px;
            border: 1px solid transparent;
            border-radius: var(--jp-border-radius);
        }

        .jp-Placeholder-content .jp-MoreHorizIcon:hover {
            border: 1px solid var(--jp-border-color1);
            box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.25);
            background-color: var(--jp-layout-color0);
        }

        .jp-PlaceholderText {
            white-space: nowrap;
            overflow-x: hidden;
            color: var(--jp-inverse-layout-color3);
            font-family: var(--jp-code-font-family);
        }

        .jp-InputPlaceholder>.jp-Placeholder-content {
            border-color: var(--jp-cell-editor-border-color);
            background: var(--jp-cell-editor-background);
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Private CSS variables
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Cell
|----------------------------------------------------------------------------*/

        .jp-Cell {
            padding: var(--jp-cell-padding);
            margin: 0;
            border: none;
            outline: none;
            background: transparent;
        }

        /*-----------------------------------------------------------------------------
| Common input/output
|----------------------------------------------------------------------------*/

        .jp-Cell-inputWrapper,
        .jp-Cell-outputWrapper {
            display: flex;
            flex-direction: row;
            padding: 0;
            margin: 0;

            /* Added to reveal the box-shadow on the input and output collapsers. */
            overflow: visible;
        }

        /* Only input/output areas inside cells */
        .jp-Cell-inputArea,
        .jp-Cell-outputArea {
            flex: 1 1 auto;
        }

        /*-----------------------------------------------------------------------------
| Collapser
|----------------------------------------------------------------------------*/

        /* Make the output collapser disappear when there is not output, but do so
 * in a manner that leaves it in the layout and preserves its width.
 */
        .jp-Cell.jp-mod-noOutputs .jp-Cell-outputCollapser {
            border: none !important;
            background: transparent !important;
        }

        .jp-Cell:not(.jp-mod-noOutputs) .jp-Cell-outputCollapser {
            min-height: var(--jp-cell-collapser-min-height);
        }

        /*-----------------------------------------------------------------------------
| Output
|----------------------------------------------------------------------------*/

        /* Put a space between input and output when there IS output */
        .jp-Cell:not(.jp-mod-noOutputs) .jp-Cell-outputWrapper {
            margin-top: 5px;
        }

        .jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea {
            overflow-y: auto;
            max-height: 24em;
            margin-left: var(--jp-private-cell-scrolling-output-offset);
            resize: vertical;
        }

        .jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea[style*='height'] {
            max-height: unset;
        }

        .jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea::after {
            content: ' ';
            box-shadow: inset 0 0 6px 2px rgb(0 0 0 / 30%);
            width: 100%;
            height: 100%;
            position: sticky;
            bottom: 0;
            top: 0;
            margin-top: -50%;
            float: left;
            display: block;
            pointer-events: none;
        }

        .jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-child {
            padding-top: 6px;
        }

        .jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-prompt {
            width: calc(var(--jp-cell-prompt-width) - var(--jp-private-cell-scrolling-output-offset));
        }

        .jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-promptOverlay {
            left: calc(-1 * var(--jp-private-cell-scrolling-output-offset));
        }

        /*-----------------------------------------------------------------------------
| CodeCell
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| MarkdownCell
|----------------------------------------------------------------------------*/

        .jp-MarkdownOutput {
            display: table-cell;
            width: 100%;
            margin-top: 0;
            margin-bottom: 0;
            padding-left: var(--jp-code-padding);
        }

        .jp-MarkdownOutput.jp-RenderedHTMLCommon {
            overflow: auto;
        }

        /* collapseHeadingButton (show always if hiddenCellsButton is _not_ shown) */
        .jp-collapseHeadingButton {
            display: flex;
            min-height: var(--jp-cell-collapser-min-height);
            font-size: var(--jp-code-font-size);
            position: absolute;
            background-color: transparent;
            background-size: 25px;
            background-repeat: no-repeat;
            background-position-x: center;
            background-position-y: top;
            background-image: var(--jp-icon-caret-down);
            right: 0;
            top: 0;
            bottom: 0;
        }

        .jp-collapseHeadingButton.jp-mod-collapsed {
            background-image: var(--jp-icon-caret-right);
        }

        /*
 set the container font size to match that of content
 so that the nested collapse buttons have the right size
*/
        .jp-MarkdownCell .jp-InputPrompt {
            font-size: var(--jp-content-font-size1);
        }

        /*
  Align collapseHeadingButton with cell top header
  The font sizes are identical to the ones in packages/rendermime/style/base.css
*/
        .jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='1'] {
            font-size: var(--jp-content-font-size5);
            background-position-y: calc(0.3 * var(--jp-content-font-size5));
        }

        .jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='2'] {
            font-size: var(--jp-content-font-size4);
            background-position-y: calc(0.3 * var(--jp-content-font-size4));
        }

        .jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='3'] {
            font-size: var(--jp-content-font-size3);
            background-position-y: calc(0.3 * var(--jp-content-font-size3));
        }

        .jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='4'] {
            font-size: var(--jp-content-font-size2);
            background-position-y: calc(0.3 * var(--jp-content-font-size2));
        }

        .jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='5'] {
            font-size: var(--jp-content-font-size1);
            background-position-y: top;
        }

        .jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='6'] {
            font-size: var(--jp-content-font-size0);
            background-position-y: top;
        }

        /* collapseHeadingButton (show only on (hover,active) if hiddenCellsButton is shown) */
        .jp-Notebook.jp-mod-showHiddenCellsButton .jp-collapseHeadingButton {
            display: none;
        }

        .jp-Notebook.jp-mod-showHiddenCellsButton :is(.jp-MarkdownCell:hover, .jp-mod-active) .jp-collapseHeadingButton {
            display: flex;
        }

        /* showHiddenCellsButton (only show if jp-mod-showHiddenCellsButton is set, which
is a consequence of the showHiddenCellsButton option in Notebook Settings)*/
        .jp-Notebook.jp-mod-showHiddenCellsButton .jp-showHiddenCellsButton {
            margin-left: calc(var(--jp-cell-prompt-width) + 2 * var(--jp-code-padding));
            margin-top: var(--jp-code-padding);
            border: 1px solid var(--jp-border-color2);
            background-color: var(--jp-border-color3) !important;
            color: var(--jp-content-font-color0) !important;
            display: flex;
        }

        .jp-Notebook.jp-mod-showHiddenCellsButton .jp-showHiddenCellsButton:hover {
            background-color: var(--jp-border-color2) !important;
        }

        .jp-showHiddenCellsButton {
            display: none;
        }

        /*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

        /*
Using block instead of flex to allow the use of the break-inside CSS property for
cell outputs.
*/

        @media print {

            .jp-Cell-inputWrapper,
            .jp-Cell-outputWrapper {
                display: block;
            }
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

        .jp-NotebookPanel-toolbar {
            padding: var(--jp-notebook-toolbar-padding);

            /* disable paint containment from lumino 2.0 default strict CSS containment */
            contain: style size !important;
        }

        .jp-Toolbar-item.jp-Notebook-toolbarCellType .jp-select-wrapper.jp-mod-focused {
            border: none;
            box-shadow: none;
        }

        .jp-Notebook-toolbarCellTypeDropdown select {
            height: 24px;
            font-size: var(--jp-ui-font-size1);
            line-height: 14px;
            border-radius: 0;
            display: block;
        }

        .jp-Notebook-toolbarCellTypeDropdown span {
            top: 5px !important;
        }

        .jp-Toolbar-responsive-popup {
            position: absolute;
            height: fit-content;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: flex-end;
            border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
            box-shadow: var(--jp-toolbar-box-shadow);
            background: var(--jp-toolbar-background);
            min-height: var(--jp-toolbar-micro-height);
            padding: var(--jp-notebook-toolbar-padding);
            z-index: 1;
            right: 0;
            top: 0;
        }

        .jp-Toolbar>.jp-Toolbar-responsive-opener {
            margin-left: auto;
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

        .jp-Notebook-ExecutionIndicator {
            position: relative;
            display: inline-block;
            height: 100%;
            z-index: 9997;
        }

        .jp-Notebook-ExecutionIndicator-tooltip {
            visibility: hidden;
            height: auto;
            width: max-content;
            width: -moz-max-content;
            background-color: var(--jp-layout-color2);
            color: var(--jp-ui-font-color1);
            text-align: justify;
            border-radius: 6px;
            padding: 0 5px;
            position: fixed;
            display: table;
        }

        .jp-Notebook-ExecutionIndicator-tooltip.up {
            transform: translateX(-50%) translateY(-100%) translateY(-32px);
        }

        .jp-Notebook-ExecutionIndicator-tooltip.down {
            transform: translateX(calc(-100% + 16px)) translateY(5px);
        }

        .jp-Notebook-ExecutionIndicator-tooltip.hidden {
            display: none;
        }

        .jp-Notebook-ExecutionIndicator:hover .jp-Notebook-ExecutionIndicator-tooltip {
            visibility: visible;
        }

        .jp-Notebook-ExecutionIndicator span {
            font-size: var(--jp-ui-font-size1);
            font-family: var(--jp-ui-font-family);
            color: var(--jp-ui-font-color1);
            line-height: 24px;
            display: block;
        }

        .jp-Notebook-ExecutionIndicator-progress-bar {
            display: flex;
            justify-content: center;
            height: 100%;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        /*
 * Execution indicator
 */
        .jp-tocItem-content::after {
            content: '';

            /* Must be identical to form a circle */
            width: 12px;
            height: 12px;
            background: none;
            border: none;
            position: absolute;
            right: 0;
        }

        .jp-tocItem-content[data-running='0']::after {
            border-radius: 50%;
            border: var(--jp-border-width) solid var(--jp-inverse-layout-color3);
            background: none;
        }

        .jp-tocItem-content[data-running='1']::after {
            border-radius: 50%;
            border: var(--jp-border-width) solid var(--jp-inverse-layout-color3);
            background-color: var(--jp-inverse-layout-color3);
        }

        .jp-tocItem-content[data-running='0'],
        .jp-tocItem-content[data-running='1'] {
            margin-right: 12px;
        }

        /*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

        .jp-Notebook-footer {
            height: 27px;
            margin-left: calc(var(--jp-cell-prompt-width) + var(--jp-cell-collapser-width) + var(--jp-cell-padding));
            width: calc(100% - (var(--jp-cell-prompt-width) + var(--jp-cell-collapser-width) + var(--jp-cell-padding) + var(--jp-cell-padding)));
            border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
            color: var(--jp-ui-font-color3);
            margin-top: 6px;
            background: none;
            cursor: pointer;
        }

        .jp-Notebook-footer:focus {
            border-color: var(--jp-cell-editor-active-border-color);
        }

        /* For devices that support hovering, hide footer until hover */
        @media (hover: hover) {
            .jp-Notebook-footer {
                opacity: 0;
            }

            .jp-Notebook-footer:focus,
            .jp-Notebook-footer:hover {
                opacity: 1;
            }
        }

        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Imports
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| CSS variables
|----------------------------------------------------------------------------*/

        /*-----------------------------------------------------------------------------
| Notebook
|----------------------------------------------------------------------------*/

        /* stylelint-disable selector-max-class */

        .jp-NotebookPanel {
            display: block;
            height: 100%;
        }

        .jp-NotebookPanel.jp-Document {
            min-width: 240px;
            min-height: 120px;
        }

        .jp-Notebook {
            padding: var(--jp-notebook-padding);
            outline: none;
            overflow: auto;
            background: var(--jp-layout-color0);
        }

        .jp-Notebook.jp-mod-scrollPastEnd::after {
            display: block;
            content: '';
            min-height: var(--jp-notebook-scroll-padding);
        }

        .jp-MainAreaWidget-ContainStrict .jp-Notebook * {
            contain: strict;
        }

        .jp-Notebook .jp-Cell {
            overflow: visible;
        }

        .jp-Notebook .jp-Cell .jp-InputPrompt {
            cursor: move;
        }

        /*-----------------------------------------------------------------------------
| Notebook state related styling
|
| The notebook and cells each have states, here are the possibilities:
|
| - Notebook
|   - Command
|   - Edit
| - Cell
|   - None
|   - Active (only one can be active)
|   - Selected (the cells actions are applied to)
|   - Multiselected (when multiple selected, the cursor)
|   - No outputs
|----------------------------------------------------------------------------*/

        /* Command or edit modes */

        .jp-Notebook .jp-Cell:not(.jp-mod-active) .jp-InputPrompt {
            opacity: var(--jp-cell-prompt-not-active-opacity);
            color: var(--jp-cell-prompt-not-active-font-color);
        }

        .jp-Notebook .jp-Cell:not(.jp-mod-active) .jp-OutputPrompt {
            opacity: var(--jp-cell-prompt-not-active-opacity);
            color: var(--jp-cell-prompt-not-active-font-color);
        }

        /* cell is active */
        .jp-Notebook .jp-Cell.jp-mod-active .jp-Collapser {
            background: var(--jp-brand-color1);
        }

        /* cell is dirty */
        .jp-Notebook .jp-Cell.jp-mod-dirty .jp-InputPrompt {
            color: var(--jp-warn-color1);
        }

        .jp-Notebook .jp-Cell.jp-mod-dirty .jp-InputPrompt::before {
            color: var(--jp-warn-color1);
            content: 'â¢';
        }

        .jp-Notebook .jp-Cell.jp-mod-active.jp-mod-dirty .jp-Collapser {
            background: var(--jp-warn-color1);
        }

        /* collapser is hovered */
        .jp-Notebook .jp-Cell .jp-Collapser:hover {
            box-shadow: var(--jp-elevation-z2);
            background: var(--jp-brand-color1);
            opacity: var(--jp-cell-collapser-not-active-hover-opacity);
        }

        /* cell is active and collapser is hovered */
        .jp-Notebook .jp-Cell.jp-mod-active .jp-Collapser:hover {
            background: var(--jp-brand-color0);
            opacity: 1;
        }

        /* Command mode */

        .jp-Notebook.jp-mod-commandMode .jp-Cell.jp-mod-selected {
            background: var(--jp-notebook-multiselected-color);
        }

        .jp-Notebook.jp-mod-commandMode .jp-Cell.jp-mod-active.jp-mod-selected:not(.jp-mod-multiSelected) {
            background: transparent;
        }

        /* Edit mode */

        .jp-Notebook.jp-mod-editMode .jp-Cell.jp-mod-active .jp-InputArea-editor {
            border: var(--jp-border-width) solid var(--jp-cell-editor-active-border-color);
            box-shadow: var(--jp-input-box-shadow);
            background-color: var(--jp-cell-editor-active-background);
        }

        /*-----------------------------------------------------------------------------
| Notebook drag and drop
|----------------------------------------------------------------------------*/

        .jp-Notebook-cell.jp-mod-dropSource {
            opacity: 0.5;
        }

        .jp-Notebook-cell.jp-mod-dropTarget,
        .jp-Notebook.jp-mod-commandMode .jp-Notebook-cell.jp-mod-active.jp-mod-selected.jp-mod-dropTarget {
            border-top-color: var(--jp-private-notebook-selected-color);
            border-top-style: solid;
            border-top-width: 2px;
        }

        .jp-dragImage {
            display: block;
            flex-direction: row;
            width: var(--jp-private-notebook-dragImage-width);
            height: var(--jp-private-notebook-dragImage-height);
            border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
            background: var(--jp-cell-editor-background);
            overflow: visible;
        }

        .jp-dragImage-singlePrompt {
            box-shadow: 2px 2px 4px 0 rgba(0, 0, 0, 0.12);
        }

        .jp-dragImage .jp-dragImage-content {
            flex: 1 1 auto;
            z-index: 2;
            font-size: var(--jp-code-font-size);
            font-family: var(--jp-code-font-family);
            line-height: var(--jp-code-line-height);
            padding: var(--jp-code-padding);
            border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
            background: var(--jp-cell-editor-background-color);
            color: var(--jp-content-font-color3);
            text-align: left;
            margin: 4px 4px 4px 0;
        }

        .jp-dragImage .jp-dragImage-prompt {
            flex: 0 0 auto;
            min-width: 36px;
            color: var(--jp-cell-inprompt-font-color);
            padding: var(--jp-code-padding);
            padding-left: 12px;
            font-family: var(--jp-cell-prompt-font-family);
            letter-spacing: var(--jp-cell-prompt-letter-spacing);
            line-height: 1.9;
            font-size: var(--jp-code-font-size);
            border: var(--jp-border-width) solid transparent;
        }

        .jp-dragImage-multipleBack {
            z-index: -1;
            position: absolute;
            height: 32px;
            width: 300px;
            top: 8px;
            left: 8px;
            background: var(--jp-layout-color2);
            border: var(--jp-border-width) solid var(--jp-input-border-color);
            box-shadow: 2px 2px 4px 0 rgba(0, 0, 0, 0.12);
        }

        /*-----------------------------------------------------------------------------
| Cell toolbar
|----------------------------------------------------------------------------*/

        .jp-NotebookTools {
            display: block;
            min-width: var(--jp-sidebar-min-width);
            color: var(--jp-ui-font-color1);
            background: var(--jp-layout-color1);

            /* This is needed so that all font sizing of children done in ems is
    * relative to this base size */
            font-size: var(--jp-ui-font-size1);
            overflow: auto;
        }

        .jp-ActiveCellTool {
            padding: 12px 0;
            display: flex;
        }

        .jp-ActiveCellTool-Content {
            flex: 1 1 auto;
        }

        .jp-ActiveCellTool .jp-ActiveCellTool-CellContent {
            background: var(--jp-cell-editor-background);
            border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
            border-radius: 0;
            min-height: 29px;
        }

        .jp-ActiveCellTool .jp-InputPrompt {
            min-width: calc(var(--jp-cell-prompt-width) * 0.75);
        }

        .jp-ActiveCellTool-CellContent>pre {
            padding: 5px 4px;
            margin: 0;
            white-space: normal;
        }

        .jp-MetadataEditorTool {
            flex-direction: column;
            padding: 12px 0;
        }

        .jp-RankedPanel> :not(:first-child) {
            margin-top: 12px;
        }

        .jp-KeySelector select.jp-mod-styled {
            font-size: var(--jp-ui-font-size1);
            color: var(--jp-ui-font-color0);
            border: var(--jp-border-width) solid var(--jp-border-color1);
        }

        .jp-KeySelector label,
        .jp-MetadataEditorTool label,
        .jp-NumberSetter label {
            line-height: 1.4;
        }

        .jp-NotebookTools .jp-select-wrapper {
            margin-top: 4px;
            margin-bottom: 0;
        }

        .jp-NumberSetter input {
            width: 100%;
            margin-top: 4px;
        }

        .jp-NotebookTools .jp-Collapse {
            margin-top: 16px;
        }

        /*-----------------------------------------------------------------------------
| Presentation Mode (.jp-mod-presentationMode)
|----------------------------------------------------------------------------*/

        .jp-mod-presentationMode .jp-Notebook {
            --jp-content-font-size1: var(--jp-content-presentation-font-size1);
            --jp-code-font-size: var(--jp-code-presentation-font-size);
        }

        .jp-mod-presentationMode .jp-Notebook .jp-Cell .jp-InputPrompt,
        .jp-mod-presentationMode .jp-Notebook .jp-Cell .jp-OutputPrompt {
            flex: 0 0 110px;
        }

        /*-----------------------------------------------------------------------------
| Side-by-side Mode (.jp-mod-sideBySide)
|----------------------------------------------------------------------------*/
        .jp-mod-sideBySide.jp-Notebook .jp-Notebook-cell {
            margin-top: 3em;
            margin-bottom: 3em;
            margin-left: 5%;
            margin-right: 5%;
        }

        .jp-mod-sideBySide.jp-Notebook .jp-CodeCell {
            display: grid;
            grid-template-columns: minmax(0, 1fr) min-content minmax(0,
                    var(--jp-side-by-side-output-size));
            grid-template-rows: auto minmax(0, 1fr) auto;
            grid-template-areas:
                'header header header'
                'input handle output'
                'footer footer footer';
        }

        .jp-mod-sideBySide.jp-Notebook .jp-CodeCell.jp-mod-resizedCell {
            grid-template-columns: minmax(0, 1fr) min-content minmax(0,
                    var(--jp-side-by-side-resized-cell));
        }

        .jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellHeader {
            grid-area: header;
        }

        .jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-Cell-inputWrapper {
            grid-area: input;
        }

        .jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-Cell-outputWrapper {
            /* overwrite the default margin (no vertical separation needed in side by side move */
            margin-top: 0;
            grid-area: output;
        }

        .jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellFooter {
            grid-area: footer;
        }

        .jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellResizeHandle {
            grid-area: handle;
            user-select: none;
            display: block;
            height: 100%;
            cursor: ew-resize;
            padding: 0 var(--jp-cell-padding);
        }

        .jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellResizeHandle::after {
            content: '';
            display: block;
            background: var(--jp-border-color2);
            height: 100%;
            width: 5px;
        }

        .jp-mod-sideBySide.jp-Notebook .jp-CodeCell.jp-mod-resizedCell .jp-CellResizeHandle::after {
            background: var(--jp-border-color0);
        }

        .jp-CellResizeHandle {
            display: none;
        }

        /*-----------------------------------------------------------------------------
| Placeholder
|----------------------------------------------------------------------------*/

        .jp-Cell-Placeholder {
            padding-left: 55px;
        }

        .jp-Cell-Placeholder-wrapper {
            background: #fff;
            border: 1px solid;
            border-color: #e5e6e9 #dfe0e4 #d0d1d5;
            border-radius: 4px;
            -webkit-border-radius: 4px;
            margin: 10px 15px;
        }

        .jp-Cell-Placeholder-wrapper-inner {
            padding: 15px;
            position: relative;
        }

        .jp-Cell-Placeholder-wrapper-body {
            background-repeat: repeat;
            background-size: 50% auto;
        }

        .jp-Cell-Placeholder-wrapper-body div {
            background: #f6f7f8;
            background-image: -webkit-linear-gradient(left,
                    #f6f7f8 0%,
                    #edeef1 20%,
                    #f6f7f8 40%,
                    #f6f7f8 100%);
            background-repeat: no-repeat;
            background-size: 800px 104px;
            height: 104px;
            position: absolute;
            right: 15px;
            left: 15px;
            top: 15px;
        }

        div.jp-Cell-Placeholder-h1 {
            top: 20px;
            height: 20px;
            left: 15px;
            width: 150px;
        }

        div.jp-Cell-Placeholder-h2 {
            left: 15px;
            top: 50px;
            height: 10px;
            width: 100px;
        }

        div.jp-Cell-Placeholder-content-1,
        div.jp-Cell-Placeholder-content-2,
        div.jp-Cell-Placeholder-content-3 {
            left: 15px;
            right: 15px;
            height: 10px;
        }

        div.jp-Cell-Placeholder-content-1 {
            top: 100px;
        }

        div.jp-Cell-Placeholder-content-2 {
            top: 120px;
        }

        div.jp-Cell-Placeholder-content-3 {
            top: 140px;
        }
    </style>
    <style type="text/css">
        /*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

        /*
The following CSS variables define the main, public API for styling JupyterLab.
These variables should be used by all plugins wherever possible. In other
words, plugins should not define custom colors, sizes, etc unless absolutely
necessary. This enables users to change the visual theme of JupyterLab
by changing these variables.

Many variables appear in an ordered sequence (0,1,2,3). These sequences
are designed to work well together, so for example, `--jp-border-color1` should
be used with `--jp-layout-color1`. The numbers have the following meanings:

* 0: super-primary, reserved for special emphasis
* 1: primary, most important under normal situations
* 2: secondary, next most important under normal situations
* 3: tertiary, next most important under normal situations

Throughout JupyterLab, we are mostly following principles from Google's
Material Design when selecting colors. We are not, however, following
all of MD as it is not optimized for dense, information rich UIs.
*/
    </style>
    <style type="text/css">
        /* Force rendering true colors when outputing to pdf */
        * {
            -webkit-print-color-adjust: exact;
        }

        /* Misc */
        a.anchor-link {
            display: none;
        }

        /* Input area styling */
        .jp-InputArea {
            overflow: hidden;
        }

        .jp-InputArea-editor {
            overflow: hidden;
        }

        .cm-editor.cm-s-jupyter .highlight pre {
            /* weird, but --jp-code-padding defined to be 5px but 4px horizontal padding is hardcoded for pre.cm-line */
            padding: var(--jp-code-padding) 4px;
            margin: 0;

            font-family: inherit;
            font-size: inherit;
            line-height: inherit;
            color: inherit;

        }

        .jp-OutputArea-output pre {
            line-height: inherit;
            font-family: inherit;
        }

        .jp-RenderedText pre {
            color: var(--jp-content-font-color1);
            font-size: var(--jp-code-font-size);
        }

        /* Hiding the collapser by default */
        .jp-Collapser {
            display: none;
        }

        @page {
            margin: 0.5in;
            /* Margin for each printed piece of paper */
        }

        @media print {

            .jp-Cell-inputWrapper,
            .jp-Cell-outputWrapper {
                display: block;
            }
        }
    </style>
    <!-- Load mathjax -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
    <!-- End of mathjax configuration -->
    <script type="module">
        document.addEventListener("DOMContentLoaded", async () => {
            const diagrams = document.querySelectorAll(".jp-Mermaid > pre.mermaid");
            // do not load mermaidjs if not needed
            if (!diagrams.length) {
                return;
            }
            const mermaid = (await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs")).default;
            const parser = new DOMParser();

            mermaid.initialize({
                maxTextSize: 100000,
                maxEdges: 100000,
                startOnLoad: false,
                fontFamily: window
                    .getComputedStyle(document.body)
                    .getPropertyValue("--jp-ui-font-family"),
                theme: document.querySelector("body[data-jp-theme-light='true']")
                    ? "default"
                    : "dark",
            });

            let _nextMermaidId = 0;

            function makeMermaidImage(svg) {
                const img = document.createElement("img");
                const doc = parser.parseFromString(svg, "image/svg+xml");
                const svgEl = doc.querySelector("svg");
                const { maxWidth } = svgEl?.style || {};
                const firstTitle = doc.querySelector("title");
                const firstDesc = doc.querySelector("desc");

                img.setAttribute("src", `data:image/svg+xml,${encodeURIComponent(svg)}`);
                if (maxWidth) {
                    img.width = parseInt(maxWidth);
                }
                if (firstTitle) {
                    img.setAttribute("alt", firstTitle.textContent);
                }
                if (firstDesc) {
                    const caption = document.createElement("figcaption");
                    caption.className = "sr-only";
                    caption.textContent = firstDesc.textContent;
                    return [img, caption];
                }
                return [img];
            }

            async function makeMermaidError(text) {
                let errorMessage = "";
                try {
                    await mermaid.parse(text);
                } catch (err) {
                    errorMessage = `${err}`;
                }

                const result = document.createElement("details");
                result.className = 'jp-RenderedMermaid-Details';
                const summary = document.createElement("summary");
                summary.className = 'jp-RenderedMermaid-Summary';
                const pre = document.createElement("pre");
                const code = document.createElement("code");
                code.innerText = text;
                pre.appendChild(code);
                summary.appendChild(pre);
                result.appendChild(summary);

                const warning = document.createElement("pre");
                warning.innerText = errorMessage;
                result.appendChild(warning);
                return [result];
            }

            async function renderOneMarmaid(src) {
                const id = `jp-mermaid-${_nextMermaidId++}`;
                const parent = src.parentNode;
                let raw = src.textContent.trim();
                const el = document.createElement("div");
                el.style.visibility = "hidden";
                document.body.appendChild(el);
                let results = null;
                let output = null;
                try {
                    let { svg } = await mermaid.render(id, raw, el);
                    svg = cleanMermaidSvg(svg);
                    results = makeMermaidImage(svg);
                    output = document.createElement("figure");
                    results.map(output.appendChild, output);
                } catch (err) {
                    parent.classList.add("jp-mod-warning");
                    results = await makeMermaidError(raw);
                    output = results[0];
                } finally {
                    el.remove();
                }
                parent.classList.add("jp-RenderedMermaid");
                parent.appendChild(output);
            }


            /**
             * Post-process to ensure mermaid diagrams contain only valid SVG and XHTML.
             */
            function cleanMermaidSvg(svg) {
                return svg.replace(RE_VOID_ELEMENT, replaceVoidElement);
            }


            /**
             * A regular expression for all void elements, which may include attributes and
             * a slash.
             *
             * @see https://developer.mozilla.org/en-US/docs/Glossary/Void_element
             *
             * Of these, only `<br>` is generated by Mermaid in place of `\n`,
             * but _any_ "malformed" tag will break the SVG rendering entirely.
             */
            const RE_VOID_ELEMENT =
                /<\s*(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)\s*([^>]*?)\s*>/gi;

            /**
             * Ensure a void element is closed with a slash, preserving any attributes.
             */
            function replaceVoidElement(match, tag, rest) {
                rest = rest.trim();
                if (!rest.endsWith('/')) {
                    rest = `${rest} /`;
                }
                return `<${tag} ${rest}>`;
            }

            void Promise.all([...diagrams].map(renderOneMarmaid));
        });
    </script>
    <style>
        .jp-Mermaid:not(.jp-RenderedMermaid) {
            display: none;
        }

        .jp-RenderedMermaid {
            overflow: auto;
            display: flex;
        }

        .jp-RenderedMermaid.jp-mod-warning {
            width: auto;
            padding: 0.5em;
            margin-top: 0.5em;
            border: var(--jp-border-width) solid var(--jp-warn-color2);
            border-radius: var(--jp-border-radius);
            color: var(--jp-ui-font-color1);
            font-size: var(--jp-ui-font-size1);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .jp-RenderedMermaid figure {
            margin: 0;
            overflow: auto;
            max-width: 100%;
        }

        .jp-RenderedMermaid img {
            max-width: 100%;
        }

        .jp-RenderedMermaid-Details>pre {
            margin-top: 1em;
        }

        .jp-RenderedMermaid-Summary {
            color: var(--jp-warn-color2);
        }

        .jp-RenderedMermaid:not(.jp-mod-warning) pre {
            display: none;
        }

        .jp-RenderedMermaid-Summary>pre {
            display: inline-block;
            white-space: normal;
        }
    </style>
    <!-- End of mermaid configuration -->

    <!-- Chapter Navigation Styling -->
    <style>
        .chapter-header {
            background: linear-gradient(135deg, #fafbff 0%, #f0f4ff 100%);
            border-bottom: 1px solid #e2e8f0;
            padding: 1.5rem 2rem;
            margin-bottom: 2rem;
        }
        .chapter-header-inner {
            max-width: 1200px;
            margin: 0 auto;
        }
        .chapter-back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: #64748b;
            text-decoration: none;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            transition: color 0.2s ease;
            font-family: system-ui, -apple-system, sans-serif;
        }
        .chapter-back-link:hover {
            color: #0d9488;
        }
        .chapter-meta {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 1rem;
            margin-bottom: 0.75rem;
        }
        .chapter-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            background: #ecfdf5;
            color: #0d9488;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            border: 1px solid #6ee7b7;
            font-family: system-ui, -apple-system, sans-serif;
        }
        .chapter-badge-dot {
            width: 6px;
            height: 6px;
            background: #14b8a6;
            border-radius: 50%;
        }
        .chapter-number {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            font-family: system-ui, -apple-system, sans-serif;
        }
        .chapter-title-section h1 {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1e293b;
            margin: 0 0 0.5rem 0;
            font-family: system-ui, -apple-system, sans-serif;
            letter-spacing: -0.02em;
        }
        .chapter-author {
            color: #64748b;
            font-size: 0.95rem;
            font-family: system-ui, -apple-system, sans-serif;
        }
        .chapter-author strong {
            color: #1e293b;
        }

        /* Footer Navigation */
        .chapter-footer {
            background: linear-gradient(135deg, #fafbff 0%, #f0f4ff 100%);
            border-top: 1px solid #e2e8f0;
            padding: 2rem;
            margin-top: 3rem;
            font-family: system-ui, -apple-system, sans-serif;
        }
        .chapter-footer-inner {
            max-width: 1200px;
            margin: 0 auto;
        }
        .chapter-nav {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .chapter-nav-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem 1.5rem;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            text-decoration: none;
            color: #1e293b;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.08);
            min-width: 200px;
        }
        .chapter-nav-btn:hover {
            border-color: #14b8a6;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.12);
            transform: translateY(-2px);
        }
        .chapter-nav-btn.disabled {
            opacity: 0.5;
            pointer-events: none;
        }
        .chapter-nav-btn .nav-direction {
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .chapter-nav-btn .nav-title {
            font-weight: 600;
            color: #1e293b;
        }
        .chapter-nav-btn:hover .nav-title {
            color: #0d9488;
        }
        .nav-arrow {
            width: 24px;
            height: 24px;
            color: #14b8a6;
        }

        /* Acknowledgement */
        .chapter-acknowledgement {
            background: linear-gradient(135deg, #ecfdf5, #f0fdfa);
            border-radius: 16px;
            border: 1px solid #6ee7b7;
            padding: 1.75rem;
            margin-top: 1.5rem;
        }
        .chapter-acknowledgement-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        .chapter-acknowledgement-icon {
            width: 32px;
            height: 32px;
            background: #14b8a6;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        .chapter-acknowledgement h3 {
            color: #0d9488;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 0;
        }
        .chapter-acknowledgement p {
            color: #1e293b;
            font-size: 0.95rem;
            line-height: 1.7;
            margin: 0;
        }
        .chapter-acknowledgement a {
            color: #0d9488;
            text-decoration: none;
            font-weight: 500;
        }
        .chapter-acknowledgement a:hover {
            text-decoration: underline;
        }

        @media (max-width: 640px) {
            .chapter-header {
                padding: 1rem;
            }
            .chapter-title-section h1 {
                font-size: 1.35rem;
            }
            .chapter-nav {
                flex-direction: column;
            }
            .chapter-nav-btn {
                min-width: 100%;
            }
        }
    </style>
</head>

<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
    <!-- Interactive Table of Contents -->
    <div id="toc-container"
        style="position: fixed; top: 0; left: -320px; width: 320px; height: 100vh; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; overflow-y: auto; z-index: 10000; box-shadow: 4px 0 10px rgba(0,0,0,0.3); transition: left 0.3s ease-in-out; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
        <div
            style="position: sticky; top: 0; background: rgba(0,0,0,0.2); padding: 20px; backdrop-filter: blur(10px); z-index: 10;">
            <h2 style="margin: 0; font-size: 24px; font-weight: 600;">PyTorch Basics</h2>
            <p style="margin: 5px 0 0 0; font-size: 14px; opacity: 0.9;">Interactive Guide</p>
        </div>
        <nav style="padding: 20px; padding-bottom: 50px;">
            <div style="margin-bottom: 20px;">
                <h3
                    style="font-size: 14px; margin: 15px 0 10px 0; opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; font-weight: 500;">
                    Core Concepts</h3>
                <a href="#Transpose----.T"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Transpose
                    Operations</a>
                <a href="#Matrix-multiplication----.matmul()"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Matrix
                    Multiplication</a>
                <a href="#A-logistic-regression-forward-pass"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Logistic
                    Regression</a>
                <a href="#Computing-gradients-via-autograd"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Gradients
                    (Autograd)</a>
            </div>

            <div style="margin-bottom: 20px;">
                <h3
                    style="font-size: 14px; margin: 15px 0 10px 0; opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; font-weight: 500;">
                    Model Building</h3>
                <a href="#Total-number-of-trainable-parameters-of-this-model"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Trainable
                    Parameters</a>
                <a href="#Weight-of-layers"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Layer
                    Weights</a>
            </div>

            <div style="margin-bottom: 20px;">
                <h3
                    style="font-size: 14px; margin: 15px 0 10px 0; opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; font-weight: 500;">
                    Data Handling</h3>
                <a href="javascript:void(0);" onclick="scrollToSection('Explanation of the Dataset')"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Dataset
                    Creation</a>
                <a href="javascript:void(0);" onclick="scrollToSection('Explanation of the DataLoader')"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">DataLoader
                    Setup</a>
            </div>

            <div style="margin-bottom: 20px;">
                <h3
                    style="font-size: 14px; margin: 15px 0 10px 0; opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; font-weight: 500;">
                    Training</h3>
                <a href="#A-typical-training-loop"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Training
                    Loop Basics</a>
                <a href="javascript:void(0);" onclick="scrollToSection('Explanation of the Training Loop')"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Detailed
                    Training Loop</a>
            </div>

            <div style="margin-bottom: 20px;">
                <h3
                    style="font-size: 14px; margin: 15px 0 10px 0; opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; font-weight: 500;">
                    Predictions & Inference</h3>
                <a href="#Making-Predictions"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Making
                    Predictions</a>
                <a href="javascript:void(0);" onclick="scrollToSection('Converting Model Outputs to Probabilities')"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Softmax
                    (Probabilities)</a>
                <a href="javascript:void(0);" onclick="scrollToSection('Converting Probabilities to Class')"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Argmax
                    (Class Labels)</a>
                <a href="javascript:void(0);" onclick="scrollToSection('Evaluating Model Predictions')"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Model
                    Evaluation</a>
            </div>

            <div style="margin-bottom: 20px;">
                <h3
                    style="font-size: 14px; margin: 15px 0 10px 0; opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; font-weight: 500;">
                    Model Persistence</h3>
                <a href="#Saving-and-Loading-Models"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Saving
                    & Loading</a>
                <a href="javascript:void(0);" onclick="scrollToSection('Mounting Google Drive')"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Google
                    Drive Mount</a>
                <a href="javascript:void(0);" onclick="scrollToSection('Loading a Saved Model')"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Loading
                    Models</a>
            </div>

            <div style="margin-bottom: 20px;">
                <h3
                    style="font-size: 14px; margin: 15px 0 10px 0; opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; font-weight: 500;">
                    GPU Training</h3>
                <a href="#Optimizing-training-performance-with-GPUs"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">GPU
                    Optimization</a>
                <a href="#Single-GPU-training"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Single-GPU
                    Training</a>
                <a href="javascript:void(0);" onclick="scrollToSection('Flexible Device Management')"
                    style="display: block; color: white; text-decoration: none; padding: 10px 15px; margin: 5px 0; border-radius: 6px; transition: all 0.2s ease; font-size: 14px; background: rgba(255, 255, 255, 0.1);">Device
                    Management</a>
            </div>
        </nav>
    </div>

    <!-- Overlay -->
    <div id="toc-overlay"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 9999; display: none; opacity: 0; transition: opacity 0.3s ease;">
    </div>

    <!-- Toggle Button -->
    <button id="toc-toggle"
        style="position: fixed; top: 20px; left: 20px; z-index: 10001; background: rgba(102, 126, 234, 0.15); backdrop-filter: blur(10px); color: rgba(102, 126, 234, 0.8); border: 2px solid rgba(102, 126, 234, 0.3); padding: 12px 16px; border-radius: 8px; cursor: pointer; font-size: 16px; box-shadow: 0 2px 10px rgba(102, 126, 234, 0.1); transition: all 0.3s ease; font-weight: 600; user-select: none;">
        â° Contents
    </button>

    <!-- Minimal inline styles -->
    <style>
        #toc-toggle:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            color: white !important;
            border-color: transparent !important;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        #toc-container.toc-open {
            left: 0 !important;
        }

        #toc-overlay.show {
            display: block !important;
            opacity: 1 !important;
        }

        #toc-container a:hover {
            background: rgba(255, 255, 255, 0.25) !important;
            transform: translateX(5px);
        }

        #toc-container::-webkit-scrollbar {
            width: 8px;
        }

        #toc-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }

        #toc-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }

        @media (max-width: 768px) {
            #toc-container {
                width: 280px !important;
                left: -280px !important;
            }
        }
    </style>

    <!-- Simplified JavaScript -->
    <script>
        (function () {
            'use strict';

            window.addEventListener('load', function () {
                const tocContainer = document.getElementById('toc-container');
                const tocToggle = document.getElementById('toc-toggle');
                const tocOverlay = document.getElementById('toc-overlay');

                if (!tocContainer || !tocToggle || !tocOverlay) return;

                // Toggle TOC
                tocToggle.addEventListener('click', function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const isOpen = tocContainer.classList.contains('toc-open');

                    if (isOpen) {
                        tocContainer.classList.remove('toc-open');
                        tocOverlay.classList.remove('show');
                        tocToggle.textContent = 'â° Contents';
                    } else {
                        tocContainer.classList.add('toc-open');
                        tocOverlay.classList.add('show');
                        tocToggle.textContent = 'â Close';
                    }
                });

                // Close on overlay click
                tocOverlay.addEventListener('click', function () {
                    tocContainer.classList.remove('toc-open');
                    tocOverlay.classList.remove('show');
                    tocToggle.textContent = 'â° Contents';
                });

                // Close on link click
                const links = tocContainer.querySelectorAll('a');
                links.forEach(function (link) {
                    link.addEventListener('click', function () {
                        setTimeout(function () {
                            tocContainer.classList.remove('toc-open');
                            tocOverlay.classList.remove('show');
                            tocToggle.textContent = 'â° Contents';
                        }, 300);
                    });
                });
            });

            // Custom scroll function
            window.scrollToSection = function (keyword) {
                const headings = document.querySelectorAll('h4, h3');
                for (let i = 0; i < headings.length; i++) {
                    if (headings[i].textContent.indexOf(keyword) !== -1) {
                        headings[i].scrollIntoView({ behavior: 'smooth', block: 'start' });
                        break;
                    }
                }
            };
        })();
    </script>

    <!-- New Chapter Header -->
<div class="font-display">
<header class="sticky top-0 z-50 w-full bg-white/80 backdrop-blur-md border-b border-[#ece7f3]">
<div class="max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8">
<div class="flex items-center justify-between h-16">
<div class="flex items-center gap-4">
<div class="flex items-center gap-3 text-text-main">
<div class="size-8 text-primary flex items-center justify-center bg-primary/10 rounded-lg">
<span class="material-symbols-outlined text-[24px]">menu_book</span>
</div>
<h2 class="text-lg font-bold leading-tight tracking-[-0.015em] hidden sm:block">LLM From Scratch</h2>
</div>
<nav class="hidden md:flex items-center gap-6 ml-6 border-l border-gray-200 pl-6 h-6">
<a class="text-text-main hover:text-primary transition-colors text-sm font-medium" href="/books/llm-from-scratch">All Chapters</a>
</nav>
</div>
</div>
</div>
</header>
<div class="flex items-center justify-center p-4 sm:p-6 md:p-8">
<div class="w-full max-w-6xl">
<div class="bg-card-light rounded-2xl shadow-purple-glow border border-white/50 relative overflow-hidden">
<div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-primary to-transparent opacity-50"></div>
<div class="px-6 py-10 md:px-12 md:py-12 text-center">
<div class="flex flex-wrap justify-center items-center gap-3 mb-6">
<div></div>
<div class="px-4 py-1.5 rounded-full bg-primary/10 text-primary text-xs font-bold uppercase tracking-wider">
Appendix
</div>
<a class="group flex items-center gap-1.5 px-4 py-1.5 rounded-full bg-slate-100 text-text-main text-xs font-medium hover:bg-slate-200 transition-colors" href="chapter_2.html">
Next
<span class="material-symbols-outlined text-[16px] group-hover:translate-x-0.5 transition-transform">arrow_forward</span>
</a>
</div>
<h1 class="text-3xl md:text-4xl lg:text-5xl font-black text-text-main leading-[1.1] tracking-tight mb-5">
PyTorch Basics
</h1>
<div class="flex flex-col sm:flex-row items-center justify-center gap-4 text-text-muted text-sm font-medium mb-8">
<div class="flex items-center gap-1.5">
<span class="material-symbols-outlined text-[18px]">person</span>
Notes by Shammunul Islam
</div>
</div>
<div class="max-w-2xl mx-auto mb-8 bg-primary/5 rounded-xl p-5 border border-primary/10 relative overflow-hidden">
<div class="flex flex-col gap-2 relative z-10">
<h3 class="text-xs font-bold text-primary uppercase tracking-wider flex items-center justify-center gap-1.5">
<span class="material-symbols-outlined text-[16px]">handshake</span>
Acknowledgements
</h3>
<p class="text-sm text-text-muted leading-relaxed">
Based on <span class="font-semibold text-text-main">"Build a Large Language Model (From Scratch)"</span> by Sebastian Raschka, published by Manning Publications.
</p>
</div>
</div>
<div class="flex flex-col sm:flex-row items-center justify-center gap-4 w-full max-w-md mx-auto">
<a href="https://colab.research.google.com/drive/1kV5HanjXKJYm7liCDAhXLQ8sWS7KGgh3" target="_blank" rel="noopener noreferrer" class="w-full sm:w-auto flex items-center justify-center gap-2 h-11 px-8 bg-white border border-gray-200 hover:border-primary/50 hover:bg-primary/5 text-text-main rounded-lg text-sm font-medium transition-all duration-200 group shadow-sm">
<img alt="Google Colab Logo" class="w-5 h-5 opacity-80 group-hover:opacity-100 grayscale group-hover:grayscale-0 transition-all" src="https://colab.research.google.com/img/colab_favicon_256px.png"/>
Open in Colab
</a>
</div>
</div>
<div class="bg-gray-50 border-t border-gray-100 px-6 py-4 flex justify-center">
<div class="flex items-center gap-6 text-xs text-text-muted font-medium">
<span class="flex items-center gap-1">
<span class="material-symbols-outlined text-[16px]">bar_chart</span>
Beginner Level
</span>
<span class="flex items-center gap-1">
<span class="material-symbols-outlined text-[16px]">code</span>
Python &amp; PyTorch
</span>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- End New Chapter Header -->

        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h1 id="Basics-of-PyTorch">Basics of PyTorch<a class="anchor-link"
                                href="#Basics-of-PyTorch">Â¶</a></h1>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>2.5.1+cu121
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child jp-OutputArea-executeResult">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[Â ]:</div>
                        <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult"
                            data-mime-type="text/plain" tabindex="0">
                            <pre>True</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h2 id="Understanding-tensors">Understanding tensors<a class="anchor-link"
                                href="#Understanding-tensors">Â¶</a></h2>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Tensor Visualization -->
        <div style="margin: 2rem 0; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(99, 102, 241, 0.15); width: 100%; max-width: 100%; box-sizing: border-box;">
            <iframe id="tensor-viz-iframe" src="1.html" style="width: 100%; min-height: 1100px; border: none; display: block; margin: 0; padding: 0;" title="Interactive Tensor Visualization" onload="this.style.height = this.contentWindow.document.body.scrollHeight + 'px';"></iframe>
        </div>

        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># 0D Tensor (Scalar): A single value with no dimensions</span>
<span class="c1"># Shape: torch.Size([]) - empty, just one number</span>
<span class="n">tensor0d</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 1D Tensor (Vector): A sequence of values along one axis</span>
<span class="c1"># Shape: torch.Size([3]) - 3 elements along dimension 0</span>
<span class="n">tensor1d</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="c1"># 2D Tensor (Matrix): Data organized in rows and columns</span>
<span class="c1"># Shape: torch.Size([2, 3]) - 2 rows x 3 columns = 6 elements</span>
<span class="n">tensor2d</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>

<span class="c1"># 3D Tensor: A stack of matrices (like multiple 2D slices)</span>
<span class="c1"># Shape: torch.Size([2, 3, 4]) - 2 slices x 3 rows x 4 columns = 24 elements</span>
<span class="c1"># Common in deep learning: [batch_size, sequence_length, features]</span>
<span class="n">tensor3d</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span>   <span class="c1"># First slice [0]</span>
                         <span class="p">[[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]]])</span>  <span class="c1"># Second slice [1]</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Shape of tensor2d:"</span><span class="p">,</span> <span class="n">tensor2d</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>Shape of tensor2d: torch.Size([2, 3])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Shape of tensor3d:"</span><span class="p">,</span> <span class="n">tensor3d</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>Shape of tensor3d: torch.Size([2, 3, 4])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tensor0d</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>torch.int64
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tensor1d</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>torch.int64
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tensor3d</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>torch.int64
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>PyTorch defaults to 32-bit precision whenever you construct a tensor from Python
                            <strong>float</strong>
                            values.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">floatvec</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">floatvec</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>torch.float32
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>While higher precision formats exist (like 64-bit), 32-bit floating-point numbers handle the
                            numerical
                            demands of most neural network computations without issue. We can change the precision using
                            a tensorâs
                            <strong>.to</strong> method.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">floatvec</span> <span class="o">=</span> <span class="n">tensor1d</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">floatvec</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>torch.float32
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h2 id="Common-PyTorch-tensor-operations">Common PyTorch tensor operations<a class="anchor-link"
                                href="#Common-PyTorch-tensor-operations">Â¶</a></h2>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Tensor Operations Visualization -->
        <div style="margin: 2rem 0; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(99, 102, 241, 0.15); width: 100%; max-width: 100%; box-sizing: border-box;">
            <iframe src="2.html" style="width: 100%; min-height: 1100px; border: none; display: block; margin: 0; padding: 0;" title="Interactive Tensor Operations Visualization" onload="this.style.height = this.contentWindow.document.body.scrollHeight + 'px';"></iframe>
        </div>

        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tensor2d</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[1, 2, 3],
        [3, 4, 5]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>We can reshape the tensor into a 3 Ã 2 tensor.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tensor2d</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[1, 2],
        [3, 3],
        [4, 5]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>More common method for reshaping in PyTorch is <strong>.view()</strong>.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tensor2d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[1, 2],
        [3, 3],
        [4, 5]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>To use <strong>.view()</strong> the original data to be contiguous. But,
                            <strong>.reshape()</strong>
                            works regardless and copies the data
                            if necessary to ensure the desired shape.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="Transpose----.T">Transpose -- .T<a class="anchor-link" href="#Transpose----.T">Â¶</a>
                        </h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tensor2d</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[1, 2, 3],
        [3, 4, 5]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tensor2d</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>torch.Size([2, 3])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tensor2d</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[1, 3],
        [2, 4],
        [3, 5]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tensor2d</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>torch.Size([2, 3])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>This command <strong>.T</strong> gives transpose matrix but does npt change the original
                            matrix unless
                            you save it to the original.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Matrix Multiplication Section -->
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h2 id="Matrix-Multiplication">Matrix Multiplication<a class="anchor-link" href="#Matrix-Multiplication">Â¶</a></h2>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Matrix Multiplication Visualization -->
        <div style="margin: 2rem 0; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(99, 102, 241, 0.15); width: 100%; max-width: 100%; box-sizing: border-box;">
            <iframe src="3.html" style="width: 100%; min-height: 1100px; border: none; display: block; margin: 0; padding: 0;" title="Interactive Matrix Multiplication Visualization" onload="this.style.height = this.contentWindow.document.body.scrollHeight + 'px';"></iframe>
        </div>

        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="Matrix-multiplication----.matmul()">Matrix multiplication -- .matmul()<a
                                class="anchor-link" href="#Matrix-multiplication----.matmul()">Â¶</a></h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tensor2d</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">tensor2d</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[14, 26],
        [26, 50]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="Matrix-multiplication----@">Matrix multiplication -- <strong>@</strong><a
                                class="anchor-link" href="#Matrix-multiplication----@">Â¶</a></h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tensor2d</span> <span class="o">@</span> <span class="n">tensor2d</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[14, 26],
        [26, 50]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h2 id="Computation-Graph">Computation Graph<a class="anchor-link"
                                href="#Computation-Graph">Â¶</a></h2>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Computation Graph Visualization -->
        <div style="margin: 2rem 0; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(99, 102, 241, 0.15); width: 100%; max-width: 100%; box-sizing: border-box;">
            <iframe src="4.html" style="width: 100%; height: 1270px; border: none; display: block; margin: 0; padding: 0; overflow: hidden;" scrolling="no" title="Interactive Computation Graph Visualization"></iframe>
        </div>

        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="A-logistic-regression-forward-pass">A logistic regression forward pass<a
                                class="anchor-link" href="#A-logistic-regression-forward-pass">Â¶</a></h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.1</span><span class="p">])</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.2</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">w1</span> <span class="o">+</span> <span class="n">b</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">binary_cross_entropy</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor(0.0852)
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="Computing-gradients-via-autograd">Computing gradients via autograd<a class="anchor-link"
                                href="#Computing-gradients-via-autograd">Â¶</a></h3>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Autograd Visualization -->
        <div style="margin: 2rem 0; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(99, 102, 241, 0.15); width: 100%; max-width: 100%; box-sizing: border-box;">
            <iframe src="5.html" style="width: 100%; height: 850px; border: none; display: block; margin: 0; padding: 0; overflow: hidden;" scrolling="no" title="Interactive Autograd Visualization"></iframe>
        </div>

        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">from</span> <span class="nn">torch.autograd</span> <span class="kn">import</span> <span class="n">grad</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.1</span><span class="p">])</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.2</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">w1</span> <span class="o">+</span> <span class="n">b</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

<span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">binary_cross_entropy</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">grad_L_w1</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">retain_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">grad_L_b</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">retain_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">grad_L_w1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grad_L_b</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>(tensor([-0.0898]),)
(tensor([-0.0817]),)
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grad_L_w1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grad_L_b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([-0.0898])
tensor([-0.0817])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>In practice, we typically do not use <code>torch.autograd.grad</code> manually. Instead, we
                            call the
                            <strong>.backward()</strong> method on the loss tensor. This triggers the backpropagation
                            algorithm, where
                            PyTorch traverses the computation graph in reverse. It computes the gradients of the loss
                            with respect to
                            all leaf nodes (tensors with <code>requires_grad=True</code>) using the chain rule and
                            stores the results
                            in the <strong>.grad</strong> attribute of each tensor. Note that these gradients are
                            accumulated (added)
                            to any existing values in <code>.grad</code>, which is why we must clear them before each
                            optimization
                            step.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">w1</span><span class="o">.</span><span class="n">grad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">grad</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([-0.0898])
tensor([-0.0817])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h2 id="Implementing-multilayer-neural-networks">Implementing multilayer neural networks<a
                                class="anchor-link" href="#Implementing-multilayer-neural-networks">Â¶</a></h2>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Multilayer Neural Networks Visualization -->
        <div style="margin: 2rem 0; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(99, 102, 241, 0.15); width: 100%; max-width: 100%; box-sizing: border-box;">
            <iframe src="6.html" style="width: 100%; height: 650px; border: none; display: block; margin: 0; padding: 0; overflow: hidden;" scrolling="no" title="Interactive Multilayer Neural Networks Visualization"></iframe>
        </div>

        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="A-multilayer-perceptron-with-two-hidden-layers">A multilayer perceptron with two hidden
                            layers<a class="anchor-link" href="#A-multilayer-perceptron-with-two-hidden-layers">Â¶</a>
                        </h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="k">class</span> <span class="nc">NeuralNetwork</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_inputs</span><span class="p">,</span> <span class="n">num_outputs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="c1"># 1st hidden layer -- 30 nodes in the hidden layer</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>

        <span class="c1"># 2nd hidden layer -- 20 nodes or hidden units</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>

        <span class="c1"># output layer</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">num_outputs</span><span class="p">)</span>
    <span class="p">)</span>

  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">logits</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>Instantiate a new neural network object</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># Number of inputs is 50 and number of outputs is 3</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>NeuralNetwork(
  (layers): Sequential(
    (0): Linear(in_features=50, out_features=30, bias=True)
    (1): ReLU()
    (2): Linear(in_features=30, out_features=20, bias=True)
    (3): ReLU()
    (4): Linear(in_features=20, out_features=3, bias=True)
  )
)
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="Total-number-of-trainable-parameters-of-this-model">Total number of trainable parameters
                            of this
                            model<a class="anchor-link" href="#Total-number-of-trainable-parameters-of-this-model">Â¶</a>
                        </h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">num_params</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">numel</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Total number of trainable parameters:"</span><span class="p">,</span> <span class="n">num_params</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>Total number of trainable parameters: 2213
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="Weight-of-layers">Weight of layers<a class="anchor-link" href="#Weight-of-layers">Â¶</a>
                        </h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4 id="Weight-of-the-first-Linear-layer">Weight of the first Linear layer<a class="anchor-link"
                                href="#Weight-of-the-first-Linear-layer">Â¶</a></h4>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>Parameter containing:
tensor([[ 0.0902, -0.0872, -0.0647,  ...,  0.0258, -0.0511,  0.0559],
        [ 0.0193,  0.0288, -0.0526,  ...,  0.0612,  0.0223, -0.0825],
        [-0.0870, -0.0267, -0.1318,  ...,  0.1013,  0.0416, -0.0316],
        ...,
        [-0.0869,  0.1370, -0.1022,  ...,  0.1283, -0.0957, -0.0624],
        [ 0.0624,  0.0079, -0.0554,  ...,  0.0250, -0.0850, -0.1238],
        [ 0.0598, -0.0201, -0.1021,  ..., -0.0553, -0.0375,  0.0615]],
       requires_grad=True)
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>torch.Size([30, 50])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>To ensure consistent weight initialization across different runs, PyTorch provides
                            <code>torch.manual_seed()</code> which controls the random number generator. By setting a
                            specific seed
                            value (such as 123), the neural network will initialize with identical random weights every
                            time the code
                            executes. This deterministic behavior is essential for validating model implementations,
                            conducting fair
                            performance comparisons, and enabling others to replicate your results exactly.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>Parameter containing:
tensor([[-0.0577,  0.0047, -0.0702,  ...,  0.0222,  0.1260,  0.0865],
        [ 0.0502,  0.0307,  0.0333,  ...,  0.0951,  0.1134, -0.0297],
        [ 0.1077, -0.1108,  0.0122,  ...,  0.0108, -0.1049, -0.1063],
        ...,
        [-0.0787,  0.1259,  0.0803,  ...,  0.1218,  0.1303, -0.1351],
        [ 0.1359,  0.0175, -0.0673,  ...,  0.0674,  0.0676,  0.1058],
        [ 0.0790,  0.1343, -0.0293,  ...,  0.0344, -0.0971, -0.0509]],
       requires_grad=True)
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span> <span class="c1"># tensor of shape (1, 50) where each element is a random number in</span>
<span class="c1"># [0,1)</span>
<span class="c1">#  generates a tensor filled with random values sampled from a uniform distribution</span>
<span class="c1"># [0, 1) -- include 0 but exclude 1</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[-0.1262,  0.1080, -0.1792]], grad_fn=&lt;AddmmBackward0&gt;)
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>The <code>grad_fn=&lt;AddmmBackward0&gt;</code> attribute in the output tensor indicates that
                            PyTorch has
                            attached a reference to the backward function used for automatic differentiation.
                            Specifically,
                            <code>AddmmBackward0</code> refers to the gradient computation function for the "add
                            matrix-matrix"
                            operation, which is the mathematical operation performed by a linear layer:
                            <code>y = xW<sup>T</sup> + b</code> (matrix multiplication followed by bias addition). This
                            attribute
                            serves as a pointer in PyTorch's computational graph, recording how this tensor was created
                            so that
                            gradients can be properly backpropagated during training. The presence of
                            <code>grad_fn</code> confirms
                            that this tensor is part of the computation graph and will participate in gradient
                            calculations when
                            <code>.backward()</code> is called. If we had used <code>torch.no_grad()</code>, this
                            attribute would be
                            absent since gradient tracking would be disabled.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">X</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child jp-OutputArea-executeResult">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[Â ]:</div>
                        <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult"
                            data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[0.2961, 0.5166, 0.2517, 0.6886, 0.0740, 0.8665, 0.1366, 0.1025, 0.1841,
         0.7264, 0.3153, 0.6871, 0.0756, 0.1966, 0.3164, 0.4017, 0.1186, 0.8274,
         0.3821, 0.6605, 0.8536, 0.5932, 0.6367, 0.9826, 0.2745, 0.6584, 0.2775,
         0.8573, 0.8993, 0.0390, 0.9268, 0.7388, 0.7179, 0.7058, 0.9156, 0.4340,
         0.0772, 0.3565, 0.1479, 0.5331, 0.4066, 0.2318, 0.4545, 0.9737, 0.4606,
         0.5159, 0.4220, 0.5786, 0.9455, 0.8057]])</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>In the code above, we created a single training sample X as a demonstration input. This
                            sample is a
                            50-dimensional feature vector that matches our network's expected input size. When we pass
                            this tensor
                            through <code>model(X)</code>, PyTorch automatically invokes the model's
                            <code>forward()</code> method,
                            propagating the input through all layers and returning three output scores (logits)
                            corresponding to our
                            three-class classification problem.
                        </p>

                        <p>During inferenceâwhen making predictions on new data rather than trainingâit's critical to
                            use the
                            <code>torch.no_grad()</code> context manager. This instructs PyTorch to disable gradient
                            computation and
                            tracking throughout the computational graph. Since gradients are unnecessary for inference,
                            this
                            optimization dramatically reduces memory consumption and accelerates computation, making it
                            especially
                            important when processing large batches of data or deploying models in production
                            environments.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[-0.1262,  0.1080, -0.1792]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Converting Model Outputs to Probabilities with Softmax</h4>

                        <p><strong>Understanding Model Outputs (Logits):</strong><br />
                            When a neural network produces predictions for classification tasks, it typically outputs
                            raw scores called "logits" for each class. These logits are unnormalized values that can be
                            any real number (positive, negative, or zero). In the output above, you can see values like
                            <code>[-0.1262, 0.1080, -0.1792]</code> - these are logits, not probabilities.
                        </p>

                        <p><strong>Why Logits Need Conversion:</strong><br />
                            Logits have several limitations:
                        <ul>
                            <li><strong>Not bounded:</strong> They can be any value from negative infinity to positive
                                infinity</li>
                            <li><strong>Don't sum to 1:</strong> The values don't represent a valid probability
                                distribution</li>
                            <li><strong>Hard to interpret:</strong> It's unclear which class the model is most confident
                                about without comparison</li>
                        </ul>
                        For example, looking at <code>[-0.1262, 0.1080, -0.1792]</code>, while 0.1080 is the highest
                        value, it's not immediately clear how confident the model is about that prediction.</p>

                        <p><strong>What Softmax Does:</strong><br />
                            The softmax function transforms logits into proper probabilities by:
                        <ol>
                            <li><strong>Exponentiating:</strong> Converting each logit to e^(logit), making all values
                                positive</li>
                            <li><strong>Normalizing:</strong> Dividing each exponentiated value by the sum of all
                                exponentiated values</li>
                            <li><strong>Ensuring valid probabilities:</strong> The result is that all output values are
                                between 0 and 1, and they sum to exactly 1</li>
                        </ol>
                        The mathematical formula is: softmax(x_i) = e^(x_i) / Î£(e^(x_j)) for all j</p>

                        <p><strong>Why Cross-Entropy Loss Doesn't Require Explicit Softmax:</strong><br />
                            During training, when we compute the loss using
                            <code>F.cross_entropy(logits, labels)</code>, PyTorch automatically applies softmax
                            internally before calculating the cross-entropy loss. This is done for numerical stability -
                            combining the softmax and log operations in one step prevents numerical overflow/underflow
                            issues that could occur if we applied them separately. This is why we pass logits directly
                            to the loss function during training.
                        </p>

                        <p><strong>When You Need to Apply Softmax Explicitly:</strong><br />
                            You need to call softmax explicitly when:
                        <ul>
                            <li><strong>Making predictions:</strong> When you want to see the actual probability that
                                your model assigns to each class</li>
                            <li><strong>Interpreting confidence:</strong> When you need to understand how confident the
                                model is about its predictions</li>
                            <li><strong>Applying thresholds:</strong> When you want to reject predictions below a
                                certain confidence level</li>
                            <li><strong>Multi-label classification:</strong> When you need probabilities for downstream
                                processing</li>
                        </ul>
                        </p>

                        <p><strong>The Code Below:</strong><br />
                            The following code demonstrates how to convert logits to probabilities. Notice how the
                            logits <code>[-0.1262, 0.1080, -0.1792]</code> become interpretable probabilities
                            <code>[0.3113, 0.3934, 0.2952]</code> that sum to 1.0, making it clear that the model
                            assigns about 39% confidence to the second class (index 1).
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[0.3113, 0.3934, 0.2952]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4 id="Why-dim=1-in-This-Code?">Why dim=1 in This Code?<a class="anchor-link"
                                href="#Why-dim=1-in-This-Code?">Â¶</a></h4>
                        <h5 id="Input-to-the-Model">Input to the Model<a class="anchor-link"
                                href="#Input-to-the-Model">Â¶</a></h5>
                        <ul>
                            <li>X has a shape of (1, 50), meaning it has 1 row and 50 features (or inputs).</li>
                            <li>model(X) produces logits, likely for a classification problem.</li>
                        </ul>
                        <h5 id="Output-of-model(X)">Output of model(X)<a class="anchor-link"
                                href="#Output-of-model(X)">Â¶</a></h5>
                        <ul>
                            <li>
                                <p>Assuming model(X) outputs a tensor of shape (batch_size, num_classes):</p>
                                <ul>
                                    <li>batch_size: Number of input samples (1 in this case).</li>
                                    <li>num_classes: Number of possible classes for classification.</li>
                                </ul>
                            </li>
                            <li>
                                <p>For example, if model(X) outputs a tensor of shape (1, 10), this corresponds to:</p>
                                <ul>
                                    <li>1 sample in the batch.</li>
                                    <li>10 raw scores (logits) for 10 possible classes.</li>
                                </ul>
                            </li>
                        </ul>
                        <h5 id="dim=1-Meaning">dim=1 Meaning<a class="anchor-link" href="#dim=1-Meaning">Â¶</a></h5>
                        <ul>
                            <li>Dimension 1 corresponds to the second axis (columns) in a 2D tensor. Applying softmax
                                along dim=1
                                means:<ul>
                                    <li>For each row (sample) in the tensor, the raw scores (logits) in all columns
                                        (classes) are
                                        normalized to sum to 1.</li>
                                </ul>
                            </li>
                        </ul>
                        <h5 id="Why-Normalize-Along-dim=1?">Why Normalize Along dim=1?<a class="anchor-link"
                                href="#Why-Normalize-Along-dim=1?">Â¶</a></h5>
                        <ul>
                            <li>In classification problems, the softmax is applied across the class dimension (columns)
                                to produce
                                probabilities for each class.</li>
                            <li>Each row in the output tensor will represent the probability distribution for one
                                sample.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- PyTorch Architecture Section -->
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h2 id="PyTorch-Architecture">PyTorch Architecture<a class="anchor-link" href="#PyTorch-Architecture">Â¶</a></h2>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive PyTorch Architecture Visualization -->
        <div style="margin: 2rem 0; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(99, 102, 241, 0.15); width: 100%; max-width: 100%; box-sizing: border-box;">
            <iframe src="7.html" style="width: 100%; height: 780px; border: none; display: block; margin: 0; padding: 0; overflow: hidden;" scrolling="no" title="Interactive PyTorch Architecture Visualization"></iframe>
        </div>

        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h2 id="Setting-up-efficient-data-loaders">Setting up efficient data loaders<a
                                class="anchor-link" href="#Setting-up-efficient-data-loaders">Â¶</a></h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>Dataset of five observastions for training data for two features. Also create a tensor
                            containing the
                            corresponding class labels: three examples belonging to class 0, and two examples belonging
                            to class 1. In
                            addition, make a test set consisting of two entries.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">X_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">2.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">2.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">X_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">],</span>
                       <span class="p">[</span><span class="mf">2.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">],])</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>PyTorch's cross-entropy loss function imposes a strict indexing convention: class labels must
                            be
                            zero-indexed integers starting from 0, and the maximum label value must equal
                            <code>num_classes - 1</code>. This requirement stems from how PyTorch internally indexes the
                            output logits
                            during loss calculation. For example, if your classification problem has five classes
                            labeled 0, 1, 2, 3,
                            and 4, your neural network's output layer must contain exactly five nodesâone for each
                            class. Each node
                            produces a raw score (logit) corresponding to its respective class, and the node at index
                            <code>i</code>
                            represents the score for class <code>i</code>. Violating this convention by using 1-indexed
                            labels (1, 2,
                            3, 4, 5) or having mismatched dimensions will cause runtime errors such as
                            <code>IndexError</code> or
                            produce incorrect gradient calculations. If your dataset uses non-sequential or 1-indexed
                            labels, you must
                            remap them to the 0-indexed format before training.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4 id="Create-a-custom-dataset-class">Create a custom dataset class<a class="anchor-link"
                                href="#Create-a-custom-dataset-class">Â¶</a></h4>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Custom Dataset Visualization -->
        <div style="margin: 2rem 0; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(99, 102, 241, 0.15); width: 100%; max-width: 100%; box-sizing: border-box;">
            <iframe src="8.html" style="width: 100%; height: 1250px; border: none; display: block; margin: 0; padding: 0; overflow: hidden;" scrolling="no" title="Interactive Custom Dataset Visualization"></iframe>
        </div>

        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>

<span class="k">class</span> <span class="nc">ToyDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="n">X</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">y</span>

  <span class="c1"># __getitem__ enables bracket notation (e.g., dataset[0]). Called by DataLoader to fetch samples.</span>
  <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="n">one_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">one_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">one_x</span><span class="p">,</span> <span class="n">one_y</span>

  <span class="c1"># __len__ returns total samples. Called when you use len(dataset) or by DataLoader for batching.</span>
  <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">train_ds</span> <span class="o">=</span> <span class="n">ToyDataset</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">test_ds</span> <span class="o">=</span> <span class="n">ToyDataset</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Explanation of the Dataset Code</h4>

                        <p><strong>Importing the Dataset class:</strong>
                            <code>from torch.utils.data import Dataset</code><br />
                            This imports the <code>Dataset</code> abstract base class from PyTorch. The
                            <code>Dataset</code> class is the foundation for creating custom datasets in PyTorch. By
                            inheriting from it, you ensure compatibility with PyTorch's data loading utilities like
                            <code>DataLoader</code>.
                        </p>

                        <p><strong>Defining the ToyDataset class:</strong> <code>class ToyDataset(Dataset):</code><br />
                            This defines a new class called <code>ToyDataset</code> that inherits from
                            <code>Dataset</code>. The parentheses with <code>Dataset</code> indicate inheritance,
                            meaning <code>ToyDataset</code> will have all the properties and methods of the
                            <code>Dataset</code> class, plus any custom ones we define.
                        </p>

                        <p><strong>The <code>__init__</code> constructor method:</strong><br />
                            <code>def __init__(self, X, y):</code> is the initialization method that runs when you
                            create a new instance of the dataset. It takes three parameters:
                        <ul>
                            <li><code>self</code>: refers to the instance being created (required in all class methods)
                            </li>
                            <li><code>X</code>: the input features (typically a tensor or numpy array)</li>
                            <li><code>y</code>: the target labels (typically a tensor or numpy array)</li>
                        </ul>
                        Inside this method, <code>self.features = X</code> stores the features as an instance attribute,
                        and <code>self.labels = y</code> stores the labels. This makes them accessible throughout the
                        class.</p>

                        <p><strong>The <code>__getitem__</code> method:</strong><br />
                            <code>def __getitem__(self, index):</code> is a special method (called a "magic method" or
                            "dunder method") that enables indexing syntax like <code>dataset[0]</code> or
                            <code>dataset[42]</code>. This method is called automatically by <code>DataLoader</code>
                            when it needs to retrieve individual samples during training. The method:
                        <ul>
                            <li>Takes an <code>index</code> parameter (which sample to retrieve)</li>
                            <li>Extracts the feature at that index: <code>one_x = self.features[index]</code></li>
                            <li>Extracts the label at that index: <code>one_y = self.labels[index]</code></li>
                            <li>Returns both as a tuple: <code>return one_x, one_y</code></li>
                        </ul>
                        This is how PyTorch knows how to access individual training examples from your dataset.</p>

                        <p><strong>The <code>__len__</code> method:</strong><br />
                            <code>def __len__(self):</code> is another special method that returns the total number of
                            samples in the dataset. It's called when you use <code>len(dataset)</code> or when
                            <code>DataLoader</code> needs to know how many samples exist for batching purposes. Here,
                            <code>return self.labels.shape[0]</code> returns the number of rows in the labels array,
                            which corresponds to the number of samples. The <code>[0]</code> index accesses the first
                            dimension of the shape tuple.
                        </p>

                        <p><strong>Creating dataset instances:</strong><br />
                            <code>train_ds = ToyDataset(X_train, y_train)</code> creates a training dataset by
                            instantiating the <code>ToyDataset</code> class with training features and labels.<br />
                            <code>test_ds = ToyDataset(X_test, y_test)</code> creates a testing dataset in the same way,
                            but with test data. These dataset objects can now be passed to <code>DataLoader</code> for
                            efficient batching and shuffling during training and evaluation.
                        </p>

                        <p><strong>Why use Dataset classes?</strong><br />
                            Custom Dataset classes provide a standardized interface for data loading that works
                            seamlessly with PyTorch's <code>DataLoader</code>. The <code>DataLoader</code> can then
                            handle batching, shuffling, parallel loading, and more, all while using your custom
                            <code>__getitem__</code> method to fetch individual samples. This separation of concerns
                            makes your code more modular and easier to maintain.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_ds</span><span class="p">))</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>5
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>After defining PyTorch Dataset class, we can use it for our toy dataset using PyTorchâs
                            <strong>DataLoader</strong> class to sample from it
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4 id="Instantiating-data-loaders">Instantiating data loaders<a class="anchor-link"
                                href="#Instantiating-data-loaders">Â¶</a></h4>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>

<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="n">train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">train_ds</span><span class="p">,</span>
                          <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                          <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span>
                          <span class="p">)</span>
<span class="c1"># The num_workers parameter in the DataLoader specifies the number of worker</span>
<span class="c1"># processes used for loading data. It controls how many separate subprocesses</span>
<span class="c1"># are used to fetch data in parallel while training or testing a model.</span>

<span class="n">test_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
    <span class="n">dataset</span><span class="o">=</span><span class="n">test_ds</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Explanation of the DataLoader Code</h4>

                        <p><strong>Importing DataLoader:</strong>
                            <code>from torch.utils.data import DataLoader</code><br />
                            This imports the <code>DataLoader</code> class from PyTorch's data utilities.
                            <code>DataLoader</code> is a powerful iterator that wraps around a <code>Dataset</code>
                            object to provide convenient features like batching, shuffling, and parallel data loading.
                            It handles the logistics of feeding data to your model during training and evaluation.
                        </p>

                        <p><strong>Setting the random seed:</strong> <code>torch.manual_seed(123)</code><br />
                            This sets PyTorch's random number generator to a specific seed value (123 in this case).
                            Setting a seed ensures reproducibility - running the code multiple times will produce the
                            same random shuffling and initialization. This is crucial for debugging and for ensuring
                            your results can be replicated by others.</p>

                        <p><strong>Creating the training DataLoader:</strong>
                            <code>train_loader = DataLoader(...)</code><br />
                            This creates a <code>DataLoader</code> for the training dataset with several important
                            parameters:
                        <ul>
                            <li><code>dataset=train_ds</code>: Specifies which dataset to load from. Here, it's our
                                <code>train_ds</code> object created earlier.
                            </li>
                            <li><code>batch_size=2</code>: Determines how many samples are grouped together in each
                                batch. Instead of processing one sample at a time, the model will receive 2 samples
                                simultaneously. Larger batch sizes can speed up training and improve gradient estimates,
                                but require more memory.</li>
                            <li><code>shuffle=True</code>: Randomly shuffles the data at the beginning of each epoch.
                                This is important for training because it prevents the model from learning patterns
                                based on the order of samples, leading to better generalization.</li>
                            <li><code>num_workers=0</code>: Specifies how many subprocesses to use for data loading.
                                Setting it to 0 means data loading happens in the main process. Increasing this value
                                (e.g., to 2 or 4) can speed up data loading by using multiple CPU cores to load data in
                                parallel, which is especially beneficial when data preprocessing is time-consuming.
                                However, for small datasets or simple preprocessing, keeping it at 0 is often sufficient
                                and avoids multiprocessing overhead.</li>
                        </ul>
                        The comment in the code explains that <code>num_workers</code> controls parallel data loading -
                        higher values create more worker processes that fetch and preprocess data simultaneously while
                        the model trains on the current batch.</p>

                        <p><strong>Creating the test DataLoader:</strong>
                            <code>test_loader = DataLoader(...)</code><br />
                            This creates a <code>DataLoader</code> for the test dataset with similar parameters:
                        <ul>
                            <li><code>dataset=test_ds</code>: Uses the test dataset we created earlier.</li>
                            <li><code>batch_size=2</code>: Same batch size as training for consistency, though this can
                                differ based on your needs.</li>
                            <li><code>shuffle=False</code>: The test set is NOT shuffled. This is important because we
                                want consistent, reproducible evaluation results. Shuffling during testing is
                                unnecessary and could make debugging harder since results would vary across runs.</li>
                            <li><code>num_workers=0</code>: Same as training - single-process data loading.</li>
                        </ul>
                        </p>

                        <p><strong>Why use DataLoader?</strong><br />
                            The <code>DataLoader</code> acts as an intelligent iterator that:
                        <ul>
                            <li>Automatically batches your data, converting individual samples into batch tensors</li>
                            <li>Handles shuffling to improve training</li>
                            <li>Enables parallel data loading for better performance</li>
                            <li>Provides a clean interface for iterating through your dataset in training loops</li>
                            <li>Manages memory efficiently by loading only one batch at a time</li>
                        </ul>
                        Instead of manually writing loops to batch and shuffle data, <code>DataLoader</code> handles all
                        of this automatically, allowing you to focus on model architecture and training logic.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>Iterating over data</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Vatch </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">:"</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>Vatch 1: tensor([[ 2.3000, -1.1000],
        [-0.9000,  2.9000]]) tensor([1, 0])
Vatch 2: tensor([[-1.2000,  3.1000],
        [-0.5000,  2.6000]]) tensor([0, 0])
Vatch 3: tensor([[ 2.7000, -1.5000]]) tensor([1])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>Set <code>drop_last=True</code> to drop the last batch in each epoch.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
    <span class="n">dataset</span><span class="o">=</span><span class="n">train_ds</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Batch </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">:"</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>Batch 1: tensor([[-1.2000,  3.1000],
        [-0.5000,  2.6000]]) tensor([0, 0])
Batch 2: tensor([[ 2.3000, -1.1000],
        [-0.9000,  2.9000]]) tensor([1, 0])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="A-typical-training-loop">A typical training loop<a class="anchor-link"
                                href="#A-typical-training-loop">Â¶</a></h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>

<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">(</span><span class="n">num_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_outputs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
  <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

    <span class="c1"># Logging</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Epoch: </span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">num_epochs</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">"</span>
          <span class="sa">f</span><span class="s2">" | Batch </span><span class="si">{</span><span class="n">batch_idx</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">"</span>
          <span class="sa">f</span><span class="s2">" | Trrain Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>Epoch: 001/003 | Batch 000/002 | Trrain Loss: 0.75
Epoch: 001/003 | Batch 001/002 | Trrain Loss: 0.65
Epoch: 002/003 | Batch 000/002 | Trrain Loss: 0.44
Epoch: 002/003 | Batch 001/002 | Trrain Loss: 0.13
Epoch: 003/003 | Batch 000/002 | Trrain Loss: 0.03
Epoch: 003/003 | Batch 001/002 | Trrain Loss: 0.00
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Explanation of the Training Loop Code</h4>

                        <p><strong>Importing functional module:</strong>
                            <code>import torch.nn.functional as F</code><br />
                            This imports PyTorch's functional API, which provides a collection of common neural network
                            operations like activation functions, loss functions, and pooling operations. The alias
                            <code>F</code> is a widely-adopted convention that makes the code more concise. Here, we use
                            <code>F.cross_entropy</code> to compute the loss.
                        </p>

                        <p><strong>Setting the random seed:</strong> <code>torch.manual_seed(123)</code><br />
                            Sets PyTorch's random number generator seed for reproducibility. This ensures that model
                            weight initialization and any random operations produce the same results across different
                            runs, which is essential for debugging and comparing experiments.</p>

                        <p><strong>Initializing the model:</strong>
                            <code>model = NeuralNetwork(num_inputs=2, num_outputs=2)</code><br />
                            Creates an instance of the <code>NeuralNetwork</code> class (defined earlier in the
                            notebook) with 2 input features and 2 output classes. This instantiation initializes all the
                            layers and parameters of the neural network. The model is currently on the CPU by default.
                        </p>

                        <p><strong>Creating the optimizer:</strong>
                            <code>optimizer = torch.optim.SGD(model.parameters(), lr=0.5)</code><br />
                            Initializes a Stochastic Gradient Descent (SGD) optimizer that will update the model's
                            parameters during training. Key components:
                        <ul>
                            <li><code>model.parameters()</code>: Provides all trainable parameters (weights and biases)
                                of the model to the optimizer</li>
                            <li><code>lr=0.5</code>: Sets the learning rate, which controls how much to adjust
                                parameters in response to the estimated error. A learning rate of 0.5 is relatively
                                large; typical values range from 0.001 to 0.1 depending on the problem</li>
                        </ul>
                        The optimizer is responsible for performing the parameter updates based on gradients computed
                        during backpropagation.</p>

                        <p><strong>Setting number of epochs:</strong> <code>num_epochs = 3</code><br />
                            Defines how many complete passes through the training dataset the model will make. One epoch
                            means the model has seen every training example once. More epochs generally lead to better
                            learning but risk overfitting if trained too long.</p>

                        <p><strong>The outer loop - iterating over epochs:</strong>
                            <code>for epoch in range(num_epochs):</code><br />
                            This loop iterates through each training epoch. During each epoch, the model will process
                            all batches in the training dataset once.
                        </p>

                        <p><strong>Setting training mode:</strong> <code>model.train()</code><br />
                            Puts the model in training mode at the START of each epoch. This is important because some
                            layers behave differently during training vs. evaluation:
                        <ul>
                            <li><strong>Dropout layers:</strong> Active during training (randomly drop neurons for
                                regularization) but disabled during evaluation (all neurons active)</li>
                            <li><strong>Batch normalization:</strong> Uses batch statistics during training but running
                                statistics during evaluation</li>
                        </ul>
                        Even if your model doesn't have these layers, calling <code>.train()</code> is a best practice.
                        This mode enables gradient computation and allows the model to learn from the data.</p>

                        <p><strong>The inner loop - iterating over batches:</strong>
                            <code>for batch_idx, (features, labels) in enumerate(train_loader):</code><br />
                            This loop iterates through all batches in the training data. <code>enumerate</code> provides
                            both the batch index (<code>batch_idx</code>) and the data (<code>features</code> and
                            <code>labels</code>). The <code>train_loader</code> automatically handles batching and
                            shuffling as we configured earlier. Each iteration provides a batch of 2 samples (as
                            specified by <code>batch_size=2</code>).
                        </p>

                        <p><strong>Forward pass:</strong> <code>logits = model(features)</code><br />
                            Performs the forward pass by feeding the input features through the model. The model
                            processes the data through all its layers and returns raw predictions called "logits"
                            (unnormalized scores for each class). For a batch of 2 samples with 2 output classes,
                            <code>logits</code> would have shape [2, 2].
                        </p>

                        <p><strong>Computing the loss:</strong>
                            <code>loss = F.cross_entropy(logits, labels)</code><br />
                            Calculates the cross-entropy loss between the model's predictions (<code>logits</code>) and
                            the true labels. Cross-entropy is the standard loss function for classification problems. It
                            measures how well the predicted probability distribution matches the true distribution.
                            Lower loss indicates better predictions. Note that <code>F.cross_entropy</code>
                            automatically applies softmax to the logits, so you don't need to do it manually.
                        </p>

                        <p><strong>Zeroing gradients:</strong> <code>optimizer.zero_grad()</code><br />
                            Clears the gradients from the previous iteration. PyTorch accumulates gradients by default
                            (adds new gradients to existing ones), so you must explicitly zero them before computing new
                            gradients. Without this step, gradients from multiple batches would incorrectly sum
                            together, leading to wrong parameter updates.</p>

                        <p><strong>Backward pass:</strong> <code>loss.backward()</code><br />
                            Performs backpropagation to compute gradients of the loss with respect to all model
                            parameters. This uses PyTorch's automatic differentiation engine to calculate how much each
                            parameter contributed to the loss. After this call, each parameter's <code>.grad</code>
                            attribute contains its gradient.</p>

                        <p><strong>Updating parameters:</strong> <code>optimizer.step()</code><br />
                            Updates the model parameters using the computed gradients. The optimizer applies its update
                            rule (SGD in this case) to adjust each parameter in the direction that reduces the loss. The
                            formula for SGD is: <code>parameter = parameter - learning_rate * gradient</code>.</p>

                        <p><strong>Logging progress:</strong> The <code>print</code> statement logs training progress
                            for each batch, showing:
                        <ul>
                            <li>Current epoch and total epochs (formatted as 3-digit numbers with leading zeros)</li>
                            <li>Current batch and total batches in the epoch</li>
                            <li>Current loss value (formatted to 2 decimal places)</li>
                        </ul>
                        This helps monitor whether the model is learning (loss should generally decrease over time).</p>

                        <p><strong>Setting evaluation mode:</strong> <code>model.eval()</code><br />
                            This is placed AFTER the inner batch loop completes but INSIDE the outer epoch loop. This
                            placement prepares the model for evaluation/validation that would typically happen after
                            each training epoch. Here's what it does and why it matters:

                        <p><strong>What does model.eval() do?</strong>
                        <ul>
                            <li><strong>Disables dropout:</strong> In evaluation mode, dropout layers stop randomly
                                dropping neurons, so all neurons are active. This gives more stable and deterministic
                                predictions.</li>
                            <li><strong>Fixes batch normalization:</strong> Batch norm layers switch from using batch
                                statistics to using running statistics (computed during training). This ensures
                                consistent normalization even with small or single-sample batches.</li>
                            <li><strong>Disables gradient computation:</strong> While not directly disabling gradients
                                (you need <code>torch.no_grad()</code> for that), it signals that the model should
                                behave in inference mode.</li>
                        </ul>
                        </p>

                        <p><strong>Why is it needed here?</strong><br />
                            After training on all batches in an epoch, you typically want to evaluate the model's
                            performance on a validation set before starting the next epoch. The
                            <code>model.eval()</code> call prepares the model for this evaluation phase. In a complete
                            training script, you would see code like this after <code>model.eval()</code>:
                        <pre><code>model.eval()
with torch.no_grad():
    for val_features, val_labels in val_loader:
        val_logits = model(val_features)
        val_loss = F.cross_entropy(val_logits, val_labels)
        # compute validation metrics</code></pre>
                        The current code doesn't include validation, but <code>model.eval()</code> is placed here in
                        preparation for that step.</p>

                        <p><strong>What happens without model.eval()?</strong><br />
                            If you don't call <code>model.eval()</code>:
                        <ul>
                            <li><strong>Dropout stays active:</strong> During validation/testing, neurons would still be
                                randomly dropped, making predictions inconsistent and less accurate</li>
                            <li><strong>Batch norm uses batch statistics:</strong> This can cause unreliable
                                predictions, especially with small validation batches, because batch statistics from
                                tiny batches are noisy</li>
                            <li><strong>Incorrect evaluation metrics:</strong> Your validation loss and accuracy would
                                not reflect true model performance</li>
                        </ul>
                        For this simple example without dropout or batch norm, the impact is minimal, but it's a
                        critical best practice for real models.</p>

                        <p><strong>The train()/eval() pattern:</strong><br />
                            A typical pattern is:
                        <ul>
                            <li><code>model.train()</code> â Train on all batches â <code>model.eval()</code> â Validate
                                â Repeat for next epoch</li>
                            <li>You switch to <code>.train()</code> when learning (updating weights)</li>
                            <li>You switch to <code>.eval()</code> when evaluating (measuring performance)</li>
                        </ul>
                        This ensures layers behave appropriately for their context.</p>

                        <p><strong>The complete training cycle:</strong><br />
                            Each epoch follows this pattern: Set training mode â Process all training batches (forward
                            pass â compute loss â zero gradients â backward pass â update parameters) â Set evaluation
                            mode (ready for validation). This cycle repeats for all epochs, gradually improving the
                            model's ability to make accurate predictions.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="c1"># Instantiate the model with 2 input features and 2 output classes</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">(</span><span class="n">num_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_outputs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Define an optimizer (Stochastic Gradient Descent) with a learning rate of 0.5</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Number of epochs to train the model</span>
<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Simulated data loader (you need to replace `train_loader` with your actual data loader)</span>
<span class="c1"># train_loader is expected to yield batches of (features, labels)</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>  <span class="c1"># Loop over each epoch</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>  <span class="c1"># Set the model to training mode (important for layers like dropout, batch norm)</span>
    <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>  <span class="c1"># Loop over batches of data</span>
        <span class="c1"># Forward pass: compute predicted logits (unnormalized scores)</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

        <span class="c1"># Compute the loss using cross-entropy</span>
        <span class="c1"># Cross-entropy is suitable for classification tasks</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

        <span class="c1"># Zero out gradients to prevent accumulation from previous steps</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

        <span class="c1"># Backward pass: compute gradients of the loss w.r.t model parameters</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

        <span class="c1"># Update model parameters based on computed gradients</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="c1">#  The optimizer.step() method will use the gradients to update the model</span>
        <span class="c1"># parameters to minimize the loss. In the case of the SGD optimizer, this</span>
        <span class="c1"># means multiplying the gradients with the learning rate and adding the</span>
        <span class="c1"># scaled negative gradient to the parameters.</span>

        <span class="c1"># Logging: Print training progress</span>
        <span class="c1"># f-strings are used for formatting the output to display relevant info clearly</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Epoch: </span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">num_epochs</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">"</span>  <span class="c1"># Current epoch and total epochs</span>
              <span class="sa">f</span><span class="s2">" | Batch </span><span class="si">{</span><span class="n">batch_idx</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">"</span>  <span class="c1"># Current batch and total batches</span>
              <span class="sa">f</span><span class="s2">" | Train Loss: </span><span class="si">{</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># Training loss for the current batch</span>

    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>  <span class="c1"># Set the model to evaluation mode (no dropout, batch norm)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>Epoch: 001/003 | Batch 001/002 | Train Loss: 0.69
Epoch: 001/003 | Batch 002/002 | Train Loss: 0.49
Epoch: 002/003 | Batch 001/002 | Train Loss: 0.34
Epoch: 002/003 | Batch 002/002 | Train Loss: 0.20
Epoch: 003/003 | Batch 001/002 | Train Loss: 0.04
Epoch: 003/003 | Batch 002/002 | Train Loss: 0.22
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <ol>
                            <li>Formatter Used in Logging:</li>
                        </ol>
                        <ul>
                            <li><code>f"{epoch+1:03d}"</code>: Ensures that the epoch number is formatted as a 3-digit
                                number with
                                leading zeros, e.g., "001".</li>
                            <li><code>len(train_loader)</code>: Displays the total number of batches in the data loader.
                            </li>
                            <li><code>loss.item()</code>: Converts the tensor loss value to a Python float for display
                                purposes.</li>
                            <li><code>.2f</code>: Formats the loss to two decimal places for readability.</li>
                        </ul>
                        <ol start="2">
                            <li>Why <code>model.train()</code> and <code>model.eval()</code> Are Used:</li>
                        </ol>
                        <ul>
                            <li><code>model.train()</code>: Ensures that the model behaves appropriately during
                                training, e.g.,
                                enabling dropout and batch normalization layers.</li>
                            <li><code>model.eval()</code>: Ensures the model behaves appropriately during evaluation or
                                inference,
                                disabling dropout and using running statistics for batch normalization. It is misplaced
                                in this code and
                                should be used outside the training loop when validating or testing.</li>
                        </ul>
                        <ol start="3">
                            <li>Why <code>optimizer.zero_grad()</code> Is Used:</li>
                        </ol>
                        <ul>
                            <li>Gradients accumulate in PyTorch by default. Before computing the new gradients, we need
                                to zero them
                                out to prevent incorrect updates.</li>
                        </ul>
                        <ol start="4">
                            <li>Purpose of Cross-Entropy Loss:</li>
                        </ol>
                        <ul>
                            <li>Cross-entropy loss is suitable for classification tasks, measuring the difference
                                between predicted
                                probabilities and actual class labels.</li>
                        </ul>
                        <ol start="5">
                            <li>Learning Rate:</li>
                        </ol>
                        <ul>
                            <li>The learning rate (<code>lr=0.5</code>) determines the step size for parameter updates.
                                A high
                                learning rate can cause the model to converge quickly or fail to converge, while a small
                                one may slow
                                training.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4 id="Why-optimizer.zero_grad()-Is-Used">Why optimizer.zero_grad() Is Used<a
                                class="anchor-link" href="#Why-optimizer.zero_grad()-Is-Used">Â¶</a></h4>
                        <p>Before computing gradients for a new batch, you need to clear the old gradients to ensure
                            they donât
                            interfere with the new ones.</p>
                        <p><strong>Without</strong> <code>optimizer.zero_grad()</code>:</p>
                        <ul>
                            <li>Gradients will accumulate over multiple forward-backward passes, leading to incorrect
                                parameter
                                updates.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="Making-Predictions">Making Predictions<a class="anchor-link"
                                href="#Making-Predictions">Â¶</a></h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>After we have trained the model, we can use it to make predictions:</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[ 2.4929, -1.8742],
        [ 2.2958, -1.7236],
        [ 1.9967, -1.4961],
        [-1.5813,  1.3215],
        [-1.7966,  1.5170]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="c1"># Set the model to evaluation mode</span>
<span class="c1"># This ensures that certain layers, like dropout and batch normalization, behave appropriately during evaluation.</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

<span class="c1"># Disable gradient calculations using torch.no_grad()</span>
<span class="c1"># Explanation:</span>
<span class="c1"># - Gradient calculations are not needed during evaluation or inference.</span>
<span class="c1"># - Disabling gradients reduces memory usage and speeds up computation.</span>
<span class="c1"># - This is especially useful when you are only interested in forward pass outputs.</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="c1"># Perform a forward pass through the model using the training data (X_train)</span>
    <span class="c1"># Explanation:</span>
    <span class="c1"># - The model takes X_train as input and produces outputs.</span>
    <span class="c1"># - This step generates predictions or activations from the model without updating weights.</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># Print the outputs generated by the model</span>
<span class="c1"># Explanation:</span>
<span class="c1"># - This displays the predictions or activations generated from the forward pass.</span>
<span class="c1"># - Useful for verifying the model's output during evaluation.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[ 2.4929, -1.8742],
        [ 2.2958, -1.7236],
        [ 1.9967, -1.4961],
        [-1.5813,  1.3215],
        [-1.7966,  1.5170]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="c1"># Set print options to avoid scientific notation for better readability</span>
<span class="c1"># Explanation:</span>
<span class="c1"># - By default, PyTorch prints tensors in scientific notation for small or large values.</span>
<span class="c1"># - Setting `sci_mode=False` ensures the output is displayed in standard decimal format.</span>
<span class="n">torch</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">sci_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Apply the softmax function to the outputs along the specified dimension (dim=1)</span>
<span class="c1"># Explanation:</span>
<span class="c1"># - Softmax converts raw model outputs (logits) into probabilities.</span>
<span class="c1"># - It normalizes the logits into a range between 0 and 1, and the sum of values across the specified dimension equals 1.</span>
<span class="c1"># - `dim=1` specifies that softmax operates across the second dimension (columns) of the tensor.</span>
<span class="n">probas</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Print the probabilities generated by the softmax function</span>
<span class="c1"># Explanation:</span>
<span class="c1"># - This displays the normalized probabilities for each input in the batch.</span>
<span class="c1"># - Each row in the output tensor represents the probabilities for the two classes (binary classification in this case).</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probas</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[0.9875, 0.0125],
        [0.9824, 0.0176],
        [0.9705, 0.0295],
        [0.0520, 0.9480],
        [0.0351, 0.9649]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="Obtain-class-membership-probabilities-using-softmax">Obtain class membership
                            probabilities using
                            <code>softmax</code><a class="anchor-link"
                                href="#Obtain-class-membership-probabilities-using-softmax">Â¶</a>
                        </h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">sci_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">probas</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probas</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([[0.9875, 0.0125],
        [0.9824, 0.0176],
        [0.9705, 0.0295],
        [0.0520, 0.9480],
        [0.0351, 0.9649]])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <ol>
                            <li>Softmax Probabilities:</li>
                        </ol>
                        <ul>
                            <li>Each row corresponds to a single input sample in the batch.</li>
                            <li>Each element in a row represents the predicted probability of the sample belonging to a
                                specific
                                class.</li>
                            <li>The sum of probabilities in each row is always 1 due to the normalization property of
                                softmax.</li>
                        </ul>
                        <ol start="2">
                            <li>Example Analysis:</li>
                        </ol>
                        <ul>
                            <li>Row 1: [0.9875, 0.0125]:<ul>
                                    <li>The model is 98.75% confident that the first sample belongs to Class 0.</li>
                                    <li>The probability for Class 1 is only 1.25%, suggesting a strong preference for
                                        Class 0.</li>
                                </ul>
                            </li>
                            <li>Row 4: [0.0520, 0.9480]:<ul>
                                    <li>The model is 94.80% confident that the fourth sample belongs to Class 1.</li>
                                    <li>It predicts Class 1 with high certainty compared to Class 0.</li>
                                </ul>
                            </li>
                        </ul>
                        <ol start="3">
                            <li>Interpreting the Results:</li>
                        </ol>
                        <ul>
                            <li>High Values: When one value in a row is much larger than the other, the model is
                                confident about its
                                prediction.</li>
                            <li>Low Certainty: If the values in a row are closer (e.g., [0.6, 0.4]), the model is less
                                confident about
                                its prediction.</li>
                        </ul>
                        <h4 id="Why-Use-Softmax:">Why Use Softmax:<a class="anchor-link" href="#Why-Use-Softmax:">Â¶</a>
                        </h4>
                        <p>Softmax is often used in classification problems because it provides interpretable
                            probabilities,
                            allowing you to assess the model's confidence in its predictions. These probabilities can be
                            used to make
                            decisions or evaluate model performance.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Converting Probabilities to Class Predictions with Argmax</h4>

                        <p><strong>From Probabilities to Class Labels:</strong><br />
                            Once we have probability distributions from softmax (like
                            <code>[0.3113, 0.3934, 0.2952]</code>), we need to convert these into discrete class
                            predictions. While the probabilities tell us the model's confidence in each class, for most
                            classification tasks we ultimately need a single predicted class label.
                        </p>

                        <p><strong>What is Argmax?</strong><br />
                            The <code>argmax</code> function finds the position (index) of the maximum value in a
                            tensor. The name comes from "argument of the maximum" - it returns which argument (position)
                            gives you the maximum value, not the maximum value itself.</p>

                        <p><strong>How Argmax Works:</strong><br />
                            When we call <code>torch.argmax(probas, dim=1)</code>:
                        <ul>
                            <li><code>probas</code> is our probability tensor, typically of shape [batch_size,
                                num_classes]</li>
                            <li><code>dim=1</code> tells PyTorch to find the maximum along dimension 1 (across classes,
                                not across samples)</li>
                            <li>For each row (sample), it returns the column index (class) with the highest probability
                            </li>
                        </ul>
                        For example, given probabilities <code>[0.3113, 0.3934, 0.2952]</code>, argmax returns 1 because
                        index 1 has the highest value (0.3934).</p>

                        <p><strong>Understanding the dim Parameter:</strong><br />
                            The <code>dim=1</code> parameter is crucial:
                        <ul>
                            <li><strong>dim=0</strong> would find the maximum across samples (down the batch dimension)
                                - usually not what we want</li>
                            <li><strong>dim=1</strong> finds the maximum across classes (for each sample independently)
                                - this gives us the predicted class for each sample</li>
                        </ul>
                        If we have a batch of 4 samples with 3 classes each (shape [4, 3]), <code>dim=1</code> produces
                        4 predictions (one per sample), while <code>dim=0</code> would produce 3 values (one per class).
                        </p>

                        <p><strong>The Result:</strong><br />
                            The output is a tensor of predicted class indices. These are integers representing which
                            class the model predicts for each sample. For example, if we have 3 classes (0, 1, 2),
                            argmax might return <code>tensor([1, 0, 2, 1])</code> for a batch of 4 samples, meaning:
                            predict class 1 for sample 0, class 0 for sample 1, class 2 for sample 2, and class 1 for
                            sample 3.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probas</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([0, 0, 0, 1, 1])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Argmax Directly on Logits: A Computational Shortcut</h4>

                        <p><strong>Key Insight - Softmax Preserves Order:</strong><br />
                            An important mathematical property of the softmax function is that it preserves the relative
                            ordering of values. If logit A is greater than logit B, then softmax(A) will also be greater
                            than softmax(B). This means the class with the highest logit will always have the highest
                            probability after softmax.</p>

                        <p><strong>Why You Can Skip Softmax for Predictions:</strong><br />
                            Since argmax only cares about which value is largest (not the actual values), you can apply
                            it directly to logits without computing softmax first:
                        <ul>
                            <li><strong>Logits:</strong> <code>[-0.1262, 0.1080, -0.1792]</code> â argmax returns 1</li>
                            <li><strong>Probabilities:</strong> <code>[0.3113, 0.3934, 0.2952]</code> â argmax returns 1
                            </li>
                        </ul>
                        Both give the same result because 0.1080 is the largest logit, and its corresponding probability
                        (0.3934) is also the largest.</p>

                        <p><strong>When to Use Each Approach:</strong><br />
                            <strong>Use argmax on logits</strong> when:
                        <ul>
                            <li>You only need the predicted class labels (most common case)</li>
                            <li>Computational efficiency matters - skipping softmax saves computation</li>
                            <li>You're doing inference on large batches</li>
                        </ul>
                        <strong>Use softmax then argmax</strong> when:
                        <ul>
                            <li>You need both the predicted classes AND the confidence scores</li>
                            <li>You want to examine the probability distribution</li>
                            <li>You're applying confidence thresholds (e.g., only accept predictions above 80%
                                confidence)</li>
                            <li>You need interpretable probability values for downstream analysis</li>
                        </ul>
                        </p>

                        <p><strong>Mathematical Explanation:</strong><br />
                            The reason this works is that softmax is a monotonically increasing function. For any logits
                            xâ, xâ, ..., xâ:
                            <br />If xáµ¢ > xâ±¼, then softmax(xáµ¢) > softmax(xâ±¼)
                            <br />Therefore: argmax(logits) = argmax(softmax(logits))
                            <br />This property allows us to skip the softmax computation when we only need class
                            predictions.
                        </p>

                        <p><strong>Code Below:</strong><br />
                            The following code demonstrates applying argmax directly to the raw model outputs (logits),
                            skipping the softmax step entirely while still getting the correct class predictions.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([0, 0, 0, 1, 1])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Evaluating Model Predictions: Comparing Predictions to True Labels</h4>

                        <p><strong>Verifying Model Performance:</strong><br />
                            After making predictions, we need to check how well our model performed. The most
                            straightforward way is to compare the predicted labels directly with the true labels. In
                            this example, the training dataset is small enough that we can visually inspect each
                            prediction.</p>

                        <p><strong>What the Comparison Shows:</strong><br />
                            When we compare <code>predictions</code> to <code>y_train</code> using the equality operator
                            (<code>==</code>), PyTorch returns a boolean tensor showing which predictions match the true
                            labels:
                        <ul>
                            <li><code>True</code> indicates a correct prediction</li>
                            <li><code>False</code> indicates an incorrect prediction</li>
                        </ul>
                        With a small dataset (like 4-6 samples), we can easily scan this boolean tensor to verify
                        accuracy visually.</p>

                        <p><strong>Interpreting Perfect Accuracy:</strong><br />
                            If all values in the comparison are <code>True</code>, it means the model achieved 100%
                            accuracy on this data. However, it's important to understand what this means:
                        <ul>
                            <li><strong>On training data:</strong> Perfect accuracy often indicates the model has
                                learned the training patterns well, but could also suggest overfitting (the model
                                memorized the training data rather than learning generalizable patterns)</li>
                            <li><strong>Small datasets:</strong> With only a few samples, 100% accuracy is easier to
                                achieve and less meaningful than with larger datasets</li>
                            <li><strong>What really matters:</strong> Performance on unseen test data is the true
                                measure of a model's ability to generalize</li>
                        </ul>
                        </p>

                        <p><strong>Beyond Visual Inspection:</strong><br />
                            For larger datasets, visual inspection becomes impractical. Instead, you would:
                        <ul>
                            <li>Calculate accuracy: <code>(predictions == y_train).float().mean()</code> to get a
                                percentage</li>
                            <li>Use classification metrics: precision, recall, F1-score for imbalanced datasets</li>
                            <li>Create confusion matrices to understand which classes are confused with each other</li>
                            <li>Always evaluate on a separate test set that the model hasn't seen during training</li>
                        </ul>
                        </p>

                        <p><strong>The Importance of Test Data:</strong><br />
                            Training accuracy alone can be misleading. A model that perfectly predicts training data but
                            fails on new data has simply memorized rather than learned. Always reserve separate test
                            data to evaluate true model performance and generalization ability.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">predictions</span> <span class="o">==</span> <span class="n">y_train</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child jp-OutputArea-executeResult">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[Â ]:</div>
                        <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult"
                            data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([True, True, True, True, True])</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4 id="Number-of-correct-predictions----using-torch.sum()">Number of correct predictions --
                            using
                            <code>torch.sum()</code><a class="anchor-link"
                                href="#Number-of-correct-predictions----using-torch.sum()">Â¶</a>
                        </h4>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">y_train</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child jp-OutputArea-executeResult">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[Â ]:</div>
                        <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult"
                            data-mime-type="text/plain" tabindex="0">
                            <pre>tensor(5)</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4 id="Generalize-the-computation-of-the-prediction-accuracy">Generalize the computation of the
                            prediction
                            accuracy<a class="anchor-link"
                                href="#Generalize-the-computation-of-the-prediction-accuracy">Â¶</a></h4>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="k">def</span> <span class="nf">compute_accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">):</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
  <span class="n">correct</span> <span class="o">=</span> <span class="mf">0.0</span>
  <span class="n">total_examples</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataloader</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
      <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

    <span class="n">predictions</span>  <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">compare</span> <span class="o">=</span> <span class="n">labels</span> <span class="o">==</span> <span class="n">predictions</span>
    <span class="n">correct</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
    <span class="n">total_examples</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>

  <span class="k">return</span> <span class="p">(</span><span class="n">correct</span> <span class="o">/</span> <span class="n">total_examples</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">compute_accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">))</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>1.0
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>We can apply the function to the test set:</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">compute_accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">))</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>1.0
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="Saving-and-loading-models">Saving and loading models<a class="anchor-link"
                                href="#Saving-and-loading-models">Â¶</a></h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">'/content/drive'</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>Mounted at /content/drive
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s2">"/content/drive/My Drive/LLM from Scratch/model.pth"</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">path</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p><code>.pth</code> and <code>.pt</code> are the most common file extensions for saving files.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="Saving-and-Loading-Models">Saving and Loading Models<a class="anchor-link"
                                href="#Saving-and-Loading-Models">Â¶</a></h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Saving Trained Models to Google Drive</h4>

                        <p><strong>Why Save Models?</strong><br />
                            After spending time and computational resources training a model, you want to preserve your
                            work. Saving models allows you to:
                        <ul>
                            <li>Resume training later without starting from scratch</li>
                            <li>Deploy the model for inference in production</li>
                            <li>Share trained models with collaborators</li>
                            <li>Create checkpoints during long training runs</li>
                            <li>Compare different model versions</li>
                        </ul>
                        Without saving, all your trained weights are lost when the runtime disconnects or the notebook
                        closes.</p>

                        <p><strong>Understanding Google Colab's Temporary Storage:</strong><br />
                            Google Colab provides temporary storage in <code>/content/</code> that is wiped clean when
                            your runtime disconnects. Anything you save there will be lost. To persist your trained
                            models, you need to save them to Google Drive, which provides permanent storage linked to
                            your Google account.</p>

                        <p><strong>The Model Saving Process:</strong><br />
                            The code below demonstrates the complete workflow for saving a trained PyTorch model to
                            Google Drive in three steps.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="c1"># Step 1: Mount Google Drive to access your personal storage</span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">'/content/drive'</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Explanation: Mounting Google Drive</h4>

                        <p><strong>What is "Mounting"?</strong><br />
                            Mounting makes your Google Drive accessible as a folder within the Colab environment. Think
                            of it like plugging in an external hard drive - after mounting, you can read from and write
                            to your Google Drive just like any other folder.</p>

                        <p><strong>The Mount Process:</strong><br />
                            <code>drive.mount('/content/drive')</code> performs the following:
                        <ul>
                            <li>Creates a mount point at <code>/content/drive</code> in the Colab filesystem</li>
                            <li>Prompts you to authorize access (you'll need to click a link and grant permissions)</li>
                            <li>Connects your Google Drive to this mount point</li>
                            <li>Your Drive files become accessible at <code>/content/drive/My Drive/</code></li>
                        </ul>
                        After mounting, any files in your Google Drive appear as regular files in the Colab filesystem.
                        </p>

                        <p><strong>First-Time Setup:</strong><br />
                            When you run this cell for the first time in a session, Colab will:
                        <ol>
                            <li>Display a link asking for permission</li>
                            <li>You click the link and log into your Google account</li>
                            <li>You authorize Colab to access your Drive</li>
                            <li>Colab receives an access token and completes the mount</li>
                        </ol>
                        This mount persists for the entire runtime session but needs to be redone if the runtime
                        restarts.</p>

                        <p><strong>Important Notes:</strong><br />
                        <ul>
                            <li>You only need to mount once per runtime session</li>
                            <li>If your runtime disconnects, you'll need to mount again when you reconnect</li>
                            <li>The mount point <code>/content/drive</code> is a convention; you could use other paths,
                                but this is standard</li>
                            <li>After mounting, your entire Google Drive is accessible, not just a specific folder</li>
                        </ul>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="c1"># Step 2: Define the save path in your Google Drive</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">"/content/drive/My Drive/LLM from Scratch/model.pth"</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Explanation: Defining the Save Path</h4>

                        <p><strong>Understanding the Path Structure:</strong><br />
                            The path <code>/content/drive/My Drive/LLM from Scratch/model.pth</code> breaks down into:
                        <ul>
                            <li><code>/content/drive/</code> - The mount point where Google Drive is accessible</li>
                            <li><code>My Drive/</code> - The root of your personal Google Drive (this is standard
                                naming)</li>
                            <li><code>LLM from Scratch/</code> - A folder in your Drive (this folder should already
                                exist or be created)</li>
                            <li><code>model.pth</code> - The filename for your saved model</li>
                        </ul>
                        </p>

                        <p><strong>About the .pth Extension:</strong><br />
                            <code>.pth</code> is the conventional file extension for PyTorch model files:
                        <ul>
                            <li>Stands for "PyTorch" (sometimes also .pt is used)</li>
                            <li>It's just a convention - the file is actually a Python pickle file</li>
                            <li>Other common extensions: .pt, .pytorch, .pkl</li>
                            <li>The extension doesn't affect functionality, but .pth/.pt are standard</li>
                        </ul>
                        </p>

                        <p><strong>Organizing Your Models:</strong><br />
                            Best practices for model file organization:
                        <ul>
                            <li><strong>Use descriptive names:</strong> <code>model_epoch10_acc95.pth</code> tells you
                                more than <code>model.pth</code></li>
                            <li><strong>Include timestamps:</strong> <code>model_2024_12_17.pth</code> helps track
                                versions</li>
                            <li><strong>Separate by project:</strong> Keep each project's models in dedicated folders
                            </li>
                            <li><strong>Include hyperparameters:</strong> <code>model_lr0.001_batch32.pth</code>
                                documents training configuration</li>
                        </ul>
                        </p>

                        <p><strong>Path Requirements:</strong><br />
                        <ul>
                            <li>The parent directory (<code>LLM from Scratch/</code>) must exist; Python won't create it
                                automatically</li>
                            <li>Use forward slashes even if you're on Windows locally (Colab runs on Linux)</li>
                            <li>Spaces in folder names are allowed but must be included exactly as they appear in Drive
                            </li>
                            <li>Path is case-sensitive</li>
                        </ul>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="c1"># Step 3: Save the model's state dictionary</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Model saved successfully to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Explanation: Saving the Model State Dictionary</h4>

                        <p><strong>What is state_dict()?</strong><br />
                            <code>model.state_dict()</code> returns an OrderedDict containing all the model's learnable
                            parameters:
                        <ul>
                            <li>All weights from every layer</li>
                            <li>All biases from every layer</li>
                            <li>Any other learnable parameters (like batch norm running statistics)</li>
                        </ul>
                        This is essentially the "trained knowledge" of your model - everything it learned during
                        training.</p>

                        <p><strong>Why Save state_dict() Instead of the Entire Model?</strong><br />
                            PyTorch recommends saving <code>state_dict()</code> rather than the entire model object
                            because:
                        <ul>
                            <li><strong>Flexibility:</strong> You can load weights into a model defined differently (as
                                long as the architecture matches)</li>
                            <li><strong>Smaller file size:</strong> Only saves the parameters, not the model
                                architecture or code</li>
                            <li><strong>Python version independence:</strong> Less likely to have compatibility issues
                                across different PyTorch versions</li>
                            <li><strong>Cleaner separation:</strong> Model definition stays in your code; trained
                                weights stay in the file</li>
                            <li><strong>Better for version control:</strong> You can update model code without
                                invalidating saved weights</li>
                        </ul>
                        </p>

                        <p><strong>What torch.save() Does:</strong><br />
                            <code>torch.save(object, path)</code> serializes the object and writes it to disk:
                        <ol>
                            <li>Converts the state_dict (a Python dictionary) into a binary format using pickle</li>
                            <li>Writes this binary data to the specified file path</li>
                            <li>The file can later be read back with <code>torch.load()</code></li>
                        </ol>
                        Under the hood, PyTorch uses Python's pickle module with some optimizations for tensors.</p>

                        <p><strong>What Gets Saved vs. What Doesn't:</strong><br />
                            <strong>Included in state_dict():</strong>
                        <ul>
                            <li>All layer weights and biases</li>
                            <li>Batch normalization running statistics</li>
                            <li>Any registered buffers</li>
                        </ul>
                        <strong>NOT included:</strong>
                        <ul>
                            <li>Model architecture/structure (you need the class definition to load it back)</li>
                            <li>Optimizer state (learning rates, momentum, etc.)</li>
                            <li>Training history or loss values</li>
                            <li>Hyperparameters used during training</li>
                        </ul>
                        This is why you need to recreate the model architecture before loading weights.</p>

                        <p><strong>Alternative: Saving Everything (Full Checkpoint):</strong><br />
                            For more complete checkpoints, you can save additional information:
                        <pre><code>torch.save({
    'epoch': epoch,
    'model_state_dict': model.state_dict(),
    'optimizer_state_dict': optimizer.state_dict(),
    'loss': loss,
    'hyperparameters': {'lr': 0.001, 'batch_size': 32}
}, path)</code></pre>
                        This saves everything needed to resume training exactly where you left off.</p>

                        <p><strong>Confirmation:</strong><br />
                            The print statement confirms the save was successful and shows where the file was written.
                            After running this, you can verify the file exists in your Google Drive by checking the
                            folder in your Drive web interface.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Loading a Saved Model</h4>

                        <p><strong>When to Load Models:</strong><br />
                            You'll need to load a saved model when:
                        <ul>
                            <li>Starting a new Colab session and want to continue using a trained model</li>
                            <li>Deploying a model for inference/predictions</li>
                            <li>Comparing different model versions</li>
                            <li>Resuming training after a runtime disconnect</li>
                            <li>Transferring a model between different environments</li>
                        </ul>
                        </p>

                        <p><strong>The Loading Process:</strong><br />
                            Loading a model requires two steps: (1) recreating the model architecture, and (2) loading
                            the saved weights into that architecture. You cannot skip step 1 - PyTorch needs to know
                            what structure to load the weights into.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="c1"># Step 1: Mount Google Drive (if not already mounted)</span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">'/content/drive'</span><span class="p">)</span>

<span class="c1"># Step 2: Define the path to the saved model</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">"/content/drive/My Drive/LLM from Scratch/model.pth"</span>

<span class="c1"># Step 3: Recreate the model architecture (must match the saved model exactly)</span>
<span class="n">loaded_model</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">(</span><span class="n">num_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_outputs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 4: Load the saved weights into the model</span>
<span class="n">loaded_model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

<span class="c1"># Step 5: Set the model to evaluation mode</span>
<span class="n">loaded_model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Model loaded successfully and ready for inference!"</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Explanation: Loading a Saved Model</h4>

                        <p><strong>Step 1 - Mount Drive:</strong><br />
                            Same as when saving - you need access to Google Drive where your model file is stored. If
                            you already mounted Drive earlier in the session, you can skip this step.</p>

                        <p><strong>Step 2 - Define Path:</strong><br />
                            Specify the exact same path where you saved the model. The path must match exactly,
                            including capitalization and spaces.</p>

                        <p><strong>Step 3 - Recreate Model Architecture:</strong><br />
                            <code>loaded_model = NeuralNetwork(num_inputs=2, num_outputs=2)</code>
                            <br />This is <strong>crucial</strong> and often the source of errors. You must:
                        <ul>
                            <li>Use the exact same model class definition (<code>NeuralNetwork</code>)</li>
                            <li>Use the exact same architecture parameters (same number of inputs, outputs, hidden
                                layers, etc.)</li>
                            <li>Have the model class defined in your notebook before loading</li>
                        </ul>
                        At this point, the model has random untrained weights - it's just an empty container with the
                        right shape.</p>

                        <p><strong>Step 4 - Load Weights:</strong><br />
                            <code>loaded_model.load_state_dict(torch.load(path))</code>
                            <br />This happens in two parts:
                        <ol>
                            <li><code>torch.load(path)</code> reads the saved file and deserializes it back into a
                                Python dictionary</li>
                            <li><code>load_state_dict()</code> takes that dictionary and copies each saved weight into
                                the corresponding layer of your model</li>
                        </ol>
                        After this line, your model now has the trained weights and will make the same predictions as
                        when you saved it.</p>

                        <p><strong>Common Loading Errors and Solutions:</strong><br />
                        <ul>
                            <li><strong>RuntimeError: Error(s) in loading state_dict</strong> - The model architecture
                                doesn't match the saved weights. Check that layer sizes match exactly.</li>
                            <li><strong>FileNotFoundError</strong> - The path is wrong or Drive isn't mounted. Verify
                                the file exists in Drive.</li>
                            <li><strong>NameError: NeuralNetwork is not defined</strong> - You need to run the cell that
                                defines the NeuralNetwork class before loading.</li>
                            <li><strong>KeyError</strong> - Layer names don't match. This happens if you changed the
                                model definition after saving.</li>
                        </ul>
                        </p>

                        <p><strong>Step 5 - Set to Evaluation Mode:</strong><br />
                            <code>loaded_model.eval()</code>
                            <br />This is important for inference:
                        <ul>
                            <li>Disables dropout layers (if your model has them)</li>
                            <li>Sets batch normalization to use running statistics (if your model has batch norm)</li>
                            <li>Ensures consistent, deterministic predictions</li>
                        </ul>
                        Always call <code>.eval()</code> before using a loaded model for predictions. If you want to
                        continue training, call <code>.train()</code> instead.</p>

                        <p><strong>Device Considerations:</strong><br />
                            If you saved a model that was on GPU and you're loading on CPU (or vice versa), add the
                            <code>map_location</code> parameter:
                        <pre><code># Loading a GPU model on CPU
loaded_model.load_state_dict(torch.load(path, map_location=torch.device('cpu')))

# Or use the flexible device pattern
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
loaded_model.load_state_dict(torch.load(path, map_location=device))
loaded_model = loaded_model.to(device)</code></pre>
                        This prevents errors when loading models across different hardware configurations.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Using the Loaded Model for Predictions</h4>

                        <p>Once your model is loaded, you can use it exactly like the original trained model:</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="c1"># Make predictions with the loaded model</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>  <span class="c1"># Disable gradient computation for inference</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">loaded_model</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">"Predictions:"</span><span class="p">,</span> <span class="n">predicted_classes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"True labels:"</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Accuracy:"</span><span class="p">,</span> <span class="p">(</span><span class="n">predicted_classes</span> <span class="o">==</span> <span class="n">y_test</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>The loaded model should produce identical predictions to the original model since it has the
                            exact same trained weights. This verifies that the save and load process worked correctly.
                        </p>

                        <p><strong>Best Practices for Model Management:</strong><br />
                        <ul>
                            <li><strong>Save regularly:</strong> Create checkpoints during long training runs (e.g.,
                                every 10 epochs)</li>
                            <li><strong>Use descriptive names:</strong> Include epoch, accuracy, or date in filenames
                            </li>
                            <li><strong>Save optimizer state:</strong> If resuming training, save optimizer state too
                            </li>
                            <li><strong>Document hyperparameters:</strong> Keep a separate text file with training
                                details</li>
                            <li><strong>Test loading immediately:</strong> After saving, try loading in a new cell to
                                verify it works</li>
                            <li><strong>Version your models:</strong> Don't overwrite old models; create new files for
                                each version</li>
                            <li><strong>Organize by project:</strong> Use separate Drive folders for different projects
                            </li>
                        </ul>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell-inputWrapper" tabindex="0">
            <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
            </div>
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">
                </div>
                <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
                    <h3 id="Optimizing-training-performance-with-GPUs">Optimizing training performance with GPUs<a
                            class="anchor-link" href="#Optimizing-training-performance-with-GPUs">Â¶</a></h3>
                </div>
            </div>
        </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">())</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>True
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">tensor_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">])</span>
<span class="n">tensor_2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tensor_1</span> <span class="o">+</span> <span class="n">tensor_2</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([5., 7., 9.])
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <p>Transfer these tensors onto a GPU and perform the addition.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">tensor_1</span> <span class="o">=</span> <span class="n">tensor_1</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">"cuda"</span><span class="p">)</span>
<span class="n">tensor_2</span> <span class="o">=</span> <span class="n">tensor_2</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">"cuda"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tensor_1</span> <span class="o">+</span> <span class="n">tensor_2</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>tensor([5., 7., 9.], device='cuda:0')
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h3 id="Single-GPU-training">Single-GPU training<a class="anchor-link"
                                href="#Single-GPU-training">Â¶</a>
                        </h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">(</span><span class="n">num_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_outputs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>

  <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
    <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

    <span class="c1"># Logging</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Epoch: </span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">num_epochs</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">"</span>
    <span class="sa">f</span><span class="s2">" | Batch </span><span class="si">{</span><span class="n">batch_idx</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">"</span>
    <span class="sa">f</span><span class="s2">" | Ttrain/Val loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
                            <pre>Epoch: 001/003 | Batch 000/002 | Ttrain/Val loss: 0.81
Epoch: 001/003 | Batch 001/002 | Ttrain/Val loss: 1.29
Epoch: 002/003 | Batch 000/002 | Ttrain/Val loss: 0.65
Epoch: 002/003 | Batch 001/002 | Ttrain/Val loss: 1.20
Epoch: 003/003 | Batch 000/002 | Ttrain/Val loss: 0.70
Epoch: 003/003 | Batch 001/002 | Ttrain/Val loss: 0.63
</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">
                    </div>
                    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
                        data-mime-type="text/markdown">
                        <h4>Flexible Device Management: Writing GPU/CPU Compatible Code</h4>

                        <p><strong>Two Ways to Specify CUDA:</strong><br />
                            PyTorch provides two equivalent ways to move tensors and models to GPU:
                        <ul>
                            <li><strong>String shorthand:</strong> <code>.to("cuda")</code> - Direct, concise, commonly
                                used</li>
                            <li><strong>Device object:</strong> <code>.to(torch.device("cuda"))</code> - More explicit,
                                useful for complex setups</li>
                        </ul>
                        Both accomplish the same thing: transferring the tensor or model to GPU memory for accelerated
                        computation. The string version <code>"cuda"</code> is simply a shorthand that PyTorch
                        internally converts to a device object.</p>

                        <p><strong>When to Use Each Approach:</strong><br />
                            <strong>Use the string shorthand</strong> <code>.to("cuda")</code> when:
                        <ul>
                            <li>You know a GPU is available</li>
                            <li>You want concise, readable code</li>
                            <li>You're working in a controlled environment (like your own machine with a GPU)</li>
                        </ul>
                        <strong>Use the device object</strong> approach when:
                        <ul>
                            <li>You need to manage multiple GPUs: <code>torch.device("cuda:0")</code>,
                                <code>torch.device("cuda:1")</code>
                            </li>
                            <li>You want more control and explicit code</li>
                            <li>You're managing device state across many operations</li>
                        </ul>
                        </p>

                        <p><strong>Writing Portable GPU/CPU Code:</strong><br />
                            The code below demonstrates the best practice for writing code that automatically adapts to
                            available hardware. The pattern
                            <code>torch.device("cuda" if torch.cuda.is_available() else "cpu")</code> is widely used
                            because:
                        <ul>
                            <li><strong>Automatic fallback:</strong> Uses GPU if available, CPU otherwise</li>
                            <li><strong>No manual changes:</strong> Same code runs on different machines without
                                modification</li>
                            <li><strong>Protects against errors:</strong> Prevents crashes when GPU is unavailable</li>
                            <li><strong>Development flexibility:</strong> Develop on CPU-only laptop, deploy on GPU
                                server</li>
                        </ul>
                        </p>

                        <p><strong>How the Conditional Works:</strong><br />
                            <code>torch.cuda.is_available()</code> returns <code>True</code> if PyTorch detects a
                            CUDA-capable GPU with proper drivers, <code>False</code> otherwise. The ternary operator
                            <code>A if condition else B</code> selects "cuda" when a GPU is available, "cpu" when it's
                            not. This single line makes your code portable across different hardware configurations.
                        </p>

                        <p><strong>Best Practice Recommendation:</strong><br />
                            Always use the conditional device assignment pattern in production code:
                        <pre><code>device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
model = model.to(device)
data = data.to(device)</code></pre>
                        This ensures your code runs anywhere - on cloud GPU instances, local machines, CPU-only servers,
                        or edge devices - without requiring any code changes.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span><span class="p">)</span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
            <div class="jp-Cell-inputWrapper" tabindex="0">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [Â ]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                        <div class="cm-editor cm-s-jupyter">
                            <div class="highlight hl-python">
                                <pre><span></span>
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Chapter Footer Navigation -->
        <div class="chapter-footer">
            <div class="chapter-footer-inner">
                <div class="chapter-nav">
                    <span class="chapter-nav-btn disabled">
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" />
                        </svg>
                        <div>
                            <div class="nav-direction">Previous Chapter</div>
                            <div class="nav-title">No previous chapter</div>
                        </div>
                    </span>
                    <a href="chapter_2.html" class="chapter-nav-btn">
                        <div style="text-align: right; flex: 1;">
                            <div class="nav-direction">Next Chapter</div>
                            <div class="nav-title">Working with Text Data</div>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
                        </svg>
                    </a>
                </div>

                <div class="chapter-acknowledgement">
                    <div class="chapter-acknowledgement-header">
                        <div class="chapter-acknowledgement-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0112 13.489a50.702 50.702 0 017.74-3.342M6.75 15a.75.75 0 100-1.5.75.75 0 000 1.5zm0 0v-3.675A55.378 55.378 0 0112 8.443m-7.007 11.55A5.981 5.981 0 006.75 15.75v-1.5" />
                            </svg>
                        </div>
                        <h3>Acknowledgement</h3>
                    </div>
                    <p>
                        These notes are based on the book
                        <a href="https://www.manning.com/books/build-a-large-language-model-from-scratch" target="_blank">"Build a Large Language Model (From Scratch)"</a>
                        by <strong>Sebastian Raschka</strong>, published by Manning Publications.
                        All credit for the original content goes to Professor Raschka.
                    </p>
                </div>
            </div>
        </div>
    </main>
</body>

</html>